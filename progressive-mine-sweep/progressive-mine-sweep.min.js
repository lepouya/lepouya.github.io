"use strict";(self.webpackChunkprogressive_mine_sweep=self.webpackChunkprogressive_mine_sweep||[]).push([[873],{823:(e,s,t)=>{t.r(s);var n=t(893),a=t(745),i=t(294),r=t(88);function o(){const e=window.localStorage,s="__storage_test__";if(!e)return!1;try{return e.setItem(s,s),e.removeItem(s),!0}catch(s){return s instanceof DOMException&&0!==e.length&&(22===s.code||1014===s.code||"QuotaExceededError"===s.name||"NS_ERROR_DOM_QUOTA_REACHED"===s.name)}}var l=t(962),c=t(86);const u={row:0,col:0,contents:"clear",state:"hidden",neighborContents:{clear:0,mine:0},neighborStates:{hidden:0,hinted:0,flagged:0,revealed:0,blown:0}};function d(e,s){switch(s){case"flag":"hidden"===e.state||"hinted"===e.state?e.state="flagged":"flagged"===e.state&&(e.state="hidden");break;case"reveal":"hidden"!==e.state&&"hinted"!==e.state||("clear"===e.contents?e.state="revealed":"mine"===e.contents&&(e.state="blown"));break;case"hint":"hidden"===e.state&&(e.state="hinted");break;case"hide":"flagged"!==e.state&&"revealed"!==e.state||(e.state="hidden")}return e}const h={rows:0,cols:0,cells:[],numMines:0,state:"inactive",cellCounts:{hidden:0,hinted:0,flagged:0,revealed:0,blown:0}};function g(e,s=1){var t;e.cellCounts=Object.assign({},h.cellCounts),e.numMines=0,e.cells.forEach((e=>e.forEach((e=>{e.neighborContents=Object.assign({},u.neighborContents),e.neighborStates=Object.assign({},u.neighborStates)}))));for(let s=0;s<e.rows;s++)for(let n=0;n<e.cols;n++){const a=e.cells[s][n];e.numMines+="mine"===a.contents?1:0,e.cellCounts[a.state]++,a.row=s,a.col=n,a.locked=!!a.locked||void 0,(0,l.xR)(a,["contents","state","locked"]);for(let i=s-1;i<=s+1;i++)for(let r=n-1;r<=n+1;r++){const o=(null!==(t=e.cells[i])&&void 0!==t?t:[])[r];!o||i===s&&r===n||(a.neighborContents[o.contents]++,a.neighborStates[o.state]++)}}return"lost"===e.state||e.cellCounts.blown>=s?(e.state="lost",e.cells.forEach((s=>s.forEach((s=>{e.cellCounts[s.state]--,d(s,"reveal"),e.cellCounts[s.state]++}))))):e.cols*e.rows==0?e.state="inactive":e.cellCounts.blown+e.cellCounts.flagged===e.numMines&&0===e.cellCounts.hidden&&e.cellCounts.revealed===e.cols*e.rows-e.numMines?e.state="won":e.state="active",(0,l.xR)(e,["rows","cols","cells"])}function m(e,s,t,n){let a=function(e,s){const t=[];for(let n=0;n<e;n++){t[n]=[];for(let e=0;e<s;e++)t[n][e]=Object.assign(Object.assign({},u),{row:n,col:e})}return{rows:e,cols:s,cells:t,numMines:0,state:"active",cellCounts:Object.assign(Object.assign({},h.cellCounts),{hidden:e*s})}}(e,s);return a=function(e,s,t){var n,a;s=null!==(n=null!=s?s:t)&&void 0!==n?n:0,t=null!==(a=null!=t?t:s)&&void 0!==a?a:0;let i=(0,c.Z)(Math.floor(s+Math.random()*(1+t-s)),0,e.rows*e.cols-e.numMines-1);for(;i>0;){const s=Math.floor(Math.random()*e.rows),t=Math.floor(Math.random()*e.cols);"clear"===e.cells[s][t].contents&&(e.cells[s][t].contents="mine",e.numMines++,i--)}return e}(a,t,n),a=g(a),a}function f(e,s,t=0,n=8,a=0){if(s=Math.floor((0,c.Z)(s,0,100)),t=Math.floor((0,c.Z)(t,0,8)),n=Math.floor((0,c.Z)(n,0,8)),a=(0,c.Z)(a,0,1),0===s)return 0;const i=e.cells.flat().filter((e=>"hidden"===e.state&&"clear"===e.contents&&e.neighborContents.mine>=t&&e.neighborContents.mine<=n)).sort(((e,s)=>e.neighborContents.mine-s.neighborContents.mine));if(i.length<=s)return i.forEach((s=>{d(s,"hint"),e.cellCounts.hinted++,e.cellCounts.hidden--})),i.length;for(let t=0;t<s;t++){let s=0;const t=a,n=Math.random();s=.5===t?n:(Math.sqrt(t*t+n-2*t*n)-t)/(1-2*t),s=Math.floor(s*i.length),i.splice(s,1).map((s=>{d(s,"hint"),e.cellCounts.hinted++,e.cellCounts.hidden--}))}return s}const v=JSON.parse('[{"name":"autoRevealNeighbors","unlocked":false,"count":0,"cost":"automation: Math.floor((n+1)**1.5)"},{"name":"autoFlagMines","unlocked":false,"count":0,"cost":"automation: Math.floor((n+1)**1.5)"},{"name":"autoRevealHints","unlocked":false,"count":0,"cost":"automation: Math.floor((n+1)**1.5)"},{"name":"autoPurchaseHints","unlocked":false,"count":0,"cost":"automation: (n+1)**2"},{"name":"autoResetGame","unlocked":false,"count":0,"cost":"automation: Math.floor((n+1)**1.5)"},{"name":"autoBoardUpgrade","singularName":"Auto Expand Board","pluralName":"Auto Expand Board","unlocked":false,"count":0,"cost":"automation: (n+1)**2"}]'),x=JSON.parse('[{"name":"rows","singularName":"row","icon":"arrows-vertical","count":3,"minCount":3,"cost":"cells: n**2"},{"name":"cols","singularName":"col","icon":"arrows-horizontal","count":3,"minCount":3,"cost":"cells: n**2"},{"name":"difficulty","icon":"adjustments-horizontal","display":"percentage","count":15,"minCount":1,"maxCount":100,"cost":"flags: Math.floor(n/2)"},{"name":"hintQuality","icon":"icon-hinted bulb","display":"percentage","count":0,"maxCount":100,"cost":"wins: 1, cells: n-1"},{"name":"hintsCount","singularName":"hint","pluralName":"hints","count":1,"cost":"wins: (n+2)**2, cells: 2**(n+2)"},{"name":"resetSpeed","icon":"refresh-alert","display":"percentage","count":0,"maxCount":100,"extra":{"remainingTime":0},"cost":"resets: 1, cells: n"},{"name":"revealNeighbors","icon":"icon-revealed arrows-maximize","unlocked":false,"count":0,"maxCount":8,"extra":{"reveals":0,"explosions":0,"auto":0,"manual":0,"useless":0},"cost":"cols: 1, rows: 1, wins: n+1"}]'),p=JSON.parse('[{"name":"clicks","singularName":"click","icon":"hand-click","count":0,"extra":{"left":0,"right":0,"double":0,"useless":0}},{"name":"cells","singularName":"cell","icon":"icon-revealed square","count":0,"extra":{"auto":0,"manual":0,"hidden":0}},{"name":"hints","singularName":"hint","icon":"icon-hinted eye","count":0,"extra":{"auto":0,"manual":0},"cost":"wins: 1"},{"name":"flags","singularName":"flag","icon":"icon-flagged flag-2","count":0,"extra":{"auto":0,"manual":0,"unflags":0}},{"name":"explosions","singularName":"explosion","icon":"icon-blown alert-triangle","count":0,"extra":{"auto":0,"manual":0}}]'),b=JSON.parse('[{"name":"wins","singularName":"win","icon":"icon-won square-check","count":0,"extra":{"auto":0,"manual":0,"streak":0,"longestStreak":0}},{"name":"losses","singularName":"lose","icon":"icon-lost square-x","count":0,"extra":{"auto":0,"manual":0,"streak":0,"longestStreak":0}},{"name":"resets","singularName":"reset","icon":"refresh","count":0,"extra":{"auto":0,"manual":0}},{"name":"automation","icon":"robot","count":0,"extra":{"total":0}}]'),j=JSON.parse('[{"name":"totalTime","icon":"clock","display":"time"},{"name":"activeTime","icon":"alarm","display":"time","extra":{"current":0,"max":0}},{"name":"offlineTime","icon":"user-off","display":"time","extra":{"current":0,"max":0}}]');function O(e,{kind:s="",source:t="",value:n,min:a=0,max:i=1/0,direction:r=-1,streakKind:o="",maxStreakKind:l="",minStreakKind:u="",resetStreakSource:d="",combineWithCurrentTick:h=!1,assignToResourceTick:g=!0}={},m){const f=e.tick,v=(n,h)=>{var g,f,v,x;if(t&&h!==t)d&&h!==d||o&&(e.extra[o]=r>0?a:r<0?i:0);else{let t=null!==(g=s?e.extra[s]:e.count)&&void 0!==g?g:0;if((t>a||r>0)&&(t<i||r<0)&&(t=(0,c.Z)(t+r*n,a,i),s?e.extra[s]=t:e.count=t,o&&(e.extra[o]=(0,c.Z)((null!==(f=e.extra[o])&&void 0!==f?f:0)+r*n,a,i),l&&(null!==(v=e.extra[l])&&void 0!==v?v:a)<e.extra[o]&&(e.extra[l]=e.extra[o]),u&&(null!==(x=e.extra[u])&&void 0!==x?x:i)>e.extra[o]&&(e.extra[u]=e.extra[o])),m&&(t===a||t===i)))return m(e,t,s,h)}return null},x=f&&h?(e,s)=>(f(e,s),v(e,s)):v;return g&&(e.tick=x),null!=n&&(s?e.extra[s]=n:e.count=n),x}function w(e){for(let s=e.length-1;s>0;s--){const t=Math.floor(Math.random()*(s+1));[e[s],e[t]]=[e[t],e[s]]}return e}function N({board:e}){return 100*(e.cellCounts.revealed+e.cellCounts.flagged)/(e.rows*e.cols)}function y({resourceManager:{resources:{rows:e,cols:s,difficulty:t}}}){return e.value()*s.value()*(t.value()/100)}function k({resourceManager:{resources:{hintQuality:e}}}){return e.value()/100}function _({board:e}){return e.rows*e.cols-e.numMines-e.cellCounts.revealed}function C({resourceManager:{resources:{rows:e,cols:s,difficulty:t,resetSpeed:n}}}){return(1-n.value()/100)*Math.sqrt(e.value()*s.value()*(t.value()/100)*10)}function M({resourceManager:{resources:{difficulty:e}}}){return(e.value()+10)/25}function S(e,s,t,n,a,i){var r,o;const l=e.resourceManager.resources.revealNeighbors,c=[];for(let e=t.row-1;e<=t.row+1;e++)for(let n=t.col-1;n<=t.col+1;n++)"hidden"===(null===(o=(null!==(r=s.cells[e])&&void 0!==r?r:[])[n])||void 0===o?void 0:o.state)&&c.push(s.cells[e][n]);w(c).splice(n);for(const s of c)d(s,"reveal"),a&&(R(e,"cell",s.state,!0),"revealed"===s.state&&"clear"===s.contents?l.extra.reveals++:"blown"===s.state||"mine"===s.contents?l.extra.explosions++:l.extra.useless++);return a&&(E(e,l.name,i),0===c.length&&l.extra.useless++),c.length}function E(e,s,t,n=1){const a=M(e),i=e.resourceManager.resources[null!=s?s:""],r=e.resourceManager.resources.automation;t?(r.count+=a*n,r.extra.total+=n,i&&null!=i.extra.auto&&(i.extra.auto+=n)):i&&null!=i.extra.manual&&(i.extra.manual+=n),i&&null!=i.extra.streak&&(i.extra.streak+=n,null!=i.extra.longestStreak&&i.extra.streak>i.extra.longestStreak&&(i.extra.longestStreak=i.extra.streak))}function R(e,s,t,n,a=1){const i=M(e),r=T[s+":"+t];let o=e.resourceManager.resources[null!=r?r:""];switch(r&&o&&(o.count+=a*i,E(e,o.name,n,a)),s+":"+t){case"cell:unflagged":o=e.resourceManager.resources.flags,o.count-=a*i,o.extra.unflags+=a;break;case"cell:unrevealed":o=e.resourceManager.resources.cells,o.count-=a*i,o.extra.hidden+=a;break;case"board:won":e.resourceManager.resources.losses.extra.streak=0;break;case"board:lost":e.resourceManager.resources.wins.extra.streak=0}}const T={"board:active":"resets","board:lost":"losses","board:won":"wins","cell:blown":"explosions","cell:hinted":"hints","cell:flagged":"flags","cell:revealed":"cells"},A={"":{min:1,max:1,inc:1},x1:{min:1,max:1,inc:1},x5:{min:1,max:5,inc:5},x10:{min:1,max:10,inc:10},"+5":{min:5,max:5,inc:1},"+10":{min:10,max:10,inc:1},max:{min:1,max:100,inc:1}};function U(e,s,t){var n,a;return s.count<=0||null!==(n=s.unlocked)&&void 0!==n&&!n||s.disabled?NaN:(null!=t||(t=(Date.now()-(null!==(a=s.execution.lastTick)&&void 0!==a?a:Date.now()))/1e3/e.settings.timeDilation),t*s.count/e.settings.automationBaseSecs)}function D(e){return"revealed"===e.state&&"clear"===e.contents&&e.neighborContents.mine===e.neighborStates.flagged&&e.neighborStates.hidden>0}function P(e){return"revealed"===e.state&&"clear"===e.contents&&e.neighborContents.mine===e.neighborStates.flagged+e.neighborStates.hidden&&e.neighborContents.clear===e.neighborStates.revealed&&e.neighborStates.hidden>0}function q(e){return"hinted"===e.state&&"clear"===e.contents}var I=t(458);const B=[j,x,b,p,v];const L={ticksPerSecond:60,framesPerSecond:10,saveFrequencySecs:60,rateUpdateSecs:1,rateHistoryWindow:10,minResourceUpdateSecs:.001,maxResourceUpdateSecs:86400,maxResourceTickSecs:1,lastReset:Date.now(),lastUpdate:Date.now(),lastSaved:0,lastLoaded:Date.now(),maxErrors:1,sellRatio:.8,automationBaseSecs:60,timeDilation:1,tutorialStep:0,tapMode:"reveal",buyAmount:"x1",theme:""};function $(e){const s=e||{};return s.settings=Object.assign(Object.assign({},L),{lastReset:Date.now(),lastUpdate:Date.now(),lastLoaded:Date.now()}),s.board=Object.assign({},h),s.resourceManager=(t=(0,I.QE)(s,s.settings),B.flat().map((e=>t.upsert(e))).forEach((e=>{"string"==typeof e.cost&&(e.cost=(0,I.FO)(t,e.cost))})),O(t.get("resetSpeed"),{kind:"remainingTime"}),O(t.get("totalTime"),{direction:1}),O(t.get("activeTime"),{direction:1,source:"tick",streakKind:"current",maxStreakKind:"max",resetStreakSource:"load"}),O(t.get("offlineTime"),{direction:1,source:"load",streakKind:"current",maxStreakKind:"max",resetStreakSource:"tick"}),v.map((e=>t.get(e.name))).map((e=>e.shouldTick=function(e,s){return function(t,n){return"tick"===n&&U(e,s,t)>=1}}(t.context,e))),t.get("autoRevealNeighbors").tick=()=>function(e){var s;const t=e.resourceManager.resources.autoRevealNeighbors;if(t.count<=0||null!==(s=t.unlocked)&&void 0!==s&&!s||t.disabled||"active"!==e.board.state)return null;const n=e.board.cells.flat().filter(D);return 0!==n.length&&S(e,e.board,w(n)[0],e.resourceManager.resources.revealNeighbors.count,!0,!0)>0}(t.context),t.get("autoResetGame").tick=()=>function(e){var s;const t=e.resourceManager.resources;if(t.autoResetGame.count<=0||null!==(s=t.autoResetGame.unlocked)&&void 0!==s&&!s||t.autoResetGame.disabled||"active"===e.board.state||"inactive"===e.board.state||t.resetSpeed.extra.remainingTime>0)return null;function n(s,n){if(n<=.001){const s=y(e);e.settings.tapMode="reveal",e.board=m(t.rows.value(),t.cols.value(),Math.floor(s),Math.ceil(s)),R(e,"board","active",!0)}}const a=C(e);return a<.001?(n(t.resetSpeed,a),!0):(O(t.resetSpeed,{kind:"remainingTime",value:a},n),!1)}(t.context),t.get("autoFlagMines").tick=()=>function(e){var s,t,n;const a=e.resourceManager.resources.autoFlagMines;if(a.count<=0||null!==(s=a.unlocked)&&void 0!==s&&!s||a.disabled||"active"!==e.board.state)return null;const i=e.board.cells.flat().filter(P);if(0===i.length)return!1;const r=w(i)[0],o=[];for(let s=r.row-1;s<=r.row+1;s++)for(let a=r.col-1;a<=r.col+1;a++)"hidden"===(null===(n=(null!==(t=e.board.cells[s])&&void 0!==t?t:[])[a])||void 0===n?void 0:n.state)&&o.push(e.board.cells[s][a]);if(0===o.length)return!1;const l=w(o)[0];return d(l,"flag"),R(e,"cell",l.state,!0),!0}(t.context),t.get("autoRevealHints").tick=()=>function(e){var s;const t=e.resourceManager.resources.autoRevealHints;if(t.count<=0||null!==(s=t.unlocked)&&void 0!==s&&!s||t.disabled||"active"!==e.board.state)return null;const n=e.board.cells.flat().filter(q);if(0===n.length)return!1;const a=w(n)[0];return d(a,"reveal"),R(e,"cell",a.state,!0),!0}(t.context),t.get("autoPurchaseHints").tick=()=>function(e){var s;const t=e.resourceManager.resources.autoPurchaseHints;if(t.count<=0||null!==(s=t.unlocked)&&void 0!==s&&!s||t.disabled||"active"!==e.board.state||0===_(e))return null;if(e.board.cells.flat().filter((e=>q(e)||D(e)||P(e))).length>0)return!1;const n=e.resourceManager.resources.hints.buy();if(0===n.count)return!1;const a=f(e.board,e.resourceManager.resources.hintsCount.value(),0,8,k(e)*n.count);return R(e,"cell","hinted",!0,a),e.resourceManager.resources.hints.count-=n.count,!0}(t.context),t.get("autoBoardUpgrade").tick=()=>function(e){var s;const t=e.resourceManager.resources;if(t.autoBoardUpgrade.count<=0||null!==(s=t.autoBoardUpgrade.unlocked)&&void 0!==s&&!s||t.autoBoardUpgrade.disabled)return null;const n=t.rows.count<t.cols.count?t.rows:t.cols;return 0!==n.buy().count&&(E(e,n.name,!0),!0)}(t.context),t),s;var t}const W="Context";function F(e,s){const t=Object.assign({},e),n=!!s&&l._B(t,s);if(n){let s;for(s in t.settings)(0,r.Z)(e.settings,s,t.settings[s]);e.board=g(Object.assign(Object.assign({},e.board),t.board)),(0,I.xV)(e.resourceManager,t.resourceManager),e.settings.lastLoaded=Date.now(),e.resourceManager.update(void 0,"load")}return n}function z(e,s){return e.settings.lastSaved=Date.now(),l.po(e,s)}const K=$(),Z=(0,i.createContext)(K),G=e=>(0,n.jsx)(Z.Provider,Object.assign({value:K},{children:e.children}));function H(){return e=(0,i.useContext)(Z),Object.assign(Object.assign(Object.assign({},e.resourceManager),e),{context:e,setBoard:s=>e.board=s,resource:s=>e.resourceManager.get(s),load:()=>{return F(e,(s=W,o()?window.localStorage.getItem(s):null));var s},loadAs:s=>F(e,s),save:s=>{return t=W,n=z(e,s),void(o()&&n&&window.localStorage.setItem(t,n));var t,n},saveAs:s=>z(e,s),reset:()=>function(e){var s;s=W,o()&&window.localStorage.removeItem(s),$(e)}(e)});var e}function J(){const e=H(),s=(0,i.useMemo)((()=>e.saveAs(!0)),[]);return(0,n.jsxs)("div",Object.assign({id:"reset"},{children:[(0,n.jsxs)("div",Object.assign({className:"panel options"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Load Failure!"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"Looks like something went very wrong in loading the game. It's possible that the game version is out of date, or that the save data is corrupt."})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"full"},{children:"For your records, here is the current contents of the save state. Keep this somewhere before resetting the game:"})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:(0,n.jsx)("textarea",{value:s,readOnly:!0})}))]})),(0,n.jsxs)("div",Object.assign({className:"panel options reset"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar warning"},{children:"Game Reset"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"WARNING: this will completely reset your game and delete all saved progress and settings. This will hard reset the game from beginning."})),(0,n.jsx)("div",Object.assign({className:"full right"},{children:(0,n.jsx)("input",{type:"button",value:"Hard Reset Everything",onClick:function(){confirm("Are you sure you want to reset? This cannot be undone.")&&(e.reset(),window.location.reload())}})}))]}))]}))}var V=t(711),Q=t(974);function Y(e,...s){return(...t)=>e(...s,...t)}function X(e,s="expanded",t=!1,n=("expanded"===s?", ":":"),a="",i="",r=""){if(i.length>0&&e<0)return i;if(a.length>0&&0===e)return a;let o=Math.floor(e/1e3),l=Math.floor(e-1e3*o),c=Math.floor(o/60);o-=60*c;let u=Math.floor(c/60);c-=60*u;let d=Math.floor(u/24);u-=24*d;let h=Math.floor(d/365);if(d-=365*h,t||(l=0),a.length>0&&d+u+c+o+l===0)return a;let g=[];return g="expanded"!==s?[h>0?h.toFixed(0):"",d>0?d.toFixed(0):"",u>0||"compact"===s?u.toFixed(0):"",c>0||"compact"===s?c.toFixed(0):"",(o+l/1e3).toFixed(!t||"tiny"===s&&0===l?0:3)].map((e=>"compact"!==s||1!==e.length&&1!==e.indexOf(".")?e:"0"+e)):[[h,"year"],[d,"day"],[u,"hour"],[c,"minute"],[o,"second",h+d+u+c===0,l]].map((([e,s,t=!1,n=0])=>e>0||n>0||t&&0===e?e.toString()+(n>0?"."+n.toString():"")+" "+s+(1===e?"":"s"):"")),g.filter((e=>e.length>0)).join(n)+(r.length>0?" "+r:"")}const ee={floor:Math.floor,round:Math.round,ceil:Math.ceil};function se(e,s,t){const n=Math.pow(10,s);return ee[t](e*n)/n}var te=t(415);const ne=JSON.parse('{"hidden":"question-mark","hinted":"eye","flagged":"flag-2","blown":"alert-triangle","revealed":["square-dot","square-1","square-2","square-3","square-4","square-5","square-6","square-7","square-8","square"]}');function ae(e){var s,t;const n="string"==typeof e?{id:e}:e;let a,i=document.getElementById(null!==(s=n.id)&&void 0!==s?s:"");for(a in i||(i=document.createElement(null!==(t=n.tagName)&&void 0!==t?t:"div"),document.body.appendChild(i)),n)(0,r.Z)(i,a,n[a]);return i}function ie(e){e?document.documentElement.setAttribute("theme",e):document.documentElement.removeAttribute("theme")}function re(e){var s,t,a,i,r,o,l;const c=null!==(t=null===(s=e.cell)||void 0===s?void 0:s.state)&&void 0!==t?t:e.state,u=null!==(r=null===(i=null===(a=e.cell)||void 0===a?void 0:a.neighborContents)||void 0===i?void 0:i.mine)&&void 0!==r?r:e.neighbors;let d=e.icon;if(!d){const e=ne[null!=c?c:"hidden"];if(e instanceof Array)d=e[null!=u?u:0];else{if(null==e)return null;d=e}}const h=d.split(/\s+/).filter((e=>e.trim().length>0));d=null!==(o=h.pop())&&void 0!==o?o:d;let g=null!==(l=h.pop())&&void 0!==l?l:e.color;const m=["icon"];return d&&m.push("icon-"+d),c&&m.push("icon-"+c),g&&!g.startsWith("#")&&(m.push(g),g=void 0),e.className&&m.push(e.className),(0,n.jsx)("svg",Object.assign({className:m.join(" "),width:e.size,height:e.size,color:g},{children:(0,n.jsx)("use",{xlinkHref:`#tabler-${d}`})}))}window.addEventListener("load",(()=>ae("icon").innerHTML=te),!1);const oe={tiny:4,compact:9,expanded:21},le={number:1,percentage:1,time:1e3};function ce(e){var s,t,a,i,r,{value:o,epoch:l,name:u,resource:d={name:u,count:o},kind:h,display:g=(null!==(s=d.display)&&void 0!==s?s:"number"),length:m="expanded",rounding:f=("number"===g?"floor":"round"),showLocked:v=!1,showIcon:x=!0,showName:p=!0,showValue:b=!0,showMaxValue:j=!1,showRawValue:O=!1,showRate:w=!1,showExtras:N=!1,showRawExtras:y=N&&O,showColors:k=!1,showRateColors:_=!0,showNegatives:C=!0,showZeros:M=!0,showPlusSign:S=!1,showGrouping:E="number"===g,showZeroRates:R=!1,showRatePercentages:T="number"===g,showRateHistory:A=!1,showCapitalized:U=!0,showChrome:D=!1,precision:P=("time"===g?3:"number"===g?2:0),valuePrecision:q=P,rawValuePrecision:I=q,ratePrecision:B=("time"===g?0:P),extrasPrecision:L=P,rawExtrasPrecision:$=L,reversedDirection:W=!1,prefix:F="",suffix:z="",infix:K=":",placeholder:Z="-",timeSeparator:G=("expanded"===m?", ":":"),ago:H="ago",now:J="now",never:V="never",className:Q="",style:Y}=e;const ee=[];function te(e=NaN,s="",{prec:t=P,rnd:a=f,cls:i="",disp:r=g,len:o=m,neg:u=C,zero:d=M,plus:h=S,grp:v=E,color:x=k,paren:p=!1,sep:b=G,pre:j="",post:O="",ref:w=!1,dry:N=!1}){const y=se((e-(w&&l?l:0))*le[r],t,a);if(isNaN(y)||!u&&y<0||!d&&0===y)return"";const _=[r.toString()];if(i&&_.push(i),x){const e=W?-y:+y;_.push(e>0?"positive":e<0?"negative":"zero")}let R=Z;return"number"===r||"percentage"===r?(R=function(e,s=21,t=3,n=!1,a=!1){const i={style:"decimal",notation:"standard",signDisplay:n?"always":"auto",useGrouping:a,minimumIntegerDigits:1,minimumFractionDigits:0,maximumFractionDigits:(0,c.Z)(t,0,s-1),minimumSignificantDigits:1,maximumSignificantDigits:s},r=e.toLocaleString(void 0,i);return r.replace(/\D/g,"").length>s?(i.notation="scientific",e.toLocaleString(void 0,i)):r}(y,oe[o],t,h,v),"percentage"===r&&(R+="%")):"time"===r&&(R=w&&V.length>0&&(e<=0||(null!=l?l:-1/0)<=0)?V:w&&null!=l?X(y,o,t>0,b,J,V,H):X(y,o,t>0),h&&y>=0&&"expanded"!==o&&(R=`+${R}`)),R=j+R+O,p&&(R=`(${R})`),N||ee.push((0,n.jsx)("div",Object.assign({className:_.join(" ")},{children:R}),s)),R}function ne(e,{condition:s=!0,empties:t=!1,caps:n=U}={}){return s&&(t||null!=e&&e.length>0)?n?(null!=e?e:"").replace(/([a-z])([A-Z]|_\S)/g,((e,s,t)=>`${s} ${t.slice(-1)}`)).replace(/(?:^|\s)\S/g,(e=>e.toUpperCase())):e:null}function ae(){var e,s,t;return null!==(t=null!==(e=null!=o?o:d.value?d.value(h):void 0)&&void 0!==e?e:(null!==(s=d.extra)&&void 0!==s?s:{})[null!=h?h:""])&&void 0!==t?t:d.count}const ie=["resource"];if((x&&d.icon||p&&d.name)&&ee.push((0,n.jsxs)("div",Object.assign({className:"name"},{children:[x&&d.icon&&d.icon.length>0?(0,n.jsx)(re,{icon:d.icon,size:"1em"}):null,ne(function(){var e,s;if(u)return u;let t=se((null!==(e=ae())&&void 0!==e?e:0)*le[g],q,f);return null!==(s=1===Math.abs(t)?d.singularName:d.pluralName)&&void 0!==s?s:d.name}(),{condition:p}),K]}),"name")),b){const e=j?te(d.maxCount,"denominator",{prec:q,pre:" / ",dry:!0}):"";te(ae(),"value",{prec:q,ref:null!=l&&!isNaN(l),post:e,cls:"value"})}if(O&&te(null!=o?o:h&&d.extra?d.extra[h]:d.count,"raw-value",{disp:"number",prec:I,paren:b,cls:"raw-value"}),w&&!h&&null!=d.rate&&(null!==(t=d.rate.lastCountUpdate)&&void 0!==t?t:0)>0&&(R||0!==d.rate.count)){let e=0;if(A&&d.rate.pastCounts.length>0){let s=0,t=d.rate.pastCounts.length;d.rate.pastCounts.forEach(((n,a)=>{const i=t-a;e+=n*i,s+=i})),e/=s}else e=d.rate.count;let s=T,t=T?null!==(a=ae())&&void 0!==a?a:0:1;(0===t||s&&(e/t<.01||t<1e3))&&(s=!1,t=1),te(e/t,"rate",{disp:s?"percentage":g,prec:B,paren:b||O,color:_,len:s||"expanded"!==m?"tiny":"compact",cls:"rate",neg:!0,zero:!0,plus:!0,grp:!1,post:"/s"})}if((N||y)&&!h&&d.extra&&Object.keys(d.extra).length>0)for(let e in d.extra)e.length>0&&(ee.length>0&&ee.push((0,n.jsx)("div",{className:"break"},`break-${e}`)),ee.push((0,n.jsxs)("div",Object.assign({className:"extra-name"},{children:[ne(e),K]}),`extra-name-${e}`))),N&&te(d.value?d.value(e):d.extra[e],`extra-value-${e}`,{disp:e.toLowerCase().indexOf("time")>=0?"time":g,prec:L,cls:"extra-value"}),y&&te(d.extra[e],`extra-raw-${e}`,{disp:"number",prec:$,paren:N,cls:"raw-extra-value"}),w&&null!=d.rate&&(null!==(i=d.rate.lastCountUpdate)&&void 0!==i?i:0)>0&&(R||0!==d.rate.count)&&ee.push((0,n.jsx)("div",Object.assign({className:"rate"},{children:Z}),`extra-rate-${e}`));v||null===(r=d.unlocked)||void 0===r||r||(ie.push("locked"),ee.splice(0,ee.length,(0,n.jsx)("div",Object.assign({className:"placeholder"},{children:Z}),"lock")));const ce=D?void 0:Y;Q&&!D&&ie.push(Q);const ue=(0,n.jsxs)("div",Object.assign({className:ie.join(" "),style:ce,id:`resource-${null!=u?u:d.name}`},{children:[F&&(0,n.jsx)("div",Object.assign({className:"prefix"},{children:F})),ee,z&&(0,n.jsx)("div",Object.assign({className:"suffix"},{children:z}))]}));return D?(0,n.jsx)("div",Object.assign({className:Q||void 0,style:Y,id:`resource-chrome-${null!=u?u:d.name}`},{children:ue})):ue}function ue({resource:e,kind:s,enabled:t=!0,allowUnlocking:a=!1,maxNum:i,minNum:r,increment:o,precision:l,gainMultiplier:u=1,costMultiplier:d=1,overrideCount:h,overrideMaxCount:g,overrideMinCount:m,prefix:f="Buy",suffix:v="",infix:x="for",and:p="&",className:b,style:j,onPurchase:O}){var w;const{resourceManager:N,settings:{buyAmount:y}}=H(),k=N.get(e),_=function(e){var s;return null!==(s=A[null!=e?e:""])&&void 0!==s?s:A[""]}(y);function C(e,s){return e.map(((e,t)=>{var i;return(0,n.jsx)(ce,{resource:"string"==typeof e.resource?{name:e.resource}:e.resource,value:e.count*s,kind:e.kind,display:"string"!=typeof e.resource?e.resource.display:"number",precision:l,infix:"",placeholder:"",prefix:t>0?p:"",showLocked:a,showValue:"string"==typeof e.resource||null===(i=e.resource.unlocked)||void 0===i||i,showColors:!0,showChrome:!0,showPlusSign:!0,className:"value-first"},"string"==typeof e.resource?e.resource:e.resource.name)}))}function M(e=0,s=1){var t,n;const a=null!=h?h:k.count;return(0,c.Z)(Math.floor((a+e)/s)*s,Math.max(null!=m?m:-1/0,null!==(t=k.minCount)&&void 0!==t?t:0),Math.min(null!=g?g:1/0,null!==(n=k.maxCount)&&void 0!==n?n:1/0))-a}null!=r||(r=_.min),null!=i||(i=_.max),null!=o||(o=_.inc),null===(w=k.unlocked)||void 0===w||w||(a?r=i=o=1:(r=i=o=0,t=!1)),u<0&&d<0&&([u,d]=[-u,-d],[r,i,o]=[-r,-i,-o]);let S=!0,E=k.buy(M(i,o),"dry-partial",s,1,d);E.count%o!=0&&(E=k.buy(M(E.count,o),"dry-partial",s,1,d)),(Math.abs(E.count)<Math.abs(r)||0===E.count)&&(E=k.buy(Math.max(Math.sign(o),M((0,c.Z)(o,Math.min(r,i),Math.max(r,i)))),"dry-full",s,1,d),S=!1),t||(E.cost=[]);const R=E.cost.reduce(((e,s)=>e+s.count),0),T=["buy-button",`buy-button-${S?"":"un"}affordable`,b].filter((e=>!!e));return(0,n.jsxs)("button",Object.assign({onClick:Y((function(e,n){var i;if(n.preventDefault(),!t||0===e)return;null!==(i=k.unlocked)&&void 0!==i&&!i&&a&&(k.unlocked=!0);const r=k.buy(e,"partial",s,u,d);O&&O(k,s,r.count)}),S&&t?E.count:0),disabled:!S||!t,className:T.join(" "),style:j,id:`button-buy-${k.name}`},{children:[f&&(0,n.jsx)("div",Object.assign({className:"prefix"},{children:f})),C(E.gain,u),0!==R&&x&&(0,n.jsx)("div",Object.assign({className:"infix"},{children:x})),0!==R&&C(E.cost,-1),v&&(0,n.jsx)("div",Object.assign({className:"suffix"},{children:v}))]}))}function de({showTapMode:e=!0,showBuyAmount:s=!0}){const{settings:t}=H(),[a,r]=(0,i.useState)(t.tapMode),[o,l]=(0,i.useState)(t.buyAmount);function c(e){e.preventDefault(),t.buyAmount=e.target.value,l(t.buyAmount)}function u(e,s,a){return(0,n.jsxs)("button",Object.assign({type:"button",value:e,className:(i=e,i===t.buyAmount?"selected":"unselected"),onClick:c,id:`button-${e.replace(/\W/g,"")}`},{children:[s&&(0,n.jsx)(re,{icon:s,size:"1em"}),a]}));var i}return(0,n.jsxs)("div",Object.assign({className:"panel mode-controls"},{children:[e&&(0,n.jsxs)("div",Object.assign({className:"left"},{children:[(0,n.jsx)("span",{children:"Tap mode:"}),(0,n.jsxs)("button",Object.assign({type:"button",value:t.tapMode,onClick:function(e){e.preventDefault(),t.tapMode="reveal"===t.tapMode?"flag":"reveal",r(t.tapMode)},id:"button-tapmode"},{children:[(0,n.jsx)(re,{state:"reveal"===t.tapMode?"revealed":"flagged",neighbors:9,size:"1em"}),"reveal"===t.tapMode?"Revealing":"Flagging"]}))]})),(0,n.jsx)("div",{className:"spacer"}),s&&(0,n.jsxs)("div",Object.assign({className:"right"},{children:[(0,n.jsx)("span",{children:"Buy amount:"}),u("x1","x","1"),u("x5","arrow-bar-to-right","5"),u("+5","x","5"),u("x10","arrow-bar-to-right","10"),u("+10","x","10"),u("max",void 0,"MAX")]}))]}))}function he({value:e=NaN,minValue:s=0,maxValue:t=1,orientation:a="horizontal",width:i=("horizontal"===a?"100%":"1ex"),height:r=("vertical"===a?"100%":"1ex"),showPercent:o=!1,enabled:l=!isNaN(e),className:c,children:u}){const d=(e-s)/(t-s),h="horizontal"===a?d:1,g="vertical"===a?d:1;return(0,n.jsxs)("div",Object.assign({className:`progress-bar ${null!=c?c:""}`,style:{minWidth:i,minHeight:r}},{children:[(0,n.jsxs)("div",Object.assign({className:"children"},{children:[l&&o&&(0,n.jsxs)("span",{children:[Math.floor(100*d),"%"]}),u]})),l&&d>.001&&(0,n.jsx)("div",{className:"primary",style:{width:100*h+"%",height:100*g+"%"}}),(0,n.jsx)("div",{className:l?"secondary":"disabled"})]}))}function ge(){const{context:e,board:s,resources:{wins:t,cells:a,automation:i}}=H();return(0,n.jsxs)("div",Object.assign({className:`panel board-state-${s.state}`,id:"resource-bar"},{children:[(0,n.jsx)(ce,{resource:t,precision:0,showRate:!0,showZeroRates:!0,showRatePercentages:!1,showChrome:!0}),i.extra.total>=5&&(0,n.jsx)(ce,{resource:i,precision:0,showRate:!0,showZeroRates:!0,showRatePercentages:!1,showChrome:!0}),(0,n.jsx)(ce,{resource:a,precision:0,showRate:!0,showZeroRates:!0,showRatePercentages:!1,showChrome:!0}),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)(ce,{name:"Board",suffix:`${s.rows}x${s.cols}`,showChrome:!0}),(0,n.jsx)(ce,{name:"progress",value:N(e),display:"percentage",showChrome:!0}),(0,n.jsx)(ce,{resource:{name:"Mines",count:s.cellCounts.flagged,maxCount:s.numMines},showMaxValue:!0,showChrome:!0})]}))}function me({enabled:e=!0,checked:s=!1,onChange:t,checkedContents:a,unCheckedContents:r,className:o,style:l,children:c}){const[u,d]=(0,i.useState)(!1);(0,i.useEffect)((()=>{d(s)}),[s]);const h=["toggle-button",`toggle-button-${e?"en":"dis"}abled`,`toggle-button-${s?"":"un"}checked`,o].filter((e=>!!e));return(0,n.jsxs)("div",Object.assign({onClick:function(s){s.preventDefault(),e&&(d(!u),t&&t(!u))},className:h.join(" "),style:l},{children:[(0,n.jsx)("div",Object.assign({className:"check"},{children:(0,n.jsx)("div",{children:a})})),(0,n.jsx)("div",Object.assign({className:"contents"},{children:c})),(0,n.jsx)("div",Object.assign({className:"uncheck"},{children:(0,n.jsx)("div",{children:r})})),(0,n.jsx)("div",{className:"circle"})]}))}function fe(){const{context:e,resources:{revealNeighbors:s,autoRevealNeighbors:t,autoFlagMines:a,autoRevealHints:i,autoPurchaseHints:r,autoResetGame:o,autoBoardUpgrade:l}}=H();function c(s){return s.count>=100?1:U(e,s)}return(0,n.jsxs)("div",Object.assign({id:"automation",className:"automation"},{children:[(0,n.jsx)(ge,{}),(0,n.jsx)(de,{showTapMode:!1}),(0,n.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Cell Automation"})),(0,n.jsx)("div",Object.assign({className:"half"},{children:(0,n.jsx)(ce,{resource:t,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===t.count?"":"s"} a minute`})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:t,allowUnlocking:!0,enabled:s.unlocked&&s.count>0,prefix:t.unlocked?"Additional":"Unlock"})})),(0,n.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,n.jsx)(me,{checked:t.unlocked&&!t.disabled,onChange:e=>t.disabled=!e,checkedContents:(0,n.jsx)(re,{icon:"robot"}),unCheckedContents:(0,n.jsx)(re,{icon:"robot-off"}),enabled:t.unlocked&&t.count>0})]})),(0,n.jsx)(he,Object.assign({value:c(t),className:"full computed"},{children:"Automatically reveals the neighboring hidden squares if all the mines around it have been flagged."})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"half"},{children:(0,n.jsx)(ce,{resource:a,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===a.count?"":"s"} a minute`})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:a,allowUnlocking:!0,enabled:t.unlocked&&t.count>0,prefix:a.unlocked?"Additional":"Unlock"})})),(0,n.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,n.jsx)(me,{checked:a.unlocked&&!a.disabled,onChange:e=>a.disabled=!e,checkedContents:(0,n.jsx)(re,{icon:"robot"}),unCheckedContents:(0,n.jsx)(re,{icon:"robot-off"}),enabled:a.unlocked&&a.count>0})]})),(0,n.jsx)(he,Object.assign({value:c(a),className:"full computed"},{children:"Automatically flags the hidden mines around a square if there are no more hidden clear squares left around it."})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"half"},{children:(0,n.jsx)(ce,{resource:i,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===i.count?"":"s"} a minute`})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:i,allowUnlocking:!0,prefix:i.unlocked?"Additional":"Unlock"})})),(0,n.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,n.jsx)(me,{checked:i.unlocked&&!i.disabled,onChange:e=>i.disabled=!e,checkedContents:(0,n.jsx)(re,{icon:"robot"}),unCheckedContents:(0,n.jsx)(re,{icon:"robot-off"}),enabled:i.unlocked&&i.count>0})]})),(0,n.jsx)(he,Object.assign({value:c(i),className:"full computed"},{children:"Automatically reveals any purchased hints."})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"half"},{children:(0,n.jsx)(ce,{resource:r,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===r.count?"":"s"} a minute`})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:r,allowUnlocking:!0,prefix:r.unlocked?"Additional":"Unlock"})})),(0,n.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,n.jsx)(me,{checked:r.unlocked&&!r.disabled,onChange:e=>r.disabled=!e,checkedContents:(0,n.jsx)(re,{icon:"robot"}),unCheckedContents:(0,n.jsx)(re,{icon:"robot-off"}),enabled:r.unlocked&&r.count>0})]})),(0,n.jsx)(he,Object.assign({value:c(r),className:"full computed"},{children:"Automatically makes a hint purchase when there are no other actions available."}))]})),(0,n.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Game Automation"})),(0,n.jsx)("div",Object.assign({className:"half"},{children:(0,n.jsx)(ce,{resource:o,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===o.count?"":"s"} a minute`})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:o,allowUnlocking:!0,prefix:o.unlocked?"Additional":"Unlock"})})),(0,n.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,n.jsx)(me,{checked:o.unlocked&&!o.disabled,onChange:e=>o.disabled=!e,checkedContents:(0,n.jsx)(re,{icon:"robot"}),unCheckedContents:(0,n.jsx)(re,{icon:"robot-off"}),enabled:o.unlocked&&o.count>0})]})),(0,n.jsx)(he,Object.assign({value:c(o),className:"full computed"},{children:"Automatically initiates game reset when the game is either won or lost."}))]})),(0,n.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Board Automation"})),(0,n.jsx)("div",Object.assign({className:"half"},{children:(0,n.jsx)(ce,{resource:l,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===l.count?"":"s"} a minute`})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:l,allowUnlocking:!0,prefix:l.unlocked?"Additional":"Unlock"})})),(0,n.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,n.jsx)(me,{checked:l.unlocked&&!l.disabled,onChange:e=>l.disabled=!e,checkedContents:(0,n.jsx)(re,{icon:"robot"}),unCheckedContents:(0,n.jsx)(re,{icon:"robot-off"}),enabled:l.unlocked&&l.count>0})]})),(0,n.jsx)(he,Object.assign({value:c(l),className:"full computed"},{children:"Automatically purchases game width and game height expansions if affordable."}))]}))]}))}function ve(e,s,t){const n=s[e];if(!n)return;const a=Object.keys(s).map((e=>parseInt(e))).sort(((e,s)=>e-s)),i=a.indexOf(e),o=a[i-1],l=a[i+1],c=se(e+100,-2,"floor");return function(e,s,...t){const n=Object.assign({},s);if(e){let s;for(s in e){let a=e[s];(0,r.Z)(n,s,"function"==typeof a?a(n,...t):a)}}return n}(n,{step:e,enabled:!0,title:`Tutorial step #${e}`,body:"...",prevStep:o,prevStepTitle:"< back",nextStep:l>=0?l:c,nextStepTitle:l>=0?"next >":"done",skipToStep:c,skipToStepTitle:"skip >>>",highlightSelector:"",greyOut:!1,bounds:{left:"50% - 200px",top:"6rem",width:"400px",height:"450px"}},t)}const xe={0:{title:"Progressive Mine Sweep",body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:"Hi! Welcome to progressive mine sweeper."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"This is my special take on the classic minesweeper game with progressive / incremental aspects built into it."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"The first part of this tutorial will walk you through how to play minesweeper. At any point in tutorial you can move to the next or previous pages. Feel free to skip to the next chapter if you already know how to play!"}))]}),greyOut:!0}};function pe(e){var s,t;const a=H(),[r,o]=(0,i.useState)(0),l=null!==(s=e.board)&&void 0!==s?s:a.board,u=e.cell,h=!e.board,m=(0,i.useCallback)((function(s){var t,n,i;s.preventDefault();const r=a.resources.clicks;if(h&&r.count++,null!==(t=e.enabled)&&void 0!==t&&!t||u.locked)return void(h&&r.extra.useless++);const m=u.state;if(2===s.button&&"contextmenu"===s.type||0===s.button&&"click"===s.type&&("flag"===a.settings.tapMode||s.altKey||s.ctrlKey||s.metaKey||s.shiftKey)?(h&&r.extra.right++,d(u,"flag")):0===s.button&&"click"===s.type&&"reveal"===a.settings.tapMode?(h&&r.extra.left++,d(u,"reveal")):0===s.button&&"dblclick"===s.type&&(h&&(r.extra.double++,o((e=>(r.extra.useless-=(0,c.Z)(e,0,2),r.extra.left-=(0,c.Z)(e,0,2),0)))),null===(n=a.resources.revealNeighbors.unlocked)||void 0===n||n?S(a,l,u,a.resources.revealNeighbors.count,h,!1):h&&r.extra.useless++),m===u.state&&"dblclick"!==s.type)o((e=>e+1)),h&&r.extra.useless++;else if(o(0),h&&m!==u.state&&(R(a,"cell",u.state,!1),"hidden"===u.state&&R(a,"cell","un"+m,!1)),"active"===l.state){let s=g(l,a.settings.maxErrors);(null!==(i=e.setBoard)&&void 0!==i?i:a.setBoard)(Object.assign({},s)),"active"!==s.state&&h&&R(a,"board",s.state,!1)}}),[l,u,e.enabled]),f=Math.floor((null!==(t=e.boardWidth)&&void 0!==t?t:640)*e.cellRatio/100),v=`min(${e.cellRatio}vmin, ${f}px)`;return(0,n.jsx)("td",Object.assign({className:`cell cell-${u.state}`,onClick:m,onDoubleClick:m,onContextMenu:m,id:`col-${u.col}`},{children:(0,n.jsx)("div",Object.assign({style:{width:v,height:v},id:`cell-${u.row}-${u.col}`},{children:(0,n.jsx)(re,{cell:u})}))}))}function be(e){var s;const t=H(),a=null!==(s=e.board)&&void 0!==s?s:t.board,r=(0,i.useMemo)((function(){const s=Math.floor(95/Math.max(a.rows,a.cols));return(0,n.jsx)("table",Object.assign({id:a===t.board?"board-main":"board-custom",className:"board"},{children:(0,n.jsx)("tbody",{children:a.cells.flatMap(((t,i)=>(0,n.jsx)("tr",Object.assign({id:`row-${i}`},{children:t.map(((t,r)=>(0,n.jsx)(pe,{cell:t,cellRatio:s,enabled:"active"===a.state,board:e.board,setBoard:e.setBoard,boardWidth:e.boardWidth},`cell:${i}:${r}`)))}),`row:${i}:*`)))})}))}),[a]);return(0,n.jsxs)("div",Object.assign({className:"minefield"},{children:[r,e.children]}))}function je(e){const[s,t]=(0,i.useState)(h);return(0,i.useEffect)((()=>{var s,n,a,i,r,o,l;const c=m(e.rows,e.cols,e.randomMines);e.unlocks&&e.unlocks.length>0&&c.cells.forEach((e=>e.forEach((e=>e.locked=!0)))),null===(s=e.mines)||void 0===s||s.forEach((([e,s])=>c.cells[e][s].contents="mine")),null===(n=e.hints)||void 0===n||n.forEach((([e,s])=>c.cells[e][s].state="hinted")),null===(a=e.flags)||void 0===a||a.forEach((([e,s])=>c.cells[e][s].state="flagged")),null===(i=e.reveals)||void 0===i||i.forEach((([e,s])=>c.cells[e][s].state="revealed")),null===(r=e.blowns)||void 0===r||r.forEach((([e,s])=>c.cells[e][s].state="blown")),null===(o=e.locks)||void 0===o||o.forEach((([e,s])=>c.cells[e][s].locked=!0)),null===(l=e.unlocks)||void 0===l||l.forEach((([e,s])=>c.cells[e][s].locked=!1)),t(g(c))}),[e]),(0,n.jsx)(be,{board:s,setBoard:t,boardWidth:e.size})}const Oe={10:{title:"What is minesweeper",body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:"The game board consists of a playing field shaped like a grid of squares. There are a certain number of mines buried under this field. The objective of each game is to successfully clear all the empty cells, and flag the cells containing mines without triggering (exploding) them."})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:"Sample 3x3 board:"})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:(0,n.jsx)(je,{rows:3,cols:3,randomMines:1,size:200})}))]}),greyOut:!0},15:{title:"Revealing a square",body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:"Clicking or tapping on an empty square will reveal its contents. The contents of a square is either clear or a mine. When revealing a clear square, you are given a clue to the number of mines surrounding it — in all directions, including diagonals. Revealing a mine, however, would trigger it and explode!"})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:"Try clicking (or tapping) the hinted square below:"})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:(0,n.jsx)(je,{rows:3,cols:3,size:200,mines:[[2,2]],hints:[[0,0]],unlocks:[[0,0]]})}))]}),greyOut:!0},20:{title:"Revealing squares",body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:(0,n.jsxs)("span",{children:["The revealed contents of  ",(0,n.jsx)(re,{state:"revealed",neighbors:0,size:"1em"}),"  tells us there are no mines in the squares surrounding it, so it's safe to go ahead and reveal the 3 surrounding squares as well!"]})})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:"Try clicking (or tapping) the hinted squares below:"})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:(0,n.jsx)(je,{rows:3,cols:3,size:200,mines:[[2,2]],reveals:[[0,0]],hints:[[0,1],[1,0],[1,1]],unlocks:[[0,1],[1,0],[1,1]]})}))]}),greyOut:!0},25:{title:"Reasoning about squares",body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:(0,n.jsxs)("span",{children:["Uh oh! The  ",(0,n.jsx)(re,{state:"revealed",neighbors:1,size:"1em"}),"  in the middle means there's one mine hidden under one of the remaining squares around the centerpiece! Better be careful with this one..."]})})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"However, we know from the other 2 squares we just revealed that there are no mines in the 2 squares immediately surrounding those places."})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:(0,n.jsx)(je,{rows:3,cols:3,size:200,mines:[[2,2]],reveals:[[0,0],[0,1],[1,0],[1,1]],hints:[[0,2],[1,2],[2,0],[2,1]],unlocks:[[0,2],[1,2],[2,0],[2,1]]})}))]}),greyOut:!0},30:{title:"Flagging squares",body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:"This brings us to the final square in the corner which is obviously a mine! You won't want to set this off!"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"Be careful with this one. Right (or meta) click on the square to flag it, or simply toggle the tapping mode to flag squares instead of revealing:"})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:(0,n.jsx)(je,{rows:3,cols:3,size:200,mines:[[2,2]],reveals:[[0,0],[0,1],[1,0],[1,1],[0,2],[1,2],[2,0],[2,1]]})})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:(0,n.jsx)(de,{showBuyAmount:!1})}))]}),greyOut:!0,onMount:(e,s)=>()=>{we=s.settings.tapMode},onUnmount:(e,s)=>()=>{s.settings.tapMode=we}},35:{title:"Winning a game",body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:"No sweat if you accidentally set off the mine in the previous step."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"Once you reveal all the squares and flag all the mines correctly, you win the playing field, and the game announces it to you."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"Similarly, if you set off a mine, you lose the playing field and need to reset the board."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"In either case, you will be presented with an option to reset the board and receive a brand new game to play. We can upgrade this box and its functions later on."}))]}),greyOut:!0}};let we="reveal";const Ne={100:{title:"Scoring",body:(e,s)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:"Scores are awarded to the player based on how many cells have been successfully marked and how many playing fields have been cleared. These rewards can be used to purchase upgrades to the game to make it more engaging or challenging."})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)(ce,{resource:s.resourceManager.get("wins"),showChrome:!0})})),(0,n.jsx)("div",Object.assign({className:"half left"},{children:"Shows how many fields you have successfully cleared"})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)(ce,{resource:s.resourceManager.get("cells"),showChrome:!0})})),(0,n.jsx)("div",Object.assign({className:"half left"},{children:"Shows how many cells you have cleared without exploding"}))]}),enabled:(e,s)=>s.resourceManager.resources.resets.extra.manual>0,highlightSelector:"div.panel#resource-bar",bounds:{top:"12rem",height:"400px"}},105:{title:"Other scores",body:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",Object.assign({className:"full"},{children:"There are many other scores and resources tracked in the game that you can access via the STATISTICS tab above."}))}),highlightSelector:"div#tab-stats",bounds:{left:"100% - 300px - 2rem",width:"300px",height:"200px"}},110:{title:"Upgrades",body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:"The UPGRADES tab allows you to upgrade various aspects of the game to make it more interesting."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"Side note: this is what makes the game progressive — sometimes also called incremenetal."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"Head over to this tab to check out the different upgrade options available."}))]}),highlightSelector:"div#tab-upgrades",enabled:(e,s)=>s.resourceManager.resources.resets.extra.manual>0,nextStep:e=>document.location.href.includes("upgrades")?null:null==e?void 0:e.step},115:{title:"Upgrades",body:(e,s)=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:"You can increase the playing field size and difficulty of the game in Upgrades section. The cost of these upgrades increases over time, but you will eventually gain enough scores to upgrade them all!"})),(0,n.jsx)("div",Object.assign({className:"half left"},{children:"Game Width:"})),(0,n.jsx)("div",Object.assign({className:"half left"},{children:(0,n.jsx)(ce,{resource:s.resourceManager.get("cols"),showChrome:!0,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"half left"},{children:"Game Height:"})),(0,n.jsx)("div",Object.assign({className:"half left"},{children:(0,n.jsx)(ce,{resource:s.resourceManager.get("rows"),showChrome:!0,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"half left"},{children:"Game Difficulty:"})),(0,n.jsx)("div",Object.assign({className:"half left"},{children:(0,n.jsx)(ce,{resource:s.resourceManager.get("difficulty"),showChrome:!0,showName:!1,infix:"",className:"value-first"})}))]}),highlightSelector:"div#game-upgrades",bounds:{top:"26rem",height:"200px"}},120:{title:"Quality Upgrades",body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:"There are many other upgrades in this tab that improve the quality and various aspects of the game. Such as getting hints or revealing neighboring cells on double-tap!"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"Try them all and make the game more enjoyable."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"PRO TIP: There is a lot more to the game than these upgrades. Use them for a while and a whole lot of new features may open up as you go!"}))]})},200:{title:"Automation",body:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",Object.assign({className:"full"},{children:"The AUTOMATION tab provides new game mechanics to automatically perform some repetitive actions in the game, such as reseting the board or revealing neighboring squares!"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"Head over to this tab to check out the different automation options available."}))]}),highlightSelector:"div#tab-auto",enabled:(e,s)=>s.resourceManager.resources.automation.extra.total>=5,nextStep:e=>document.location.href.includes("auto")?null:null==e?void 0:e.step}},ye=Object.assign(Object.assign(Object.assign({},xe),Oe),Ne);function ke(){const e=H(),s=function(e,s,t){const n={};for(const t in e){const a=t,i=e[t],r=s?s(0,t):i;n[a]=r}return n}(ye,((s,t)=>ve(null!=t?t:0,ye,e))),t=Object.keys(ye).map((e=>parseInt(e))).sort(((e,s)=>e-s));return(0,n.jsx)("div",Object.assign({id:"help"},{children:t.map((e=>function(e){const t=s[e];return t?(0,n.jsx)("div",Object.assign({className:"help"},{children:(0,n.jsxs)("div",Object.assign({className:"panel",id:`help-step-${e}`},{children:[null!=t.title&&""!==t.title&&(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:t.title})),t.body]}))}),`help-panel-${e}`):null}(e)))}))}const _e=JSON.parse('{"active":["Game in progress..."],"inavtive":["There\'s no game yet...?","Hmm... seems like you should reset the board.","Game is inactive :("],"won":["Hooray!!!","Minefield cleared!!","You win!","Game won!","Success!","Amazing job!!!","WIN!","#winning","Sweet!","We\'re all safe again"],"lost":["Oh no! :(","KABOOOM!!!!!","Minefield blown :/","TOTAL CATASTROPHIC LOSS OF EVERYTHING!!!!","Game lost!","You lost this one :(","#fail","What a tragedy...","It wasn\'t your fault!","sadpanda","Rave ruined"],"resetting":["Un-de-mining the playing field","Resetting the board","Ordering new landmines","Contemplating modern warfare","Bulldozing the ground","Wasting time for no reason","Treating shellshock","Rasterizing cell graphics","Writing new reset messages","Pre-computing game features","Calculating total land area","Integrating the area under board","Un-defusing the mines","Calling technical support","Taking the hobbits to Isengard","Reticulating splines","Swapping time and space","Grabbing extra minions","Rupturing the subspace barrier","Creating an anti-time reaction","Converging tachyon pulses","Bypassing control of the matter-antimatter integrator","Adjusting the dilithium crystal converter assembly","Reversing the shield polarity","Disrupting warp fields with an inverse graviton burst","Checking the gravitational constant in your locale","Reconfoobling energymotron","Counting backwards from Infinity","Creating time-loop inversion field","Computing chance of success","Adjusting flux capacitor","Connecting Neurotoxin Storage Tank","Constructing additional pylons","Roping some seaturtles","Locating Jebediah Kerman","Dividing by zero","Cracking military-grade encryption","Simulating traveling salesman","Proving P=NP","Entangling superstrings","Twiddling thumbs","Searching for plot device","Trying to sort in O(n)","Installing dependencies","Ordering 1s and 0s","Mining some bitcoins","Downloading more RAM","Updating to Windows Vista","Deleting System32 folder","Initializing the initializer","Optimizing the optimizer","Updating the updater","Downloading the downloader","Debugging the debugger","Discovering new ways of making you wait","Pushing pixels","Building a wall"]}');function Ce(e,s){var t,n;const a=_e[e];return a&&0!==a.length?"string"==typeof a?a:(null!=s||(s=Math.floor(Math.random()*a.length)),null!==(n=null!==(t=a[s])&&void 0!==t?t:a[0])&&void 0!==n?n:e):e}function Me({value:e,minValue:s=0,maxValue:t=1,width:a="100px",height:i=a,showPercent:r=!1,className:o,children:l}){const c=(e-s)/(t-s);return(0,n.jsxs)("div",Object.assign({className:`progress-circle ${null!=o?o:""}`,style:{minWidth:a,minHeight:i}},{children:[(0,n.jsxs)("div",Object.assign({className:"children"},{children:[r&&(0,n.jsxs)("span",{children:[Math.floor(100*c),"%"]}),l]})),(0,n.jsxs)("svg",Object.assign({viewBox:"-55 -55 110 110",width:a,height:i},{children:[(0,n.jsx)("circle",{className:"secondary",r:50}),(0,n.jsx)("circle",{className:"primary",r:50,transform:"rotate(-90)",strokeDasharray:Math.ceil(100*Math.PI),strokeDashoffset:Math.ceil(100*Math.PI*(1-c))})]}))]}))}function Se(){const{context:e,board:s,setBoard:t,settings:a,resources:{rows:r,cols:o,resets:l,resetSpeed:c}}=H(),[u,d]=(0,i.useState)(s.state),[h,g]=(0,i.useState)(!1),[v,x]=(0,i.useState)(""),[p,b]=(0,i.useState)(0);if((0,i.useEffect)((()=>{d(Ce(s.state))}),[s,s.state]),0===s.rows||0===s.cols||"inactive"===s.state)return k(!0),null;if("active"===s.state)return null;const j=C(e),w=c.extra.remainingTime;function N(e,s=!1){null==e||e.preventDefault(),h||(g(!0),b(0),j<.001?k(s):O(c,{kind:"remainingTime",value:0===w?j:w},((e,t)=>t<=.001&&k(s))))}function k(s=!1){const n=s&&"inactive"===e.board.state&&0===l.count&&0===l.extra.manual&&0===l.extra.auto,i=n?1:y(e);return g(!1),t(m(r.value(),o.value(),Math.floor(i),Math.ceil(i))),R(e,"board","active",s),a.tapMode="reveal",n&&(0===f(e.board,1,0,0,1)&&f(e.board,1,0,1,1),R(e,"cell","hinted",s)),!0}return!h&&w>0&&N(void 0,!0),h&&(!v||j-w>=p)&&(x(Ce("resetting")),b(p+2)),(0,n.jsx)("div",Object.assign({className:"reset-box"},{children:(0,n.jsxs)("div",Object.assign({className:`panel shadow board-state-${s.state}`},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:u})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:"Game over!"})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:"You may reset the board to receive a brand new game to play:"})),(0,n.jsxs)(Me,Object.assign({value:h?(j-w)/j:0,showPercent:h,width:"100%",height:"50%"},{children:[!h&&(0,n.jsx)("input",{type:"button",value:"Reset!",disabled:h,onClick:N,id:"button-reset"}),h&&(0,n.jsxs)("span",{children:[v,"..."]})]}))]}))}))}function Ee(){const{context:e,board:s,setBoard:t,resources:{rows:a,cols:i,hints:r,hintsCount:o,resets:l}}=H(),c=s.rows!==a.value()||s.cols!==i.value();return(0,n.jsxs)("div",Object.assign({id:"main",className:"main"},{children:[(0,n.jsx)(ge,{}),(0,n.jsx)(be,{children:(0,n.jsx)(Se,{})}),(0,n.jsx)(de,{}),(0,n.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,n.jsx)("div",Object.assign({className:"half"},{children:(0,n.jsx)("button",Object.assign({className:"buy-button",onClick:function(){let n=g(s,0);t(Object.assign({},n)),R(e,"board",n.state,!1)},id:"button-reset"},{children:(0,n.jsx)(ce,{resource:l,value:1,showValue:!1,showChrome:!0,infix:"",suffix:"the Game"})}))})),(0,n.jsx)("div",Object.assign({className:"half"},{children:(0,n.jsx)(ue,{resource:r,overrideCount:0,overrideMaxCount:_(e),gainMultiplier:o.value(),onPurchase:function(n,a,i=0){f(s,i,0,8,k(e))>0&&(E(e,"hints",!1),t(Object.assign({},s)))}})})),c&&(0,n.jsxs)("div",Object.assign({className:"left full",id:"reset-info"},{children:["On reset, game board will change to size to",` ${a.value()}x${i.value()}`]}))]}))]}))}const Re=JSON.parse('{"light":"Light Mode","dark":"Dark Mode","jumbo-light":"Jumbo Light","jumbo-dark":"Jumbo Dark","ocean":"Ocean","gold":"Gold","tomato":"Tomato","cyan":"Chocolate","comic":"Cute","murder":"Murder"}');function Te(){var e,s;const t=H(),[a,r]=(0,i.useState)(""),[o,l]=(0,i.useState)(!1),c=(0,Q.s0)(),u=(0,Q.TH)(),d=t.settings,h=Re,g=u.search.toLowerCase().includes("debug");function m(e,s){let t=parseInt(s);if(t>=1&&t<=1e3)switch(e){case"tick":d.ticksPerSecond=t;break;case"render":d.framesPerSecond=t;break;case"save":d.saveFrequencySecs=600/t}}function f(e){var s;d.theme=null!==(s=e.target.getAttribute("theme"))&&void 0!==s?s:void 0,ie(d.theme)}return(0,n.jsxs)("div",Object.assign({id:"options"},{children:[(0,n.jsxs)("div",Object.assign({className:"panel options",id:"options-theme"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Theme Options"})),(0,n.jsxs)("div",Object.assign({className:"full"},{children:["Current theme is: ",null!==(s=h[null!==(e=d.theme)&&void 0!==e?e:""])&&void 0!==s?s:"default"]})),Object.keys(h).map((e=>(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("div",Object.assign({className:"themed",id:`theme-${e}`,theme:e},{children:(0,n.jsx)("button",Object.assign({id:`button-theme-${e}`,theme:e,onClick:f},{children:h[e]}))}))}),`theme-${e}`)))]})),(0,n.jsxs)("div",Object.assign({className:"panel options",id:"options-data"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Game Data"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:(0,n.jsx)(ce,{epoch:d.lastReset/1e3,value:d.lastUpdate/1e3,display:"time",precision:0,prefix:"You started this game "})})),(0,n.jsx)("div",Object.assign({className:"full"},{children:(0,n.jsx)(ce,{epoch:d.lastLoaded/1e3,value:d.lastUpdate/1e3,display:"time",precision:0,prefix:"This session started "})})),(0,n.jsx)("div",Object.assign({className:"full"},{children:(0,n.jsx)(ce,{epoch:d.lastSaved/1e3,value:d.lastUpdate/1e3,display:"time",precision:0,prefix:"Game was last saved "})})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Load",onClick:function(){t.load()&&c({pathname:"/",search:u.search})},id:"button-load"})})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Save",onClick:function(){t.save(g)},id:"button-save"})})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Load from File",onClick:function(){!function(e,s){const t=document.createElement("input");t.type="file",t.addEventListener("change",(function(s){const t=s.target.files;if(!t||0===t.length||!t[0])return;const n=new FileReader;n.onload=function(s){var t;const n=null===(t=s.target)||void 0===t?void 0:t.result;n&&"string"==typeof n&&e&&e(n)},n.readAsText(t[0])}),!1),t.click()}((e=>{t.loadAs(e)&&c({pathname:"/",search:u.search})}))},id:"button-file-load"})})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Save to File",onClick:function(){!function(e,s){s instanceof Blob||(s=new Blob([s],{type:"text/plain"}));const t=URL.createObjectURL(s),n=document.createElement("a");n.href=t,n.download=e,n.click(),URL.revokeObjectURL(t)}(`progressive-mine-sweep-${(new Date).toISOString().replace(/\D/g," ").trim().replace(/\D/g,"-")}`,t.saveAs(g))},id:"button-file-save"})})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Import",onClick:function(){t.loadAs(a)&&c({pathname:"/",search:u.search})},id:"button-import"})})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Export",onClick:function(){r(t.saveAs(g))},id:"button-export"})})),(0,n.jsx)("div",Object.assign({className:"full center",id:"export-text"},{children:(0,n.jsx)("textarea",{value:a,onChange:e=>r(e.target.value)})}))]})),(0,n.jsxs)("div",Object.assign({className:"panel options",id:"options-advanced"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Advanced Settings"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"If you are having performance issues, increase the time between updates. Faster updating frequncies lead to better game experience but might use a lot of CPU."})),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Updating frequency:"})),(0,n.jsxs)("div",Object.assign({className:"half center"},{children:[Math.floor(1e3/d.ticksPerSecond),"ms"]})),(0,n.jsx)("div",{className:"half"}),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"range",min:1,max:1e3,value:d.ticksPerSecond,onInput:e=>m("tick",e.target.value),id:"input-freq-tick"})})),(0,n.jsx)("div",{className:"full"}),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Rendering frequency:"})),(0,n.jsxs)("div",Object.assign({className:"half center"},{children:[Math.floor(1e3/d.framesPerSecond),"ms"]})),(0,n.jsx)("div",{className:"half"}),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"range",min:1,max:60,value:d.framesPerSecond,onInput:e=>m("render",e.target.value),id:"input-freq-render"})})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"Change how often the game is saved in the background. More frequent saving leads to faster backups, but increases CPU and I/O usage"})),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Saving frequency:"})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)(ce,{value:d.saveFrequencySecs,display:"time",precision:0})})),(0,n.jsx)("div",{className:"half"}),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"range",min:1,max:60,value:600/d.saveFrequencySecs,onInput:e=>m("save",e.target.value),id:"input-freq-save"})}))]})),(0,n.jsxs)("div",Object.assign({className:"panel options reset",id:"options-reset"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar warning"},{children:"Game Reset"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"WARNING: this will completely reset your game and delete all saved progress and setting. Only use this if you want to restart the game from beginning, or if something in the settings is so messed up that the game is now unplayable."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"checkbox",checked:o,onChange:()=>l(!o),id:"acknowledge-box"}),"I understand what this means and still want to reset the game"]})})),(0,n.jsx)("div",Object.assign({className:"full right"},{children:(0,n.jsx)("input",{type:"button",value:"Reset everything",disabled:!o,onClick:function(){o&&(confirm("Are you sure you want to reset? This cannot be undone.")?(t.reset(),c({pathname:"/",search:u.search})):l(!1))},id:"button-wipeall"})}))]})),g&&(0,n.jsxs)("div",Object.assign({className:"panel options debug",id:"options-debug"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Debug Context"})),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Settings:"})),(0,n.jsx)("div",Object.assign({className:"full",id:"debug-settings"},{children:JSON.stringify(d,null,2)})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Resources:"})),(0,n.jsx)("div",Object.assign({className:"full",id:"debug-resources"},{children:JSON.stringify(t.resourceManager,((e,s)=>"context"!==e?s:void 0),2)})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Board:"})),(0,n.jsx)("div",Object.assign({className:"full",id:"debug-board"},{children:JSON.stringify(t.board,null,2)}))]}))]}))}function Ae(){const{resource:e}=H();function s(s){const t=e(s);return(0,n.jsx)(ce,{resource:t,length:"percentage"===t.display?"tiny":"compact",precision:"percentage"===t.display?1:void 0,showMaxValue:!0,showRate:!0,showExtras:!0,showZeroRates:!0,showRateColors:!0,placeholder:""})}return(0,n.jsxs)("div",Object.assign({id:"stats"},{children:[(0,n.jsxs)("div",Object.assign({className:"panel stats",id:"stats-time"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Time Info"})),s("totalTime"),s("activeTime"),s("offlineTime")]})),(0,n.jsxs)("div",Object.assign({className:"panel stats",id:"stats-board"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Board Info"})),s("rows"),s("cols"),s("difficulty"),s("resetSpeed"),s("hintQuality")]})),(0,n.jsxs)("div",Object.assign({className:"panel stats",id:"stats-game"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Game Info"})),s("wins"),s("losses"),s("resets"),s("automation")]})),(0,n.jsxs)("div",Object.assign({className:"panel stats",id:"stats-cell"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Cell Info"})),s("cells"),s("flags"),s("hints"),s("explosions"),s("clicks"),s("revealNeighbors")]}))]}))}function Ue(){const{context:e,settings:s}=H(),t=ve(s.tutorialStep,ye,e);if((0,i.useEffect)((()=>{var e;const s=null==t?void 0:t.onMount,n=null==t?void 0:t.onUnmount;let a;try{a=document.querySelectorAll(null!==(e=null==t?void 0:t.highlightSelector)&&void 0!==e?e:"")}catch(e){}return(null==t?void 0:t.enabled)&&(null==a||a.forEach((e=>e.classList.add("highlight"))),s&&s()),()=>{null==a||a.forEach((e=>e.classList.remove("highlight"))),n&&n()}}),[null==t?void 0:t.step,null==t?void 0:t.enabled]),!t||!t.enabled||t.step!==s.tutorialStep||t.step<0)return null;function a(e){return null!=e&&null!=e&&e>=0&&e!==s.tutorialStep&&e!==(null==t?void 0:t.step)}function r(e,t){t.preventDefault(),a(e)&&(s.tutorialStep=e)}function o(e){return`max(5%, 1em, min(90%, calc(100% - 2em), calc(${e})))`}const l={left:o(t.bounds.left),top:o(t.bounds.top),width:o(t.bounds.width),minHeight:o(t.bounds.height)},c=(0,n.jsx)("div",Object.assign({className:"tutorial",style:l,id:`tutorial-step-${t.step}`},{children:(0,n.jsxs)("div",Object.assign({className:"panel shadow",style:{minHeight:t.bounds.height}},{children:[null!=t.title&&""!==t.title&&(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:t.title})),t.body,a(t.prevStep)&&(0,n.jsx)("div",Object.assign({className:"prev"},{children:(0,n.jsx)("a",Object.assign({href:"",onClick:Y(r,t.prevStep)},{children:t.prevStepTitle}))})),a(t.nextStep)&&(0,n.jsx)("div",Object.assign({className:"next"},{children:(0,n.jsx)("a",Object.assign({href:"",onClick:Y(r,t.nextStep)},{children:t.nextStepTitle}))})),a(t.skipToStep)&&(0,n.jsx)("div",Object.assign({className:"skip"},{children:(0,n.jsx)("a",Object.assign({href:"",onClick:Y(r,t.skipToStep)},{children:t.skipToStepTitle}))}))]}))}));return t.greyOut?(0,n.jsx)("div",Object.assign({className:"greyout"},{children:c})):c}function De(){var e;const{context:s,resources:{rows:t,cols:a,difficulty:i,hintQuality:r,hintsCount:o,resetSpeed:l,revealNeighbors:c}}=H();return(0,n.jsxs)("div",Object.assign({id:"upgrades"},{children:[(0,n.jsx)(ge,{}),(0,n.jsx)(de,{showTapMode:!1}),(0,n.jsxs)("div",Object.assign({className:"game-controls panel",id:"game-upgrades"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Game Upgrades"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:"Game Width:"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(ce,{resource:a,showChrome:!0,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:a,prefix:"Expand",overrideMaxCount:50})})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:"Game Height:"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(ce,{resource:t,showChrome:!0,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:t,prefix:"Expand",overrideMaxCount:50})})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:"Game Difficulty:"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(ce,{resource:i,showChrome:!0,showName:!1,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:i,prefix:"Increase"})})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)("span",Object.assign({className:"computed"},{children:"Score Multiplier:"}))})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(ce,{value:100*M(s),display:"percentage",showChrome:!0,className:"computed"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:i,prefix:"Decrease",gainMultiplier:-1,costMultiplier:-s.settings.sellRatio,precision:0})}))]})),(0,n.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Quality Upgrades"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:"Reset Speed:"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(ce,{resource:l,showChrome:!0,showName:!1,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:l,prefix:"Speed up",overrideMaxCount:100})})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:"Hint Quality:"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(ce,{resource:r,showChrome:!0,showName:!1,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:r,prefix:"Improve"})})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:"Number of hints on purchase:"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(ce,{resource:o,showChrome:!0,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:o,prefix:"Improve"})})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"half"},{children:(0,n.jsx)(ce,{resource:c,showChrome:!0,infix:"",placeholder:"Nothing happens",suffix:"on double-tap",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ue,{resource:c,allowUnlocking:!0,prefix:c.unlocked?c.count<(null!==(e=c.maxCount)&&void 0!==e?e:1/0)?"Additional":"Maxed out!":"Unlock"})})),(0,n.jsxs)("div",Object.assign({className:"full computed"},{children:["Reveals random (hidden) neighbors of the square being tapped on.",(0,n.jsx)("br",{}),"CAUTION: it might trigger a mine if they have not been properly flagged!"]}))]}))]}))}function Pe(e){if(null!=e.condition&&!e.condition)return null;const s=(0,Q.TH)();let t=e.to.replace(/\W/g,"");return""===t&&(t="main"),(0,n.jsx)("div",Object.assign({id:`tab-${t}`},{children:(0,n.jsx)(V.OL,Object.assign({className:({isActive:e})=>e?"active":"",to:{pathname:e.to,search:s.search}},{children:e.children}))}))}function qe(){const{context:e,settings:s,resourceManager:t,save:a,resources:{automation:r,resets:o}}=H(),[l,c]=(0,i.useState)(),[u,d]=(0,i.useState)(0);return(0,i.useEffect)((()=>(l&&clearInterval(l),c(setInterval((function(){const n=e.board.state;t.update(void 0,"tick").includes(!0)&&(e.board=g(e.board,e.settings.maxErrors),e.board=Object.assign({},e.board),e.board.state!==n&&R(e,"board",e.board.state,!1)),s.lastUpdate-s.lastSaved>=1e3*s.saveFrequencySecs&&s.lastUpdate-s.lastLoaded>=1e3*s.saveFrequencySecs&&a(),d((e=>s.lastUpdate-e>=1e3/s.framesPerSecond?s.lastUpdate:e))}),1e3/s.ticksPerSecond)),ie(s.theme),()=>{l&&(clearInterval(l),c(void 0))})),[s,s.ticksPerSecond,s.theme]),(0,n.jsxs)(V.UT,{children:[(0,n.jsxs)("nav",Object.assign({className:"navbar"},{children:[(0,n.jsxs)("div",Object.assign({className:"left"},{children:[(0,n.jsx)(Pe,Object.assign({to:"/"},{children:"Minefield"})),(0,n.jsx)(Pe,Object.assign({to:"/upgrades",condition:o.extra.auto+o.extra.manual>1},{children:"Upgrades"})),(0,n.jsx)(Pe,Object.assign({to:"/auto",condition:r.extra.total>=5},{children:"Automation"}))]})),(0,n.jsx)("div",{className:"spacer"}),(0,n.jsxs)("div",Object.assign({className:"right"},{children:[(0,n.jsx)(Pe,Object.assign({to:"/stats"},{children:"Statistics"})),(0,n.jsx)(Pe,Object.assign({to:"/help"},{children:"Help"})),(0,n.jsx)(Pe,Object.assign({to:"/options"},{children:"Settings"}))]}))]})),(0,n.jsx)(Ue,{}),(0,n.jsxs)(Q.Z5,{children:[(0,n.jsx)(Q.AW,{path:"/",element:(0,n.jsx)(Ee,{})}),(0,n.jsx)(Q.AW,{path:"/upgrades",element:(0,n.jsx)(De,{})}),(0,n.jsx)(Q.AW,{path:"/auto",element:(0,n.jsx)(fe,{})}),(0,n.jsx)(Q.AW,{path:"/stats",element:(0,n.jsx)(Ae,{})}),(0,n.jsx)(Q.AW,{path:"/help",element:(0,n.jsx)(ke,{})}),(0,n.jsx)(Q.AW,{path:"/options",element:(0,n.jsx)(Te,{})})]})]})}function Ie({frames:e=12,duration:s=1}){return(0,n.jsx)("svg",Object.assign({className:"spinner",width:"128px",height:"128px",viewBox:"0 0 100 100"},{children:Array.from(Array(e).keys()).map((t=>(0,n.jsx)("g",Object.assign({transform:`rotate(${360*t/e} 50 50)`},{children:(0,n.jsx)("rect",Object.assign({x:"47",y:"24",rx:"9.4",ry:"4.8",width:"6",height:"12",fill:"#32a0da"},{children:(0,n.jsx)("animate",{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:`${s}s`,begin:s/e*(t-e)+"s",repeatCount:"indefinite"})}))}),`g-${t}`)))}))}function Be(){const{load:e}=H(),[s,t]=(0,i.useState)(!1),[a,r]=(0,i.useState)(!1);function o(){try{e(),t(!0)}catch(e){throw r(!0),e}}return(0,i.useEffect)((()=>{s||a||setTimeout(o,1)}),[s,a]),s?(0,n.jsx)(qe,{}):a?(0,n.jsx)(J,{}):(0,n.jsx)(Ie,{})}window.addEventListener("load",(()=>(0,a.s)(ae("app")).render((0,n.jsx)(G,{children:(0,n.jsx)(Be,{})}))),!1)},635:(e,s,t)=>{t.d(s,{Cb:()=>l,JE:()=>r,O3:()=>c,in:()=>o,zs:()=>i});var n=t(86),a=t(962);function i(e){const s={name:e,count:0,extra:{},value:e=>{var t;return e?null!==(t=s.extra[e])&&void 0!==t?t:0:s.count},cost:()=>[],execution:{},rate:{count:0,ticks:0,pastCounts:[],pastTicks:[]}};return(0,a.xR)(s,["name","unlocked","disabled","count","maxCount","extra"]),s}function r(e,...s){return[e,...s].flat().reduce(((e,s)=>{const t=e.find((e=>{var t,n;return(e.resource===s.resource||("string"==typeof e.resource?e.resource:e.resource.name)===("string"==typeof s.resource?s.resource:s.resource.name))&&(null!==(t=e.kind)&&void 0!==t?t:"")===(null!==(n=s.kind)&&void 0!==n?n:"")}));return t?(t.count+=s.count,e):[...e,Object.assign({},s)]}),[]).filter((({count:e})=>0!==e))}function o(e,s){return e.map((({resource:e,count:t,kind:n})=>({resource:e,count:s*t,kind:n})))}function l(e,s,t=!1){var n;return(null===(n=e.unlocked)||void 0===n||n)&&r(s).every((({resource:s,count:n,kind:a})=>{var i;return e.name!==("string"==typeof s?s:s.name)||e.value(a)-n>=(t&&!a&&"string"!=typeof s&&null!==(i=s.minCount)&&void 0!==i?i:0)}))}function c(e,s){return r(s.filter((({resource:s})=>{var t;return(null===(t=e.unlocked)||void 0===t||t)&&e.name===("string"==typeof s?s:s.name)})).map((({count:s,kind:t})=>{var a,i,r;const o=t?null!==(a=e.extra[t])&&void 0!==a?a:0:e.count,l=(0,n.Z)(o+s,t?0:null!==(i=e.minCount)&&void 0!==i?i:0,t?1/0:null!==(r=e.maxCount)&&void 0!==r?r:1/0);return t?e.extra[t]=l:e.count=l,[{resource:e,count:l-o,kind:t}]})).flat())}},458:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{FO:()=>compileResourceCost,QE:()=>genResourceManager,xV:()=>mergeResourceManagers});var _utils_assign__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(88),_utils_clamp__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(86),_utils_dedupe__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(477),_utils_store__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(962),_Resource__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(635);function genResourceManager(e,s){const t={context:e,settings:s,resources:{},upsert:e=>upsert(t,e),get:e=>resolve(t,e),purchase:(e,s="partial",n=1,a=1)=>purchase(t,e,s,n,a),canAfford:e=>canAfford(t,e),update:(e,s)=>update(t,null!=e?e:Date.now(),null!=s?s:"unknown")};return(0,_utils_store__WEBPACK_IMPORTED_MODULE_0__.xR)(t,["resources"]),t}function mergeResourceManagers(e,s){var t;return Object.values(null!==(t=s.resources)&&void 0!==t?t:{}).forEach((s=>e.upsert(s))),e}function resolve(e,s){return e.resources["string"==typeof s?s:s.name]}function upsert(e,s){var t,n;const a="string"==typeof s?s:null!==(t=s.name)&&void 0!==t?t:"",i=null!==(n=e.resources[a])&&void 0!==n?n:_Resource__WEBPACK_IMPORTED_MODULE_1__.zs(a);if("string"!=typeof s){let e;for(e in s)(0,_utils_assign__WEBPACK_IMPORTED_MODULE_2__.Z)(i,e,s[e])}return i.buy=(s=1,t="partial",n="",a=1,r=1)=>purchase(e,[{resource:i,count:s,kind:n}],t,a,r),i.add=(e,s,t)=>i.buy(e,"free",s,t),i.canBuy=(e,s,t)=>i.buy(e,"dry-partial",s,void 0,t),i.name&&(e.resources[i.name]=i),i}function compileResourceCost(rm,cost){return eval("(n) => ["+cost.replace(/\s/gim,"").split(/[;,]/gim).map((e=>{const s=e.split(/:/gim,2).map((e=>e.replace(/\b\w+\b/gim,(e=>rm.resources[e]?`rm.resources.${e}`:e)))),t=[`resource: ${s[0]}`,`count: ${s[s.length-1]}`];return s.length>2&&t.push(`kind: ${s[1]}`),`{${t.join(", ")}}`})).join(", ")+"];")}function update(e,s,t){var n;const{rateUpdateSecs:a=1,rateHistoryWindow:i=10,minResourceUpdateSecs:r=.001,maxResourceUpdateSecs:o=86400,maxResourceTickSecs:l=1,timeDilation:c=1}=e.settings;let u=(0,_utils_clamp__WEBPACK_IMPORTED_MODULE_3__.Z)((s-(null!==(n=e.settings.lastUpdate)&&void 0!==n?n:s))/1e3,0,o);if(u<r&&null!=e.settings.lastUpdate)return[];e.settings.lastUpdate=s;const d=s-1e3*u,h=Object.values(e.resources).filter((e=>{var s;return null===(s=e.unlocked)||void 0===s||s})),g=h.filter((e=>e.tick&&!e.disabled));h.forEach((e=>{var t,n,a,i,r;null!==(t=(i=e.rate).lastCountUpdate)&&void 0!==t||(i.lastCountUpdate=d),null!==(n=(r=e.rate).lastCount)&&void 0!==n||(r.lastCount=e.count),e.execution.lastTick=(0,_utils_clamp__WEBPACK_IMPORTED_MODULE_3__.Z)(null!==(a=e.execution.lastTick)&&void 0!==a?a:d,s-1e3*o,s),e.execution.lastAttempt=s}));let m={};const f=.001/c;for(;u>0;){u-=(0,_utils_clamp__WEBPACK_IMPORTED_MODULE_3__.Z)(u,r,l);const e=s-1e3*u;g.forEach((s=>{var n,a,i,r;const o=(e-s.execution.lastTick)*f;o>0&&(!s.shouldTick||s.shouldTick(o,t))&&(s.execution.lastResult=null!==(n=s.tick(o,t))&&void 0!==n?n:void 0,s.execution.lastTick=e,s.rate.deltaTicks=(null!==(a=s.rate.deltaTicks)&&void 0!==a?a:0)+1,null!==(i=(r=s.rate).lastTickUpdate)&&void 0!==i||(r.lastTickUpdate=e),s.execution.lastResult&&(m[s.name]=s.execution.lastResult))}))}return h.forEach((e=>{var t,n,r,o;const l=(s-(null!==(t=e.rate.lastCountUpdate)&&void 0!==t?t:0))/1e3;(null==e.rate.lastCountUpdate||null==e.rate.lastCount||l>=a)&&(e.rate.count=(e.count-(null!==(n=e.rate.lastCount)&&void 0!==n?n:0))/l,e.rate.lastCount=e.count,e.rate.lastCountUpdate=s,e.rate.pastCounts.unshift(e.rate.count),e.rate.pastCounts.splice(i));const c=(s-(null!==(r=e.rate.lastTickUpdate)&&void 0!==r?r:0))/1e3;(null==e.rate.lastTickUpdate||null==e.rate.deltaTicks||c>=a)&&(e.rate.ticks=(null!==(o=e.rate.deltaTicks)&&void 0!==o?o:0)/c,e.rate.deltaTicks=0,e.rate.lastTickUpdate=s,e.rate.pastTicks.unshift(e.rate.ticks),e.rate.pastTicks.splice(i))})),(0,_utils_dedupe__WEBPACK_IMPORTED_MODULE_4__.Z)(Object.values(m))}function purchase(e,s,t,n,a){const i=resolveAll(e,s).map((s=>{const i=getPurchaseCost(e,s.resource,s.count,s.kind,t,n,a);if("dry-partial"===t||"dry-full"===t)return i;{const t=_Resource__WEBPACK_IMPORTED_MODULE_1__.O3(s.resource,i.gain),n=getCountOf(t,s.resource.name,s.kind),a=i.cost.map((({resource:s,count:t,kind:n})=>_Resource__WEBPACK_IMPORTED_MODULE_1__.O3(resolve(e,s),[{resource:s,count:-t,kind:n}]))).flat();return{count:n,gain:t,cost:a}}}));return{count:i.reduce(((e,s)=>e+s.count),0),gain:_Resource__WEBPACK_IMPORTED_MODULE_1__.JE(i.map((e=>e.gain)).flat()),cost:_Resource__WEBPACK_IMPORTED_MODULE_1__.JE(i.map((e=>e.cost)).flat())}}function resolveAll(e,s){return s.map((({resource:s,count:t,kind:n})=>({resource:resolve(e,s),count:t,kind:null!=n?n:""}))).filter((({resource:e,count:s})=>e&&s))}function getCountOf(e,s,t){var n;return null!==(n=e.filter((({resource:e,kind:n})=>(null!=t?t:"")===(null!=n?n:"")&&s===("string"==typeof e?e:e.name))).map((({count:e})=>e)).pop())&&void 0!==n?n:0}function canAfford(e,s){return resolveAll(e,_Resource__WEBPACK_IMPORTED_MODULE_1__.JE(s)).every((e=>_Resource__WEBPACK_IMPORTED_MODULE_1__.Cb(e.resource,[e],!0)))}function getPurchaseCost(e,s,t,n,a,i,r){var o,l,c,u;if(!s||0===t||null!==(o=s.unlocked)&&void 0!==o&&!o&&!a.includes("dry"))return{count:0,gain:[],cost:[]};let d=n?null!==(l=s.extra[n])&&void 0!==l?l:0:s.count,h=(0,_utils_clamp__WEBPACK_IMPORTED_MODULE_3__.Z)(d+t,n?0:null!==(c=s.minCount)&&void 0!==c?c:0,n?1/0:null!==(u=s.maxCount)&&void 0!==u?u:1/0);if("free"===a){const e=i*(h-d);return{count:e,gain:[{resource:s,count:e,kind:n}],cost:[]}}d>h&&([d,h]=[h,d],[i,r]=[-i,-r]);let g=[],m=g,f=0;for(let t=d;t<h;t++){const i=_Resource__WEBPACK_IMPORTED_MODULE_1__.in(resolveAll(e,s.cost(t+1,n)),r);if(a.includes("partial")&&(m=_Resource__WEBPACK_IMPORTED_MODULE_1__.JE(m,i),!canAfford(e,m)))break;f++,g=_Resource__WEBPACK_IMPORTED_MODULE_1__.JE(g,i)}if("dry-full"!==a&&!canAfford(e,g)||"full"===a&&d+f!==h)return{count:0,gain:[],cost:[]};const v=i*f;return{count:v,gain:[{resource:s,count:v,kind:n}],cost:g}}},88:(e,s,t)=>{function n(e,s,t){e[s]&&t&&"object"==typeof t?e[s]=Object.assign(Object.assign({},e[s]),t):null!=t&&null!=t&&(e[s]=t)}t.d(s,{Z:()=>n})},86:(e,s,t)=>{function n(e=0,s=0,t=1){return isNaN(e)||e<s?s:e>t?t:e}t.d(s,{Z:()=>n})},477:(e,s,t)=>{function n(e){return e.filter(((e,s,t)=>t.indexOf(e)===s))}t.d(s,{Z:()=>n})},962:(e,s,t)=>{t.d(s,{_B:()=>l,po:()=>o,xR:()=>c});var n=t(477);function a(e){const s=e.startsWith(".."),t=(s?e:Math.random().toString(36)).substring(2,10);return(s?"":".."+t)+(s?e.slice(10):e).split("").map((e=>e.charCodeAt(0))).map(((e,s)=>String.fromCharCode(e^t.charCodeAt(s%8)))).join("")}function i(e){const s=[],t=e._save_properties;return null!=t&&"object"==typeof t&&Array.isArray(t)&&s.push(...t),s}function r(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map((e=>r(e)));if(0===Object.keys(e).length)return null;const s={},t=i(e);let n;for(n in e)if(!n.startsWith("_")&&null!=e[n]&&(0===t.length||t.includes(n))){const t=e[n];if("object"==typeof t){const e=r(t);null!=e&&(s[n.toString()]=e)}else"function"!=typeof t&&(s[n.toString()]=t)}return s}function o(e,s=!1){return s?JSON.stringify(r(e),null,2):window.btoa(a(JSON.stringify(r(e))))}function l(e,s){let t=null;if(!t)try{t=JSON.parse(a(window.atob(s)))}catch(e){t=null}if(!t)try{t=JSON.parse(window.atob(s))}catch(e){t=null}if(!t)try{t=JSON.parse(s)}catch(e){t=null}return!!t&&function(e,s){if(!s||"object"!=typeof s||"object"!=typeof e)return!1;let t;for(t in e)typeof s[t]==typeof e[t]&&(e[t]=s[t]);return!0}(e,t)}function c(e,s){const t=i(e);return t.push(...s),Object.assign(e,{_save_properties:(0,n.Z)(t)}),e}}},e=>{e.O(0,[216,840],(()=>(823,e(e.s=823)))),e.O()}]);