"use strict";(self.webpackChunkprogressive_mine_sweep=self.webpackChunkprogressive_mine_sweep||[]).push([[873],{116:(e,s,t)=>{t.r(s);var n={};t.r(n),t.d(n,{achievementAutomationDiscount:()=>ge,achievementAwarded:()=>he,achievementScoreMultiplier:()=>me});var a={};t.r(a),t.d(a,{boardProgressFormula:()=>be,boardReset:()=>Me,costMultiplier:()=>xe,countActions:()=>Ce,difficultyScoreMultiplier:()=>we,gainMultiplier:()=>ve,getBuyAmount:()=>ke,hintFormula:()=>je,numMinesFormula:()=>pe,remainingHintsFormula:()=>Ne,resetTimeFormula:()=>Oe,revealNeighbors:()=>ye,stateChanged:()=>Se});var i={};t.r(i),t.d(i,{expandBoardDims:()=>Ie,flagMinesTask:()=>Be,getTickProgress:()=>Re,purchaseHintsTask:()=>_e,resetGameTask:()=>qe,revealHintsTask:()=>Ge,revealNeighborsTask:()=>$e,shouldAutoTick:()=>Ue});var o=t(893),r=t(745),l=t(294);const c=JSON.parse('[{"name":"achieveAutomation","description":"Speed up all automation by 20% per milestone!","singularName":"Automated Gameplay","pluralName":"Automated Gameplay","icon":"robot","display":"none","autoAward":true,"count":0,"maxCount":4,"cost":"cells:auto: 5**(n+1); wins: auto:(n+1)**2","onPurchase":"achievementAwarded"},{"name":"achieveExtraMistake","description":"Allow making 1 mistake on a game and still winning it!","singularName":"Maximum Overdrive","pluralName":"Maximum Overdrive","icon":"robot","display":"none","autoAward":true,"count":0,"maxCount":1,"cost":"hintQuality: 100; resetSpeed: 100; revealNeighbors: 8","onPurchase":"achievementAwarded"}]'),u=JSON.parse('[{"name":"achieveResets","singularName":"Game Started","pluralName":"Games Started","icon":"refresh","autoAward":true,"count":0,"maxCount":5,"value":"10**(this.count-1)","cost":"resets:total: 10**(n-1)","onPurchase":"achievementAwarded"},{"name":"achieveClicks","singularName":"Click on Board","pluralName":"Clicks on Board","icon":"hand-click","autoAward":true,"count":0,"maxCount":5,"value":"10**(this.count-1)","cost":"clicks: 10**(n-1)","onPurchase":"achievementAwarded"},{"name":"achieveWins","singularName":"Game Won","pluralName":"Games Won","icon":"square-check","autoAward":true,"count":0,"maxCount":5,"value":"5**(this.count-1)","cost":"wins:total: 5**(n-1)","onPurchase":"achievementAwarded"},{"name":"achieveLosses","singularName":"Game Lost","pluralName":"Games Lost","icon":"square-x","autoAward":true,"count":0,"maxCount":5,"value":"5**(this.count-1)","cost":"losses:total: 5**(n-1)","onPurchase":"achievementAwarded"},{"name":"achievePlayTime","singularName":"Minute Playing","pluralName":"Minutes Playing","icon":"clock","autoAward":true,"count":0,"maxCount":5,"value":"100/60 * 6**this.count","cost":"activeTime:100 * 6**n","onPurchase":"achievementAwarded"},{"name":"achieveBoardSize","singularName":"Board Size","pluralName":"Board Size","icon":"arrows-cross","autoAward":true,"count":0,"maxCount":5,"value":"[3,5,8,10,20,32][this.count] ** 2","cost":"rows: [3,5,8,10,20,32][n]; cols: [3,5,8,10,20,32][n]","onPurchase":"achievementAwarded"}]'),d=JSON.parse('[{"name":"achieveWinStreak","singularName":"Game Win Streak","pluralName":"Game Win Streak","icon":"box-multiple","autoAward":true,"unlocked":false,"count":0,"maxCount":5,"value":"[0,3,5,10,25,100][this.count]","cost":"wins:longestStreak: [0,3,5,10,25,100][n]","onPurchase":"achievementAwarded"},{"name":"achieveLoseStreak","singularName":"Game Lose Streak","pluralName":"Game Lose Streak","icon":"box-multiple","autoAward":true,"unlocked":false,"count":0,"maxCount":5,"value":"[0,3,5,10,25,100][this.count]","cost":"losses:longestStreak: [0,3,5,10,25,100][n]","onPurchase":"achievementAwarded"},{"name":"achieveWastedClicks","singularName":"Pointless Click","pluralName":"Pointless Clicks","icon":"trash","autoAward":true,"unlocked":false,"count":0,"maxCount":1,"value":"50*this.count","cost":"clicks:useless: 50*n","onPurchase":"achievementAwarded"},{"name":"achieveDifficulty","singularName":"Impossible Difficulty","pluralName":"Impossible Difficulty","icon":"adjustments-horizontal","display":"none","autoAward":true,"unlocked":false,"count":0,"maxCount":1,"cost":"difficulty: 40*n","onPurchase":"achievementAwarded"},{"name":"achieveOnlineTime","singularName":"Hour Online","pluralName":"Hours Online","icon":"alarm","autoAward":true,"unlocked":false,"count":0,"maxCount":2,"value":"this.count ** 2","cost":"activeTime:max: 60*60 * n**2","onPurchase":"achievementAwarded"},{"name":"achieveOfflineTime","singularName":"Hour Offline","pluralName":"Hours Offline","icon":"user-off","autoAward":true,"unlocked":false,"count":0,"maxCount":1,"value":"12 * this.count","cost":"offlineTime:max: 12*60*60*n","onPurchase":"achievementAwarded"}]'),h=JSON.parse('[{"name":"autoRevealNeighbors","unlocked":false,"count":0,"cost":"automation: Math.floor((n+1)**1.5)","shouldTick":"shouldAutoTick","tick":"revealNeighborsTask(context, dt, source)"},{"name":"autoFlagMines","unlocked":false,"count":0,"cost":"automation: Math.floor((n+1)**1.5)","shouldTick":"shouldAutoTick","tick":"flagMinesTask(context, dt, source)"},{"name":"autoRevealHints","unlocked":false,"count":0,"cost":"automation: Math.floor((n+1)**1.5)","shouldTick":"shouldAutoTick","tick":"revealHintsTask(context, dt, source)"},{"name":"autoPurchaseHints","unlocked":false,"count":0,"cost":"automation: (n+1)**2","shouldTick":"shouldAutoTick","tick":"purchaseHintsTask(context, dt, source)"},{"name":"autoResetGame","unlocked":false,"count":0,"cost":"automation: Math.floor((n+1)**1.5)","shouldTick":"shouldAutoTick","tick":"resetGameTask(context, dt, source)"},{"name":"autoClickBoard","unlocked":false,"count":0,"cost":"automation: Math.floor((n+1)**2)"},{"name":"autoBoardUpgrade","singularName":"Auto Expand Board","pluralName":"Auto Expand Board","unlocked":false,"count":0,"cost":"automation: (n+1)**2","shouldTick":"shouldAutoTick","tick":"expandBoardDims(context, dt, source)"}]'),m=JSON.parse('[{"name":"rows","singularName":"row","icon":"arrows-vertical","count":3,"minCount":3,"cost":"cells: n**2","value":"Math.floor(this.count)"},{"name":"cols","singularName":"col","icon":"arrows-horizontal","count":3,"minCount":3,"cost":"cells: n**2","value":"Math.floor(this.count)"},{"name":"difficulty","icon":"adjustments-horizontal","display":"percentage","count":15,"minCount":1,"maxCount":100,"cost":"flags: Math.floor(n/2)"},{"name":"hintQuality","icon":"icon-hinted bulb","display":"percentage","count":0,"maxCount":100,"cost":"wins: Math.floor(n/10); cells: n*2"},{"name":"hintsCount","singularName":"hint","pluralName":"hints","count":1,"cost":"wins: (n+1)**2; cells: 2**(n+1)","value":"Math.floor(this.count)"},{"name":"resetSpeed","icon":"refresh-alert","display":"percentage","count":0,"maxCount":100,"extra":{"remainingTime":0},"cost":"resets: 1; cells: n","tick":"timer({ kind: \'remainingTime\', direction: -1 })"},{"name":"revealNeighbors","icon":"icon-revealed arrows-maximize","unlocked":false,"count":0,"maxCount":8,"extra":{"reveals":0,"explosions":0,"auto":0,"manual":0,"useless":0},"cost":"cells: 2**(n+1)","value":"Math.floor(value(kind))"}]'),g=JSON.parse('[{"name":"clicks","singularName":"click","icon":"hand-click","count":0,"extra":{"left":0,"right":0,"double":0,"useless":0}},{"name":"cells","singularName":"cell","icon":"icon-revealed square","count":0,"extra":{"auto":0,"manual":0,"total":0,"hidden":0}},{"name":"hints","singularName":"hint","icon":"icon-hinted eye","count":0,"extra":{"auto":0,"manual":0,"total":0},"cost":"wins: 1","gainMultiplier":"m * hintsCount.count"},{"name":"flags","singularName":"flag","icon":"icon-flagged flag-2","count":0,"extra":{"auto":0,"manual":0,"total":0,"unflags":0}},{"name":"explosions","singularName":"explosion","icon":"icon-blown alert-triangle","count":0,"extra":{"auto":0,"manual":0,"total":0}}]'),f=JSON.parse('[{"name":"wins","singularName":"win","icon":"icon-won square-check","count":0,"extra":{"auto":0,"manual":0,"total":0,"streak":0,"longestStreak":0}},{"name":"losses","singularName":"lose","icon":"icon-lost square-x","count":0,"extra":{"auto":0,"manual":0,"total":0,"streak":0,"longestStreak":0}},{"name":"resets","singularName":"reset","icon":"refresh","count":0,"extra":{"auto":0,"manual":0,"total":0}},{"name":"automation","icon":"robot","count":0,"extra":{"total":0}}]'),v=JSON.parse('[{"name":"totalTime","icon":"clock","display":"time","tick":"timer()"},{"name":"activeTime","icon":"alarm","display":"time","extra":{"current":0,"max":0},"tick":"timer({ tickSource: \'tick\' })"},{"name":"offlineTime","icon":"user-off","display":"time","extra":{"current":0,"max":0},"tick":"timer({ tickSource: \'load\' })"}]');function x(e,s,t){e[s]&&t&&"object"==typeof t?e[s]=Object.assign(Object.assign({},e[s]),t):null!=t&&null!=t&&(e[s]=t)}function b(){const e=window.localStorage,s="__storage_test__";if(!e)return!1;try{return e.setItem(s,s),e.removeItem(s),!0}catch(s){return s instanceof DOMException&&0!==e.length&&(22===s.code||1014===s.code||"QuotaExceededError"===s.name||"NS_ERROR_DOM_QUOTA_REACHED"===s.name)}}function p(e){return e.filter(((e,s,t)=>t.indexOf(e)===s))}function j(e){const s=e.startsWith(".."),t=(s?e:Math.random().toString(36)).substring(2,10);return(s?"":".."+t)+(s?e.slice(10):e).split("").map((e=>e.charCodeAt(0))).map(((e,s)=>String.fromCharCode(e^t.charCodeAt(s%8)))).join("")}function N(e){const s=[],t=e._save_properties;return null!=t&&"object"==typeof t&&Array.isArray(t)&&s.push(...t),s}function O(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map((e=>O(e)));if(0===Object.keys(e).length)return null;const s={},t=N(e);let n;for(n in e)if(!n.startsWith("_")&&null!=e[n]&&(0===t.length||t.includes(n))){const t=e[n];if("object"==typeof t){const e=O(t);null!=e&&(s[n.toString()]=e)}else"function"!=typeof t&&(s[n.toString()]=t)}return s}function k(e,s){const t=N(e);return t.push(...s),Object.assign(e,{_save_properties:p(t)}),e}function w(e=0,s=0,t=1){return isNaN(e)||e<s?s:e>t?t:e}const y={row:0,col:0,contents:"clear",state:"hidden",neighborContents:{clear:0,mine:0},neighborStates:{hidden:0,hinted:0,flagged:0,revealed:0,blown:0}};function C(e,s){switch(s){case"flag":"hidden"===e.state||"hinted"===e.state?e.state="flagged":"flagged"===e.state&&(e.state="hidden");break;case"reveal":"hidden"!==e.state&&"hinted"!==e.state||("clear"===e.contents?e.state="revealed":"mine"===e.contents&&(e.state="blown"));break;case"hint":"hidden"===e.state&&(e.state="hinted");break;case"hide":"flagged"!==e.state&&"revealed"!==e.state||(e.state="hidden")}return e}const S={rows:0,cols:0,cells:[],numMines:0,state:"inactive",cellCounts:{hidden:0,hinted:0,flagged:0,revealed:0,blown:0},hadUserAction:!1};function M(e,s=1){var t;e.cellCounts=Object.assign({},S.cellCounts),e.numMines=0,e.cells.forEach((e=>e.forEach((e=>{e.neighborContents=Object.assign({},y.neighborContents),e.neighborStates=Object.assign({},y.neighborStates)}))));for(let s=0;s<e.rows;s++)for(let n=0;n<e.cols;n++){const a=e.cells[s][n];e.numMines+="mine"===a.contents?1:0,e.cellCounts[a.state]++,a.row=s,a.col=n,a.locked=!!a.locked||void 0,k(a,["contents","state","locked"]);for(let i=s-1;i<=s+1;i++)for(let o=n-1;o<=n+1;o++){const r=(null!==(t=e.cells[i])&&void 0!==t?t:[])[o];!r||i===s&&o===n||(a.neighborContents[r.contents]++,a.neighborStates[r.state]++)}}return"lost"===e.state||e.cellCounts.blown>=s?(e.state="lost",e.cells.forEach((s=>s.forEach((s=>{e.cellCounts[s.state]--,C(s,"reveal"),e.cellCounts[s.state]++}))))):e.cols*e.rows==0?e.state="inactive":e.cellCounts.blown+e.cellCounts.flagged>=e.numMines&&0===e.cellCounts.hidden&&e.cellCounts.revealed>=e.cols*e.rows-e.numMines?e.state="won":e.state="active",k(e,["rows","cols","cells","hadUserAction"])}function T(e,s,t,n){let a=function(e,s){const t=[];for(let n=0;n<e;n++){t[n]=[];for(let e=0;e<s;e++)t[n][e]=Object.assign(Object.assign({},y),{row:n,col:e})}return{rows:e,cols:s,cells:t,numMines:0,state:"active",cellCounts:Object.assign(Object.assign({},S.cellCounts),{hidden:e*s}),hadUserAction:!1}}(e,s);return a=function(e,s,t){var n,a;s=null!==(n=null!=s?s:t)&&void 0!==n?n:0,t=null!==(a=null!=t?t:s)&&void 0!==a?a:0;let i=w(Math.floor(s+Math.random()*(1+t-s)),0,e.rows*e.cols-e.numMines-1);for(;i>0;){const s=Math.floor(Math.random()*e.rows),t=Math.floor(Math.random()*e.cols);"clear"===e.cells[s][t].contents&&(e.cells[s][t].contents="mine",e.numMines++,i--)}return e}(a,t,n),a=M(a),a}function A(e,s,t=0,n=8,a=0){if(s=Math.floor(w(s,0,100)),t=Math.floor(w(t,0,8)),n=Math.floor(w(n,0,8)),a=w(a,0,1),0===s)return 0;const i=e.cells.flat().filter((e=>"hidden"===e.state&&"clear"===e.contents&&e.neighborContents.mine>=t&&e.neighborContents.mine<=n)).sort(((e,s)=>e.neighborContents.mine-s.neighborContents.mine));if(i.length<=s)return i.forEach((s=>{C(s,"hint"),e.cellCounts.hinted++,e.cellCounts.hidden--})),i.length;for(let t=0;t<s;t++){let s=0;const t=a,n=Math.random();s=.5===t?n:(Math.sqrt(t*t+n-2*t*n)-t)/(1-2*t),s=Math.floor(s*i.length),i.splice(s,1).map((s=>{C(s,"hint"),e.cellCounts.hinted++,e.cellCounts.hidden--}))}return s}function R(e,...s){return(...t)=>e(...s,...t)}var U=t(730);function E(e,{kind:s="",tickSource:t="",minValue:n=0,maxValue:a=1/0,direction:i=1,streakKind:o="current",maxStreakKind:r="max",minStreakKind:l="min",resetStreakSource:c=""}={}){return(u,d)=>{var h;if(t&&d!==t)c&&d!==c||o&&e.extra&&(e.extra[o]=i>0?n:i<0?a:0);else{let t=null!==(h=s&&e.extra?e.extra[s]:e.count)&&void 0!==h?h:0;(t>n||i>0)&&(t<a||i<0)&&(t=w(t+i*u,n,a),s&&e.extra?e.extra[s]=t:e.count=t,o&&e.extra&&null!=e.extra[o]&&(e.extra[o]=w(e.extra[o]+i*u,n,a),r&&null!=e.extra[r]&&e.extra[r]<e.extra[o]&&(e.extra[r]=e.extra[o]),l&&null!=e.extra[l]&&e.extra[l]>e.extra[o]&&(e.extra[l]=e.extra[o])))}return null}}function $(e,s){var t;return null!==(t=e.resources["string"==typeof s?s:s.name])&&void 0!==t?t:q(e,s)}function q(e,s){var t,n;const a="string"==typeof s?s:null!==(t=s.name)&&void 0!==t?t:"",i=null!==(n=e.resources[a])&&void 0!==n?n:function(e,s){const t={manager:e,name:s,count:0,extra:{},value:e=>F(t,e),cost:()=>[],buy:(s=1,n="partial",a="",i=1,o=1)=>P(e,[{resource:t,count:s,kind:a}],n,i,o),sell:(e,s,n)=>t.buy(-(null!=e?e:1),void 0,s,void 0,n),add:(e,s,n)=>t.buy(e,"free",s,n),canBuy:(e,s,n)=>t.buy(e,"dry-partial",s,void 0,n),execution:{},rate:{count:0,ticks:0,pastCounts:[],pastTicks:[]}};return k(t,["name","unlocked","disabled","count","extra"])}(e,a);if("string"!=typeof s){let e;for(e in s)x(i,e,s[e])}return i.name&&(e.resources[i.name]=i),i}function P(e,s,t,n,a){const i=e.gainMultiplier?e.gainMultiplier(n):n,o=e.costMultiplier?e.costMultiplier(a):a,r=B(e,s).map((s=>{const n=s.resource,a=n.gainMultiplier?n.gainMultiplier(i):i,r=n.costMultiplier?n.costMultiplier(o):o,l=function(e,s,t,n,a,i,o){var r,l,c,u,d;if(!s||0===t||null!==(r=s.unlocked)&&void 0!==r&&!r&&!a.includes("dry"))return{count:0,gain:[],cost:[]};let h=n?null!==(l=s.extra[n])&&void 0!==l?l:0:s.count,m=w(h+t,n?0:null!==(c=s.minCount)&&void 0!==c?c:0,n?1/0:null!==(u=s.maxCount)&&void 0!==u?u:1/0);if("free"===a)return{count:m-h,gain:[{resource:s,count:i*(m-h),kind:n}],cost:[]};h>m&&([h,m]=[m,h],[i,o]=[-i,-o*(null!==(d=e.settings.sellRatio)&&void 0!==d?d:1)]);let g=[],f=g,v=0;for(let t=h;t<m;t++){const i=_(B(e,s.cost(t+1,n)),o);if(a.includes("partial")&&(f=G(f,i),!D(e,f)))break;v++,g=G(g,i)}return"dry-full"!==a&&!D(e,g)||"full"===a&&h+v!==m?{count:0,gain:[],cost:[]}:{count:v*Math.sign(i),gain:[{resource:s,count:i*v,kind:n}],cost:g}}(e,n,s.count,s.kind,t,a,r);if("dry-partial"===t||"dry-full"===t)return l;{const s=I(n,l.gain),t=l.cost.map((({resource:s,count:t,kind:n})=>I($(e,s),[{resource:s,count:-t,kind:n}]))).flat(),a={count:l.count,gain:s,cost:t};return n.onPurchase&&n.onPurchase(a),a}}));return{count:r.reduce(((e,s)=>e+s.count),0),gain:G(r.map((e=>e.gain)).flat()),cost:G(r.map((e=>e.cost)).flat())}}function B(e,s){return s.map((({resource:s,count:t,kind:n})=>({resource:$(e,s),count:t,kind:null!=n?n:""}))).filter((({resource:e,count:s})=>e&&s))}function D(e,s,t=!0){return B(e,G(s)).every((e=>function(e,s,t=!1){var n;return(null===(n=e.unlocked)||void 0===n||n)&&G(s).every((({resource:s,count:n,kind:a})=>{var i;return e.name!==("string"==typeof s?s:s.name)||e.value(a)-n>=(t&&!a&&"string"!=typeof s&&null!==(i=s.minCount)&&void 0!==i?i:0)}))}(e.resource,[e],t)))}function G(e,...s){return[e,...s].flat().reduce(((e,s)=>{const t=e.find((e=>{var t,n;return(e.resource===s.resource||("string"==typeof e.resource?e.resource:e.resource.name)===("string"==typeof s.resource?s.resource:s.resource.name))&&(null!==(t=e.kind)&&void 0!==t?t:"")===(null!==(n=s.kind)&&void 0!==n?n:"")}));return t?(t.count+=s.count,e):[...e,Object.assign({},s)]}),[]).filter((({count:e})=>0!==e))}function _(e,s){return e.map((({resource:e,count:t,kind:n})=>({resource:e,count:s*t,kind:n})))}function I(e,s){return G(s.filter((({resource:s})=>{var t;return(null===(t=e.unlocked)||void 0===t||t)&&e.name===("string"==typeof s?s:s.name)})).map((({count:s,kind:t})=>{var n,a,i;const o=t?null!==(n=e.extra[t])&&void 0!==n?n:0:e.count,r=w(o+s,t?0:null!==(a=e.minCount)&&void 0!==a?a:0,t?1/0:null!==(i=e.maxCount)&&void 0!==i?i:1/0);return t?e.extra[t]=r:e.count=r,[{resource:e,count:r-o,kind:t}]})).flat())}function F(e,s){var t,n,a;return s?null!==(a=e.extra[s])&&void 0!==a?a:0:w(e.count,null!==(t=e.minCount)&&void 0!==t?t:0,null!==(n=e.maxCount)&&void 0!==n?n:1/0)}const H={ticksPerSecond:60,framesPerSecond:10,saveFrequencySecs:60,rateUpdateSecs:1,rateHistoryWindow:10,minResourceUpdateSecs:.001,maxResourceUpdateSecs:86400,maxResourceTickSecs:1,lastReset:Date.now(),lastUpdate:Date.now(),lastSaved:0,lastLoaded:Date.now(),maxErrors:1,sellRatio:.8,automationBaseSecs:60,timeDilation:1,tutorialStep:0,tapMode:"reveal",buyAmount:"x1",theme:""};function L(e){var s;const t=e||{};return null!==(s=t.init)&&void 0!==s||(t.init=()=>{}),t.settings=Object.assign(Object.assign({},H),{lastReset:Date.now(),lastUpdate:Date.now(),lastLoaded:Date.now()}),t.board=Object.assign({},S),t.resourceManager=function(e,s){const t={context:e,settings:s,resources:{},upsert:e=>q(t,e),get:e=>$(t,e),purchase:(e,s="partial",n=1,a=1)=>P(t,e,s,n,a),canAfford:e=>D(t,e),update:(e,s)=>function(e,s,t){var n;const{rateUpdateSecs:a=1,rateHistoryWindow:i=10,minResourceUpdateSecs:o=.001,maxResourceUpdateSecs:r=86400,maxResourceTickSecs:l=1,timeDilation:c=1}=e.settings;let u=w((s-(null!==(n=e.settings.lastUpdate)&&void 0!==n?n:s))/1e3,0,r);if(u<o&&null!=e.settings.lastUpdate)return[];e.settings.lastUpdate=s;const d=s-1e3*u,h={},m=Object.values(e.resources).filter((e=>{var s;return null===(s=e.unlocked)||void 0===s||s}));m.forEach((e=>{var t,n,a,i,o;e.onChange&&(h[e.name]=Object.assign(Object.assign({},e.extra),{"":e.count})),null!==(t=(i=e.rate).lastCountUpdate)&&void 0!==t||(i.lastCountUpdate=d),null!==(n=(o=e.rate).lastCount)&&void 0!==n||(o.lastCount=e.count),e.execution.lastTick=w(null!==(a=e.execution.lastTick)&&void 0!==a?a:d,s-1e3*r,s),e.execution.lastAttempt=s}));const g={},f=m.filter((e=>e.tick&&!e.disabled)),v=.001/c;for(;u>0;){u-=w(u,o,l);const e=s-1e3*u;f.forEach((s=>{var n,a,i;const o=(e-s.execution.lastTick)*v;o>0&&(!s.shouldTick||s.shouldTick(o,t))&&(s.execution.lastResult=s.tick(o,t),s.execution.lastTick=e,s.rate.deltaTicks=(null!==(n=s.rate.deltaTicks)&&void 0!==n?n:0)+1,null!==(a=(i=s.rate).lastTickUpdate)&&void 0!==a||(i.lastTickUpdate=e),s.execution.lastResult&&(g[s.name]||(g[s.name]=[]),g[s.name].includes(s.execution.lastResult)||g[s.name].push(s.execution.lastResult)))}))}return m.forEach((e=>{var n,o,r,l,c,u,d;const m=(s-(null!==(n=e.rate.lastCountUpdate)&&void 0!==n?n:0))/1e3;(null==e.rate.lastCountUpdate||null==e.rate.lastCount||m>=a)&&(e.rate.count=(e.count-(null!==(o=e.rate.lastCount)&&void 0!==o?o:0))/m,e.rate.lastCount=e.count,e.rate.lastCountUpdate=s,e.rate.pastCounts.unshift(e.rate.count),e.rate.pastCounts.splice(i));const f=(s-(null!==(r=e.rate.lastTickUpdate)&&void 0!==r?r:0))/1e3;if((null==e.rate.lastTickUpdate||null==e.rate.deltaTicks||f>=a)&&(e.rate.ticks=(null!==(l=e.rate.deltaTicks)&&void 0!==l?l:0)/f,e.rate.deltaTicks=0,e.rate.lastTickUpdate=s,e.rate.pastTicks.unshift(e.rate.ticks),e.rate.pastTicks.splice(i)),e.onChange){const s=[];e.count!==(null!==(c=h[e.name])&&void 0!==c?c:{})[""]&&s.push(e.onChange(e.count,void 0,t));for(const n in e.extra)e.extra[n]!==(null!==(u=h[e.name])&&void 0!==u?u:{})[n]&&s.push(e.onChange(e.extra[n],n,t));g[e.name]=p([...null!==(d=g[e.name])&&void 0!==d?d:[],...s])}})),Object.values(e.resources).forEach((s=>{var n,a,i;if(s.autoAward&&!s.disabled&&s.count<(null!==(n=s.maxCount)&&void 0!==n?n:0)){const n=s.cost(s.count+1);D(e,n,!1)&&(s.count++,null===(a=s.unlocked)||void 0===a||a||(s.unlocked=!0),s.onPurchase&&s.onPurchase({count:1,gain:[{resource:s,count:1}],cost:[]}),s.onChange&&(g[s.name]=p([...null!==(i=g[s.name])&&void 0!==i?i:[],s.onChange(s.count,void 0,t)])))}})),p(Object.values(g).flat())}(t,null!=e?e:Date.now(),null!=s?s:"unknown")};return k(t,["resources"])}(t,t.settings),t.init(),k(t,["settings","board","resourceManager"])}const W="Context";function z(e,s){const t=Object.assign({},e),n=!!s&&function(e,s){let t=null;if(!t)try{t=JSON.parse(j(window.atob(s)))}catch(e){t=null}if(!t)try{t=JSON.parse(window.atob(s))}catch(e){t=null}if(!t)try{t=JSON.parse(s)}catch(e){t=null}return!!t&&function(e,s){if(!s||"object"!=typeof s||"object"!=typeof e)return!1;let t;for(t in e)typeof s[t]==typeof e[t]&&(e[t]=s[t]);return!0}(e,t)}(t,s);if(n){let s;for(s in e.init(),t.settings)x(e.settings,s,t.settings[s]);e.board=M(Object.assign(Object.assign({},e.board),t.board)),Object.values(t.resourceManager.resources).forEach((s=>e.resourceManager.upsert(s))),e.settings.lastLoaded=Date.now(),e.resourceManager.update(void 0,"load")}return n}function J(e,s){return e.settings.lastSaved=Date.now(),function(e,s=!1){return s?JSON.stringify(O(e),null,2):window.btoa(j(JSON.stringify(O(e))))}(e,s)}function K(e){var s,t;const n="string"==typeof e?{id:e}:e;let a,i=document.getElementById(null!==(s=n.id)&&void 0!==s?s:"");for(a in i||(i=document.createElement(null!==(t=n.tagName)&&void 0!==t?t:"div"),document.body.appendChild(i)),n)x(i,a,n[a]);return i}function V(e){e?document.documentElement.setAttribute("theme",e):document.documentElement.removeAttribute("theme")}var Q=t(415);const Z=JSON.parse('{"hidden":"question-mark","hinted":"eye","flagged":"flag-2","blown":"alert-triangle","revealed":["square-dot","square-1","square-2","square-3","square-4","square-5","square-6","square-7","square-8","square"]}');function Y(e){var s,t,n,a,i,r,l;const c=null!==(t=null===(s=e.cell)||void 0===s?void 0:s.state)&&void 0!==t?t:e.state,u=null!==(i=null===(a=null===(n=e.cell)||void 0===n?void 0:n.neighborContents)||void 0===a?void 0:a.mine)&&void 0!==i?i:e.neighbors;let d=e.icon;if(!d){const e=Z[null!=c?c:"hidden"];if(e instanceof Array)d=e[null!=u?u:0];else{if(null==e)return null;d=e}}const h=d.split(/\s+/).filter((e=>e.trim().length>0));d=null!==(r=h.pop())&&void 0!==r?r:d;let m=null!==(l=h.pop())&&void 0!==l?l:e.color;const g=["icon"];return d&&g.push("icon-"+d),c&&g.push("icon-"+c),m&&!m.startsWith("#")&&(g.push(m),m=void 0),e.className&&g.push(e.className),(0,o.jsx)("svg",Object.assign({className:g.join(" "),width:e.size,height:e.size,color:m},{children:(0,o.jsx)("use",{xlinkHref:`#tabler-${d}`})}))}function X(e){return re("string"==typeof e?{message:e}:null!=e?e:{})}window.addEventListener("load",(()=>K("icon").innerHTML=Q),!1),X.info=(e,s)=>re(Object.assign(Object.assign({},s),{message:e,type:"info"})),X.success=(e,s)=>re(Object.assign(Object.assign({},s),{message:e,type:"success"})),X.fail=(e,s)=>re(Object.assign(Object.assign({},s),{message:e,type:"fail"}));const ee={top:"top",bottom:"bottom"},se={left:"left",center:"center",right:"right"},te={info:"info-circle",success:"circle-check",fail:"alert-circle"};let ne,ae,ie,oe=0;function re(e){var s,t,n;(e=null!=e?e:{}).id=null!==(s=e.id)&&void 0!==s?s:oe++;const a=null!==(t=e.position)&&void 0!==t?t:"top-right";ne=null!=ne?ne:{},ne[a]=null!==(n=ne[a])&&void 0!==n?n:[],a.includes("bottom")?ne[a].unshift(e):ne[a].push(e);const i=e.onHide;return e.onHide=e=>{var s;const t=null!==(s=e.position)&&void 0!==s?s:"top-right";ne[t]=ne[t].filter((s=>s.id!==e.id)),le(),i&&i(e)},le(),Object.assign(Object.assign({},new Promise((s=>{var t;return setTimeout(s,1e3*(null!==(t=e.duration)&&void 0!==t?t:3))}))),{hide:()=>e.onHide(e)})}function le(){ae.render(Object.keys(ee).map((e=>(0,o.jsx)("div",Object.assign({className:`row ${e}`},{children:Object.keys(se).map((s=>{var t;const n=`${e}-${s}`;return(0,o.jsx)("div",Object.assign({className:`group ${s}`},{children:(null!==(t=ne[n])&&void 0!==t?t:[]).map((e=>(0,o.jsx)(ce,Object.assign({},e),`toast_${n}_${e.id}`)))}),n)}))}),e))))}function ce(e){var s;const[t,n]=(0,l.useState)("hidden");function a(){n("hidden"),setTimeout((()=>{e.onHide&&e.onHide(e)}),300)}(0,l.useEffect)((()=>{var s;const t=setTimeout((()=>n("shown")),50),i=setTimeout((()=>{0!==e.duration&&a()}),1e3*(null!==(s=e.duration)&&void 0!==s?s:3));return()=>{clearTimeout(t),clearTimeout(i)}}),[]);const i="object"==typeof e.icon?e.icon:e.icon?{icon:e.icon}:e.type?{icon:te[e.type]}:void 0,r=["toast",t,e.type,e.className].filter((e=>!!e)).join(" ");return(0,o.jsxs)("div",Object.assign({className:r,onClick:null!==(s=e.onClick)&&void 0!==s?s:a},{children:[i&&(0,o.jsx)(Y,Object.assign({},i)),(0,o.jsxs)("div",{children:[e.heading&&(0,o.jsx)("h4",{children:e.heading}),e.message&&(0,o.jsx)("div",Object.assign({className:"message"},{children:e.message}))]})]}))}function ue(e,s="expanded",t=!1,n=("expanded"===s?", ":":"),a="",i="",o=""){if(i.length>0&&e<0)return i;if(a.length>0&&0===e)return a;let r=Math.floor(e/1e3),l=Math.floor(e-1e3*r),c=Math.floor(r/60);r-=60*c;let u=Math.floor(c/60);c-=60*u;let d=Math.floor(u/24);u-=24*d;let h=Math.floor(d/365);if(d-=365*h,t||(l=0),a.length>0&&d+u+c+r+l===0)return a;let m=[];return m="expanded"!==s?[h>0?h.toFixed(0):"",d>0?d.toFixed(0):"",u>0||"compact"===s?u.toFixed(0):"",c>0||"compact"===s?c.toFixed(0):"",(r+l/1e3).toFixed(!t||"tiny"===s&&0===l?0:3)].map((e=>"compact"!==s||1!==e.length&&1!==e.indexOf(".")?e:"0"+e)):[[h,"year"],[d,"day"],[u,"hour"],[c,"minute"],[r,"second",h+d+u+c===0,l]].map((([e,s,t=!1,n=0])=>e>0||n>0||t&&0===e?e.toString()+(n>0?"."+n.toString():"")+" "+s+(1===e?"":"s"):"")),m.filter((e=>e.length>0)).join(n)+(o.length>0?" "+o:"")}function de(e,s,t){var n,a,i,o,r;return e||(e=null!==(a=1===Math.abs(null!==(n=null==s?void 0:s.count)&&void 0!==n?n:0)?null==s?void 0:s.singularName:null==s?void 0:s.pluralName)&&void 0!==a?a:null==s?void 0:s.name),(null===(i=null==t?void 0:t.condition)||void 0===i||i)&&(e||null!==(o=null==t?void 0:t.allowEmpties)&&void 0!==o&&o)?null===(r=null==t?void 0:t.capitalize)||void 0===r||r?(null!=e?e:"").replace(/([a-z])([A-Z]|_\S)/g,((e,s,t)=>`${s} ${t.slice(-1)}`)).replace(/(?:^|\s)\S/g,(e=>e.toUpperCase())):e:void 0}function he(){const e=Math.floor(this.value()),s="none"===this.display?"":e.toFixed()+" ";ie=void 0,X({heading:"Achievement Unlocked!",icon:this.icon,type:"success",message:s+de(void 0,Object.assign(Object.assign({},this),{count:e}))}),"achieveExtraMistake"===this.name&&(this.manager.context.settings.maxErrors=2)}function me({resourceManager:{resources:e}}){return ie||(ie=0,Object.values(e).forEach((e=>{e.autoAward&&(ie=(null!=ie?ie:0)+e.count)}))),1+ie/50}function ge(e){return 1-.2*e.resourceManager.resources.achieveAutomation.count}function fe(e){for(let s=e.length-1;s>0;s--){const t=Math.floor(Math.random()*(s+1));[e[s],e[t]]=[e[t],e[s]]}return e}function ve(e){return e*we(this.context)*me(this.context)}function xe(e){return e}function be({board:e}){return 100*(e.cellCounts.revealed+e.cellCounts.flagged)/(e.rows*e.cols)}function pe({resourceManager:{resources:{rows:e,cols:s,difficulty:t}}}){return e.value()*s.value()*(t.value()/100)}function je({resourceManager:{resources:{hintQuality:e}}}){return e.value()/100}function Ne({board:e}){return e.rows*e.cols-e.numMines-e.cellCounts.revealed}function Oe({resourceManager:{resources:{rows:e,cols:s,difficulty:t,resetSpeed:n}}}){return(1-n.value()/100)*Math.sqrt(e.value()*s.value()*(t.value()/100)*10)}function ke(e){var s;return null!==(s=Ae[null!=e?e:""])&&void 0!==s?s:Ae[""]}function we({resourceManager:{resources:{difficulty:e}}}){return(e.value()+10)/25}function ye(e,s,t,n,a,i){var o,r;const l=e.resourceManager.resources.revealNeighbors,c=[];for(let e=t.row-1;e<=t.row+1;e++)for(let n=t.col-1;n<=t.col+1;n++)"hidden"===(null===(r=(null!==(o=s.cells[e])&&void 0!==o?o:[])[n])||void 0===r?void 0:r.state)&&c.push(s.cells[e][n]);fe(c).splice(n);for(const s of c)C(s,"reveal"),a&&(Se(e,"cell",s.state,!0),"revealed"===s.state&&"clear"===s.contents?l.extra.reveals++:"blown"===s.state||"mine"===s.contents?l.extra.explosions++:l.extra.useless++);return a&&(Ce(l,i),0===c.length&&l.extra.useless++),c.length}function Ce(e,s,t=1){if(s){const s=e.manager.resources.automation;s.add(t),s.extra.total+=t,null!=e.extra.auto&&(e.extra.auto+=t)}else null!=e.extra.manual&&(e.extra.manual+=t);null!=e.extra.total&&(e.extra.total+=t),null!=e.extra.streak&&(e.extra.streak+=t,null!=e.extra.longestStreak&&e.extra.streak>e.extra.longestStreak&&(e.extra.longestStreak=e.extra.streak))}function Se(e,s,t,n,a=1){var i;const o=e.resourceManager.resources,r=o[null!==(i=Te[s+":"+t])&&void 0!==i?i:""];switch(r&&(r.add(a),Ce(r,n,a)),s+":"+t){case"cell:unflagged":o.flags.add(-a),o.flags.extra.unflags+=a;break;case"cell:unrevealed":o.cells.add(-a),o.cells.extra.hidden+=a;break;case"board:won":o.losses.extra.streak=0;break;case"board:lost":o.wins.extra.streak=0}}function Me(e,s=!1){var t;const n=e.resourceManager.resources,a=s&&"inactive"===e.board.state&&0===n.resets.count&&0===n.resets.extra.total,i=a?1:pe(e);if(e.settings.tapMode="reveal",e.board=T(n.rows.value(),n.cols.value(),Math.floor(i),Math.ceil(i)),a&&(0===A(e.board,1,0,0,1)&&A(e.board,1,0,1,1),Se(e,"board","active",!0),Se(e,"cell","hinted",!0)),n.autoClickBoard.count>0&&(null===(t=n.autoClickBoard.unlocked)||void 0===t||t)&&!n.autoClickBoard.disabled)for(let s=n.autoClickBoard.value();s>0;s--){const s=Math.floor(Math.random()*n.rows.value()),t=Math.floor(Math.random()*n.cols.value()),a=e.board.cells[s][t];"hidden"===a.state&&"active"===e.board.state&&(C(a,"reveal"),Se(e,"cell",a.state,!0))}return!0}window.addEventListener("load",(()=>ae=(0,r.s)(K("toasts-root"))),!1);const Te={"board:active":"resets","board:lost":"losses","board:won":"wins","cell:blown":"explosions","cell:hinted":"hints","cell:flagged":"flags","cell:revealed":"cells"},Ae={"":{min:1,max:1,inc:1},x1:{min:1,max:1,inc:1},x5:{min:1,max:5,inc:5},x10:{min:1,max:10,inc:10},"+5":{min:5,max:5,inc:1},"+10":{min:10,max:10,inc:1},max:{min:1,max:100,inc:1}};function Re(e,s){var t,n;if(!e||e.count<=0||null!==(t=e.unlocked)&&void 0!==t&&!t||e.disabled)return NaN;const a=e.manager.context;return null!=s||(s=(Date.now()-(null!==(n=e.execution.lastTick)&&void 0!==n?n:Date.now()))/1e3/a.settings.timeDilation),s*e.count/a.settings.automationBaseSecs/ge(a)}function Ue(e,s){return"tick"===s&&Re(this,e)>=1}function Ee(e){return"revealed"===e.state&&"clear"===e.contents&&e.neighborContents.mine===e.neighborStates.flagged+e.neighborStates.blown&&e.neighborStates.hidden>0}function $e(e){var s;const t=e.resourceManager.resources.autoRevealNeighbors;if(t.count<=0||null!==(s=t.unlocked)&&void 0!==s&&!s||t.disabled||"active"!==e.board.state)return null;const n=e.board.cells.flat().filter(Ee);return 0!==n.length&&ye(e,e.board,fe(n)[0],e.resourceManager.resources.revealNeighbors.count,!0,!0)>0}function qe(e){var s;const t=e.resourceManager.resources;if(t.autoResetGame.count<=0||null!==(s=t.autoResetGame.unlocked)&&void 0!==s&&!s||t.autoResetGame.disabled||"active"===e.board.state||"inactive"===e.board.state||t.resetSpeed.extra.remainingTime>0)return null;const n=Oe(e);return n<.001?(Me(e,!0),!0):(t.resetSpeed.extra.remainingTime=n,t.resetSpeed.onChange=(s,t,n)=>s<.001&&"remainingTime"===t&&"tick"===n&&Me(e,!0),!1)}function Pe(e){return"revealed"===e.state&&"clear"===e.contents&&e.neighborContents.mine===e.neighborStates.flagged+e.neighborStates.blown+e.neighborStates.hidden&&e.neighborContents.clear===e.neighborStates.revealed&&e.neighborStates.hidden>0}function Be(e){var s,t,n;const a=e.resourceManager.resources.autoFlagMines;if(a.count<=0||null!==(s=a.unlocked)&&void 0!==s&&!s||a.disabled||"active"!==e.board.state)return null;const i=e.board.cells.flat().filter(Pe);if(0===i.length)return!1;const o=fe(i)[0],r=[];for(let s=o.row-1;s<=o.row+1;s++)for(let a=o.col-1;a<=o.col+1;a++)"hidden"===(null===(n=(null!==(t=e.board.cells[s])&&void 0!==t?t:[])[a])||void 0===n?void 0:n.state)&&r.push(e.board.cells[s][a]);if(0===r.length)return!1;const l=fe(r)[0];return C(l,"flag"),Se(e,"cell",l.state,!0),!0}function De(e){return"hinted"===e.state&&"clear"===e.contents}function Ge(e){var s;const t=e.resourceManager.resources.autoRevealHints;if(t.count<=0||null!==(s=t.unlocked)&&void 0!==s&&!s||t.disabled||"active"!==e.board.state)return null;const n=e.board.cells.flat().filter(De);if(0===n.length)return!1;const a=fe(n)[0];return C(a,"reveal"),Se(e,"cell",a.state,!0),!0}function _e(e){var s;const t=e.resourceManager.resources.autoPurchaseHints;if(t.count<=0||null!==(s=t.unlocked)&&void 0!==s&&!s||t.disabled||"active"!==e.board.state||0===Ne(e))return null;const n=e.resourceManager.resources.hints;if(e.board.cells.flat().filter((e=>De(e)||Ee(e)||Pe(e))).length>0)return!1;const a=n.buy();if(0===a.count)return!1;const i=A(e.board,a.gain[0].count,0,8,je(e));return i>0&&(Ce(n,!0,i),!0)}function Ie(e){var s;const t=e.resourceManager.resources;if(t.autoBoardUpgrade.count<=0||null!==(s=t.autoBoardUpgrade.unlocked)&&void 0!==s&&!s||t.autoBoardUpgrade.disabled)return null;const n=t.rows.count<t.cols.count?t.rows:t.cols;return 0!==n.buy().count&&(Ce(n,!0),!0)}const Fe=L(),He=(0,l.createContext)(Fe);function Le(e){return(0,o.jsx)(He.Provider,Object.assign({value:Fe},{children:e.children}))}function We(){return function(e){return Object.assign(Object.assign(Object.assign({},e.resourceManager),e),{context:e,setBoard:s=>e.board=s,resource:s=>e.resourceManager.get(s),load:()=>{return z(e,(s=W,b()?window.localStorage.getItem(s):null));var s},loadAs:s=>z(e,s),save:s=>{return t=W,n=J(e,s),void(b()&&n&&window.localStorage.setItem(t,n));var t,n},saveAs:s=>J(e,s),reset:()=>function(e){var s;s=W,b()&&window.localStorage.removeItem(s),L(e)}(e)})}((0,l.useContext)(He))}const ze=[v,m,f,g,h,u,c,d];function Je(){const e=We(),s=(0,l.useMemo)((()=>e.saveAs(!0)),[]);return(0,o.jsxs)("div",Object.assign({id:"reset"},{children:[(0,o.jsxs)("div",Object.assign({className:"panel options"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Load Failure!"})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"Looks like something went very wrong in loading the game. It's possible that the game version is out of date, or that the save data is corrupt."})),(0,o.jsx)("hr",{className:"separator"}),(0,o.jsx)("div",Object.assign({className:"full"},{children:"For your records, here is the current contents of the save state. Keep this somewhere before resetting the game:"})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:(0,o.jsx)("textarea",{value:s,readOnly:!0})}))]})),(0,o.jsxs)("div",Object.assign({className:"panel options reset"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar warning"},{children:"Game Reset"})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"WARNING: this will completely reset your game and delete all saved progress and settings. This will hard reset the game from beginning."})),(0,o.jsx)("div",Object.assign({className:"full right"},{children:(0,o.jsx)("input",{type:"button",value:"Hard Reset Everything",onClick:function(){confirm("Are you sure you want to reset? This cannot be undone.")&&(e.reset(),window.location.reload())}})}))]}))]}))}Object.assign(Fe,Object.assign(Object.assign(Object.assign(Object.assign({},n),i),a),{init:function(){var e;this.resourceManager.gainMultiplier=ve,this.resourceManager.costMultiplier=xe,ze.flat().forEach((e=>this.resourceManager.upsert(e))),e=this.resourceManager,Object.values(e.resources).forEach((e=>{const s=Object.assign(Object.assign(Object.assign(Object.assign({},e.manager.context),e.manager),e.manager.resources),{timer:R(E,e),value:R(F,e)});if("string"==typeof e.value&&(e.value=(0,U.K)(e.value,e,["kind"],s)),"string"==typeof e.cost){const t="["+e.cost.replace(/\s/gim,"").split(/[;]/gim).map((e=>{const s=e.split(/:/gim),t=[`resource: ${s[0]}`,`count: ${s[s.length-1]}`];return s.length>2&&t.push(`kind: "${s[1]}"`),"{"+t.join(", ")+"}"})).join(", ")+"]";e.cost=(0,U.K)(t,e,["n"],s)}"string"==typeof e.shouldTick&&(e.shouldTick=(0,U.K)(e.shouldTick,e,["dt","source"],s)),"string"==typeof e.tick&&(e.tick=(0,U.K)(e.tick,e,["dt","source"],s)),"string"==typeof e.gainMultiplier&&(e.gainMultiplier=(0,U.K)(e.gainMultiplier,e,["m"],s)),"string"==typeof e.costMultiplier&&(e.costMultiplier=(0,U.K)(e.costMultiplier,e,["m"],s)),"string"==typeof e.onPurchase&&(e.onPurchase=(0,U.K)(e.onPurchase,e,["purchase"],s)),"string"==typeof e.onChange&&(e.onChange=(0,U.K)(e.onChange,e,["value","kind","source"],s))}))}}));var Ke=t(711),Ve=t(974);const Qe={floor:Math.floor,round:Math.round,ceil:Math.ceil};function Ze(e,s,t){const n=Math.pow(10,s);return Qe[t](e*n)/n}const Ye={tiny:4,compact:9,expanded:21},Xe={none:0,number:1,percentage:1,time:1e3};function es(e){var s,t,n,a,i,r,l,{value:c,epoch:u,name:d,resource:h={name:d,count:c},kind:m,display:g=(null!==(s=h.display)&&void 0!==s?s:"number"),length:f="expanded",rounding:v=("number"===g?"floor":"round"),showLocked:x=!1,showIcon:b=!0,showName:p=!0,showValue:j="none"!==g,showMaxValue:N=!1,showRawValue:O=!1,showRate:k=!1,showExtras:y=!1,showRawExtras:C=y&&O,showColors:S=!1,showRateColors:M=!0,showNegatives:T=!0,showZeros:A=!0,showPlusSign:R=!1,showGrouping:U="number"===g,showZeroRates:E=!1,showRatePercentages:$="number"===g,showRateHistory:q=!1,showCapitalized:P=!0,showChrome:B=!1,precision:D=("time"===g?3:"number"===g?2:0),valuePrecision:G=D,rawValuePrecision:_=G,ratePrecision:I=("time"===g?0:D),extrasPrecision:F=D,rawExtrasPrecision:H=F,reversedDirection:L=!1,prefix:W="",suffix:z="",infix:J=((b||p)&&(j||N||O||k||y||C)?":":""),placeholder:K="-",timeSeparator:V=("expanded"===f?", ":":"),ago:Q="ago",now:Z="now",never:X="never",className:ee="",style:se}=e;const te=[];function ne(e=NaN,s="",{prec:t=D,rnd:n=v,cls:a="",disp:i=g,len:r=f,neg:l=T,zero:c=A,plus:d=R,grp:h=U,color:m=S,paren:x=!1,sep:b=V,pre:p="",post:j="",ref:N=!1,dry:O=!1}){const k=Ze((e-(N&&u?u:0))*Xe[i],t,n);if(isNaN(k)||!l&&k<0||!c&&0===k)return"";const y=[i.toString()];if(a&&y.push(a),m){const e=L?-k:+k;y.push(e>0?"positive":e<0?"negative":"zero")}let C=K;return"number"===i||"percentage"===i?(C=function(e,s=21,t=3,n=!1,a=!1){const i={style:"decimal",notation:"standard",signDisplay:n?"always":"auto",useGrouping:a,minimumIntegerDigits:1,minimumFractionDigits:0,maximumFractionDigits:w(t,0,s-1),minimumSignificantDigits:1,maximumSignificantDigits:s},o=e.toLocaleString(void 0,i);return o.replace(/\D/g,"").length>s?(i.notation="scientific",e.toLocaleString(void 0,i)):o}(k,Ye[r],t,d,h),"percentage"===i&&(C+="%")):"time"===i?(C=N&&X.length>0&&(e<=0||(null!=u?u:-1/0)<=0)?X:N&&null!=u?ue(k,r,t>0,b,Z,X,Q):ue(k,r,t>0),d&&k>=0&&"expanded"!==r&&(C=`+${C}`)):"none"===i&&(C=""),C=p+C+j,x&&(C=`(${C})`),O||te.push((0,o.jsx)("div",Object.assign({className:y.join(" ")},{children:C}),s)),C}const ae=["resource"],ie=null!==(a=null!==(t=null!=c?c:h.value?h.value(m):void 0)&&void 0!==t?t:(null!==(n=h.extra)&&void 0!==n?n:{})[null!=m?m:""])&&void 0!==a?a:h.count;if((b&&h.icon||p&&h.name)&&te.push((0,o.jsxs)("div",Object.assign({className:"name"},{children:[b&&h.icon&&h.icon.length>0?(0,o.jsx)(Y,{icon:h.icon,size:"1em"}):null,de(d,{count:Ze(ie*Xe[g],G,v),name:h.name,singularName:h.singularName,pluralName:h.pluralName},{condition:p,allowEmpties:!1,capitalize:P}),J]}),"name")),j){const e=N?ne(h.maxCount,"denominator",{prec:G,pre:" / ",dry:!0}):"";ne(ie,"value",{prec:G,ref:null!=u&&!isNaN(u),post:e,cls:"value"})}if(O&&ne(null!=c?c:m&&h.extra?h.extra[m]:h.count,"raw-value",{disp:"number",prec:_,paren:j,cls:"raw-value"}),k&&!m&&null!=h.rate&&(null!==(i=h.rate.lastCountUpdate)&&void 0!==i?i:0)>0&&(E||0!==h.rate.count)){let e=0;if(q&&h.rate.pastCounts.length>0){let s=0,t=h.rate.pastCounts.length;h.rate.pastCounts.forEach(((n,a)=>{const i=t-a;e+=n*i,s+=i})),e/=s}else e=h.rate.count;let s=$,t=$?ie:1;(0===t||s&&(e/t<.01||t<1e3))&&(s=!1,t=1),ne(e/t,"rate",{disp:s?"percentage":g,prec:I,paren:j||O,color:M,len:s||"expanded"!==f?"tiny":"compact",cls:"rate",neg:!0,zero:!0,plus:!0,grp:!1,post:"/s"})}if((y||C)&&!m&&h.extra&&Object.keys(h.extra).length>0)for(let e in h.extra)e.length>0&&(te.length>0&&te.push((0,o.jsx)("div",{className:"break"},`break-${e}`)),te.push((0,o.jsxs)("div",Object.assign({className:"extra-name"},{children:[de(e,void 0,{capitalize:P}),J]}),`extra-name-${e}`))),y&&ne(h.value?h.value(e):h.extra[e],`extra-value-${e}`,{disp:e.toLowerCase().indexOf("time")>=0?"time":g,prec:F,cls:"extra-value"}),C&&ne(h.extra[e],`extra-raw-${e}`,{disp:"number",prec:H,paren:y,cls:"raw-extra-value"}),k&&null!=h.rate&&(null!==(r=h.rate.lastCountUpdate)&&void 0!==r?r:0)>0&&(E||0!==h.rate.count)&&te.push((0,o.jsx)("div",Object.assign({className:"rate"},{children:K}),`extra-rate-${e}`));x||null===(l=h.unlocked)||void 0===l||l||(ae.push("locked"),te.splice(0,te.length,(0,o.jsx)("div",Object.assign({className:"placeholder"},{children:K}),"lock")));const oe=B?void 0:se;ee&&!B&&ae.push(ee);const re=(0,o.jsxs)("div",Object.assign({className:ae.join(" "),style:oe,id:`resource-${null!=d?d:h.name}`},{children:[W&&(0,o.jsx)("div",Object.assign({className:"prefix"},{children:W})),te,z&&(0,o.jsx)("div",Object.assign({className:"suffix"},{children:z}))]}));return B?(0,o.jsx)("div",Object.assign({className:ee||void 0,style:se,id:`resource-chrome-${null!=d?d:h.name}`},{children:re})):re}function ss(){const{context:e,resource:s}=We();let[t,n]=[0,0];const a=u.flat().map((({name:e})=>{var a;const i=s(e);return t+=i.count,n+=null!==(a=i.maxCount)&&void 0!==a?a:0,i})),i=c.flat().map((({name:e})=>{var a;const i=s(e);return t+=i.count,n+=null!==(a=i.maxCount)&&void 0!==a?a:0,i})),r=d.flat().map((({name:e})=>{var a;const i=s(e);return t+=i.count,n+=null!==(a=i.maxCount)&&void 0!==a?a:0,i}));function l(e){var s,t;return(0,o.jsxs)("div",Object.assign({className:`achievement ${e.count?"":"un"}earned`},{children:[(0,o.jsx)(es,{resource:e,showChrome:!0,showIcon:!1,showValue:e.count>0,infix:"",placeholder:"???",className:"value-first"}),(null===(s=e.unlocked)||void 0===s||s)&&e.description&&(0,o.jsx)("div",Object.assign({className:"subtext"},{children:e.description})),(null===(t=e.unlocked)||void 0===t||t)&&e.maxCount&&e.maxCount>1&&(0,o.jsxs)("div",Object.assign({className:"subtext"},{children:["Gained ",e.count," / ",e.maxCount," milestones"]}))]}),e.name)}return(0,o.jsxs)("div",Object.assign({id:"achievements"},{children:[(0,o.jsxs)("div",Object.assign({className:"panel"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Achievements"})),(0,o.jsx)("div",Object.assign({className:"half right"},{children:"Total achievements score:"})),(0,o.jsxs)("div",Object.assign({className:"half left"},{children:[t," / ",n]})),(0,o.jsx)("div",Object.assign({className:"half right"},{children:"Score multiplier from achievements:"})),(0,o.jsxs)("div",Object.assign({className:"half left"},{children:[Math.floor(100*me(e)),"%"]}))]})),(0,o.jsxs)("div",Object.assign({className:"panel"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Normal Achievements"})),a.map(l)]})),(0,o.jsxs)("div",Object.assign({className:"panel"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Advanced Achievements"})),i.map(l)]})),(0,o.jsxs)("div",Object.assign({className:"panel"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Secret Achievements"})),r.map(l)]}))]}))}function ts({resource:e,kind:s,enabled:t=!0,allowUnlocking:n=!1,maxNum:a,minNum:i,increment:r,precision:l=0,gainMultiplier:c=1,costMultiplier:u=1,mode:d="buy",overrideCount:h,overrideMaxCount:m,overrideMinCount:g,prefix:f="Buy",suffix:v="",infix:x="for",and:b="&",className:p,style:j,onPurchase:N}){var O;const{resourceManager:k,settings:{buyAmount:y}}=We(),C=k.get(e),S=ke(y);function M(e,s){return e.map(((e,t)=>{var a;return(0,o.jsx)(es,{resource:"string"==typeof e.resource?{name:e.resource}:e.resource,value:e.count*s,kind:e.kind,display:"string"!=typeof e.resource?e.resource.display:"number",precision:l,infix:"",placeholder:"",prefix:t>0?b:"",showLocked:n,showValue:"string"==typeof e.resource||null===(a=e.resource.unlocked)||void 0===a||a,showColors:!0,showChrome:!0,showPlusSign:!0,className:"value-first"},"string"==typeof e.resource?e.resource:e.resource.name)}))}function T(e=0){var t,n;const a=null!=h?h:C.value(s);return w(Math.floor((a+e)/(null!=r?r:1))*(null!=r?r:1),Math.max(null!=g?g:-1/0,null!==(t=C.minCount)&&void 0!==t?t:0),Math.min(null!=m?m:1/0,null!==(n=C.maxCount)&&void 0!==n?n:1/0))-a}null!=i||(i=S.min),null!=a||(a=S.max),null!=r||(r=S.inc),null===(O=C.unlocked)||void 0===O||O||(n?i=a=r=1:(i=a=r=0,t=!1)),"sell"===d&&([i,a,r]=[-i,-a,-r]);let A=!0,U=C.buy(T(a),"dry-partial",s,c,u);if(U.count%r!=0&&(U=C.buy(T(U.count),"dry-partial",s,c,u)),i>=0&&U.count<i||i<0&&U.count>i||0===U.count){const e=T(w(r,Math.min(i,a),Math.max(i,a)));U=C.buy(Math.abs(e)<1?Math.sign(r):e,"dry-full",s,c,u),A=!1}t||(U.cost=[]);const E=U.cost.reduce(((e,s)=>e+s.count),0),$=["buy-button",`buy-button-${A?"":"un"}affordable`,p].filter((e=>!!e));return(0,o.jsxs)("button",Object.assign({onClick:R((function(e,a){var i;if(a.preventDefault(),!t||0===e)return;null!==(i=C.unlocked)&&void 0!==i&&!i&&n&&(C.unlocked=!0);const o=C.buy(e,"partial",s,c,u);N&&o.gain.length>0&&N(C,s,o.gain[0].count)}),A&&t?U.count:0),disabled:!A||!t,className:$.join(" "),style:j,id:`button-buy-${C.name}`},{children:[f&&(0,o.jsx)("div",Object.assign({className:"prefix"},{children:f})),M(U.gain,1),0!==E&&x&&(0,o.jsx)("div",Object.assign({className:"infix"},{children:x})),0!==E&&M(U.cost,-1),v&&(0,o.jsx)("div",Object.assign({className:"suffix"},{children:v}))]}))}function ns({showTapMode:e=!0,showBuyAmount:s=!0}){const{settings:t}=We(),[n,a]=(0,l.useState)(t.tapMode),[i,r]=(0,l.useState)(t.buyAmount);function c(e){e.preventDefault(),t.buyAmount=e.target.value,r(t.buyAmount)}function u(e,s,n){return(0,o.jsxs)("button",Object.assign({type:"button",value:e,className:(a=e,a===t.buyAmount?"selected":"unselected"),onClick:c,id:`button-${e.replace(/\W/g,"")}`},{children:[s&&(0,o.jsx)(Y,{icon:s}),n]}));var a}return(0,o.jsxs)("div",Object.assign({className:"panel mode-controls"},{children:[e&&(0,o.jsxs)("div",Object.assign({className:"left"},{children:[(0,o.jsx)("span",{children:"Tap mode:"}),(0,o.jsxs)("button",Object.assign({type:"button",value:t.tapMode,onClick:function(e){e.preventDefault(),t.tapMode="reveal"===t.tapMode?"flag":"reveal",a(t.tapMode)},id:"button-tapmode"},{children:[(0,o.jsx)(Y,{state:"reveal"===t.tapMode?"revealed":"flagged",neighbors:9}),"reveal"===t.tapMode?"Revealing":"Flagging"]}))]})),(0,o.jsx)("div",{className:"spacer"}),s&&(0,o.jsxs)("div",Object.assign({className:"right"},{children:[(0,o.jsx)("span",{children:"Buy amount:"}),u("x1","x","1"),u("x5","arrow-bar-to-right","5"),u("+5","x","5"),u("x10","arrow-bar-to-right","10"),u("+10","x","10"),u("max",void 0,"MAX")]}))]}))}function as({value:e=NaN,minValue:s=0,maxValue:t=1,orientation:n="horizontal",width:a=("horizontal"===n?"100%":"1ex"),height:i=("vertical"===n?"100%":"1ex"),showPercent:r=!1,enabled:l=!isNaN(e),className:c,children:u}){const d=w((e-s)/(t-s)),h="horizontal"===n?d:1,m="vertical"===n?d:1;return(0,o.jsxs)("div",Object.assign({className:`progress-bar ${null!=c?c:""}`,style:{minWidth:a,minHeight:i}},{children:[(0,o.jsxs)("div",Object.assign({className:"children"},{children:[l&&r&&(0,o.jsxs)("span",{children:[Math.floor(100*d),"%"]}),u]})),l&&d>.001&&(0,o.jsx)("div",{className:"primary",style:{width:100*h+"%",height:100*m+"%"}}),(0,o.jsx)("div",{className:l?"secondary":"disabled"})]}))}function is(){const{context:e,board:s,resources:{wins:t,cells:n,automation:a}}=We();return(0,o.jsxs)("div",Object.assign({className:`panel board-state-${s.state}`,id:"resource-bar"},{children:[(0,o.jsx)(es,{resource:t,precision:0,showRate:!0,showZeroRates:!0,showRatePercentages:!1,showChrome:!0}),a.extra.total>=5&&(0,o.jsx)(es,{resource:a,precision:0,showRate:!0,showZeroRates:!0,showRatePercentages:!1,showChrome:!0}),(0,o.jsx)(es,{resource:n,precision:0,showRate:!0,showZeroRates:!0,showRatePercentages:!1,showChrome:!0}),(0,o.jsx)("hr",{className:"separator"}),(0,o.jsx)(es,{name:"Board",suffix:`${s.rows}x${s.cols}`,showChrome:!0}),(0,o.jsx)(es,{name:"progress",value:be(e),display:"percentage",showChrome:!0}),(0,o.jsx)(es,{resource:{name:"Mines",count:s.cellCounts.flagged,maxCount:s.numMines},showMaxValue:!0,showChrome:!0})]}))}function os({enabled:e=!0,checked:s=!1,onChange:t,checkedContents:n,unCheckedContents:a,className:i,style:r,children:c}){const[u,d]=(0,l.useState)(!1);(0,l.useEffect)((()=>{d(s)}),[s]);const h=["toggle-button",`toggle-button-${e?"en":"dis"}abled`,`toggle-button-${s?"":"un"}checked`,i].filter((e=>!!e));return(0,o.jsxs)("div",Object.assign({onClick:function(s){s.preventDefault(),e&&(d(!u),t&&t(!u))},className:h.join(" "),style:r},{children:[(0,o.jsx)("div",Object.assign({className:"check"},{children:(0,o.jsx)("div",{children:n})})),(0,o.jsx)("div",Object.assign({className:"contents"},{children:c})),(0,o.jsx)("div",Object.assign({className:"uncheck"},{children:(0,o.jsx)("div",{children:a})})),(0,o.jsx)("div",{className:"circle"})]}))}function rs(){const{context:e,resources:{revealNeighbors:s,autoRevealNeighbors:t,autoFlagMines:n,autoRevealHints:a,autoPurchaseHints:i,autoResetGame:r,autoClickBoard:l,autoBoardUpgrade:c}}=We(),u=e.settings.automationBaseSecs*ge(e),d=ue(1e3*u);function h(e){return!e.disabled&&u/e.value()<=1?1:Re(e)}return(0,o.jsxs)("div",Object.assign({id:"automation",className:"automation"},{children:[(0,o.jsx)(is,{}),(0,o.jsx)(ns,{showTapMode:!1}),(0,o.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Cell Automation"})),(0,o.jsx)("div",Object.assign({className:"half"},{children:(0,o.jsx)(es,{resource:t,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===t.count?"":"s"} every ${d}`})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:t,allowUnlocking:!0,enabled:s.unlocked&&s.count>0,prefix:t.unlocked?"Additional":"Unlock"})})),(0,o.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,o.jsx)(os,{checked:t.unlocked&&!t.disabled,onChange:e=>t.disabled=!e,checkedContents:(0,o.jsx)(Y,{icon:"robot"}),unCheckedContents:(0,o.jsx)(Y,{icon:"robot-off"}),enabled:t.unlocked&&t.count>0})]})),(0,o.jsx)(as,Object.assign({value:h(t),className:"full computed"},{children:"Automatically reveals the neighboring hidden squares if all the mines around it have been flagged."})),(0,o.jsx)("hr",{className:"separator"}),(0,o.jsx)("div",Object.assign({className:"half"},{children:(0,o.jsx)(es,{resource:n,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===n.count?"":"s"} every ${d}`})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:n,allowUnlocking:!0,enabled:t.unlocked&&t.count>0,prefix:n.unlocked?"Additional":"Unlock"})})),(0,o.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,o.jsx)(os,{checked:n.unlocked&&!n.disabled,onChange:e=>n.disabled=!e,checkedContents:(0,o.jsx)(Y,{icon:"robot"}),unCheckedContents:(0,o.jsx)(Y,{icon:"robot-off"}),enabled:n.unlocked&&n.count>0})]})),(0,o.jsx)(as,Object.assign({value:h(n),className:"full computed"},{children:"Automatically flags the hidden mines around a square if there are no more hidden clear squares left around it."})),(0,o.jsx)("hr",{className:"separator"}),(0,o.jsx)("div",Object.assign({className:"half"},{children:(0,o.jsx)(es,{resource:a,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===a.count?"":"s"} every ${d}`})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:a,allowUnlocking:!0,prefix:a.unlocked?"Additional":"Unlock"})})),(0,o.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,o.jsx)(os,{checked:a.unlocked&&!a.disabled,onChange:e=>a.disabled=!e,checkedContents:(0,o.jsx)(Y,{icon:"robot"}),unCheckedContents:(0,o.jsx)(Y,{icon:"robot-off"}),enabled:a.unlocked&&a.count>0})]})),(0,o.jsx)(as,Object.assign({value:h(a),className:"full computed"},{children:"Automatically reveals any purchased hints."})),(0,o.jsx)("hr",{className:"separator"}),(0,o.jsx)("div",Object.assign({className:"half"},{children:(0,o.jsx)(es,{resource:i,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===i.count?"":"s"} every ${d}`})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:i,allowUnlocking:!0,prefix:i.unlocked?"Additional":"Unlock"})})),(0,o.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,o.jsx)(os,{checked:i.unlocked&&!i.disabled,onChange:e=>i.disabled=!e,checkedContents:(0,o.jsx)(Y,{icon:"robot"}),unCheckedContents:(0,o.jsx)(Y,{icon:"robot-off"}),enabled:i.unlocked&&i.count>0})]})),(0,o.jsx)(as,Object.assign({value:h(i),className:"full computed"},{children:"Automatically makes a hint purchase when there are no other actions available."}))]})),(0,o.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Game Automation"})),(0,o.jsx)("div",Object.assign({className:"half"},{children:(0,o.jsx)(es,{resource:r,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===r.count?"":"s"} every ${d}`})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:r,allowUnlocking:!0,prefix:r.unlocked?"Additional":"Unlock"})})),(0,o.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,o.jsx)(os,{checked:r.unlocked&&!r.disabled,onChange:e=>r.disabled=!e,checkedContents:(0,o.jsx)(Y,{icon:"robot"}),unCheckedContents:(0,o.jsx)(Y,{icon:"robot-off"}),enabled:r.unlocked&&r.count>0})]})),(0,o.jsx)(as,Object.assign({value:h(r),className:"full computed"},{children:"Automatically initiates game reset when the game is either won or lost."})),(0,o.jsx)("hr",{className:"separator"}),(0,o.jsx)("div",Object.assign({className:"half"},{children:(0,o.jsx)(es,{resource:l,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===l.count?"":"s"} after reset`})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:l,allowUnlocking:!0,prefix:l.unlocked?"Additional":"Unlock"})})),(0,o.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,o.jsx)(os,{checked:l.unlocked&&!l.disabled,onChange:e=>l.disabled=!e,checkedContents:(0,o.jsx)(Y,{icon:"robot"}),unCheckedContents:(0,o.jsx)(Y,{icon:"robot-off"}),enabled:l.unlocked&&l.count>0})]})),(0,o.jsx)("div",Object.assign({className:"full computed"},{children:"Automatically reveals cells on new games. Does not differentiate between mines and clear cells."}))]})),(0,o.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Board Automation"})),(0,o.jsx)("div",Object.assign({className:"half"},{children:(0,o.jsx)(es,{resource:c,showChrome:!0,showLocked:!0,infix:"",suffix:`time${1===c.count?"":"s"} every ${d}`})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:c,allowUnlocking:!0,prefix:c.unlocked?"Additional":"Unlock"})})),(0,o.jsxs)("div",Object.assign({className:"full right"},{children:["Enabled:",(0,o.jsx)(os,{checked:c.unlocked&&!c.disabled,onChange:e=>c.disabled=!e,checkedContents:(0,o.jsx)(Y,{icon:"robot"}),unCheckedContents:(0,o.jsx)(Y,{icon:"robot-off"}),enabled:c.unlocked&&c.count>0})]})),(0,o.jsx)(as,Object.assign({value:h(c),className:"full computed"},{children:"Automatically purchases game width and game height expansions if affordable."}))]}))]}))}function ls(e,s,t){const n=s[e];if(!n)return;const a=Object.keys(s).map((e=>parseInt(e))).sort(((e,s)=>e-s)),i=a.indexOf(e),o=a[i-1],r=a[i+1],l=Ze(e+100,-2,"floor");return function(e,s,...t){const n=Object.assign({},s);if(e){let s;for(s in e){let a=e[s];x(n,s,"function"==typeof a?a(n,...t):a)}}return n}(n,{step:e,enabled:!0,title:`Tutorial step #${e}`,body:"...",prevStep:o,prevStepTitle:"< back",nextStep:r>=0?r:l,nextStepTitle:r>=0?"next >":"done",skipToStep:l,skipToStepTitle:"skip >>>",highlightSelector:"",greyOut:!1,bounds:{left:"50% - 200px",top:"6rem",width:"400px",height:"450px"}},t)}const cs={0:{title:"Progressive Mine Sweep",body:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:"Hi! Welcome to progressive mine sweeper."})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"This is my special take on the classic minesweeper game with progressive / incremental aspects built into it."})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"The first part of this tutorial will walk you through how to play minesweeper. At any point in tutorial you can move to the next or previous pages. Feel free to skip to the next chapter if you already know how to play!"}))]}),greyOut:!0}};function us(e){var s,t;const n=We(),[a,i]=(0,l.useState)(0),r=null!==(s=e.board)&&void 0!==s?s:n.board,c=e.cell,u=!e.board,d=(0,l.useCallback)((function(s){var t,a,o;s.preventDefault();const l=n.resources.clicks;if(u&&l.count++,null!==(t=e.enabled)&&void 0!==t&&!t||c.locked)return void(u&&l.extra.useless++);const d=c.state;if(2===s.button&&"contextmenu"===s.type||0===s.button&&"click"===s.type&&("flag"===n.settings.tapMode||s.altKey||s.ctrlKey||s.metaKey||s.shiftKey)?(u&&l.extra.right++,C(c,"flag")):0===s.button&&"click"===s.type&&"reveal"===n.settings.tapMode?(u&&l.extra.left++,C(c,"reveal")):0===s.button&&"dblclick"===s.type&&(u&&(l.extra.double++,i((e=>(l.extra.useless-=w(e,0,2),l.extra.left-=w(e,0,2),0)))),null===(a=n.resources.revealNeighbors.unlocked)||void 0===a||a?ye(n,r,c,n.resources.revealNeighbors.count,u,!1):u&&l.extra.useless++),d===c.state&&"dblclick"!==s.type)i((e=>e+1)),u&&l.extra.useless++;else if(i(0),u&&d!==c.state&&(Se(n,"cell",c.state,!1),"hidden"===c.state&&Se(n,"cell","un"+d,!1)),r.hadUserAction=!0,"active"===r.state){let s=M(r,n.settings.maxErrors);(null!==(o=e.setBoard)&&void 0!==o?o:n.setBoard)(Object.assign({},s)),"active"!==s.state&&u&&Se(n,"board",s.state,!1)}}),[r,c,e.enabled]),h=Math.floor((null!==(t=e.boardWidth)&&void 0!==t?t:640)*e.cellRatio*.98/100),m=`min(${Math.floor(.95*e.cellRatio)}vw, ${Math.floor(.8*e.cellRatio)}vh, ${h}px)`;return(0,o.jsx)("td",Object.assign({className:`cell cell-${c.state}`,onClick:d,onDoubleClick:d,onContextMenu:d,id:`col-${c.col}`},{children:(0,o.jsx)("div",Object.assign({style:{width:m,height:m},id:`cell-${c.row}-${c.col}`},{children:(0,o.jsx)(Y,{cell:c})}))}))}function ds(e){var s;const t=We(),n=null!==(s=e.board)&&void 0!==s?s:t.board,a=(0,l.useMemo)((function(){const s=100/Math.max(n.rows,n.cols);return(0,o.jsx)("table",Object.assign({id:n===t.board?"board-main":"board-custom",className:"board"},{children:(0,o.jsx)("tbody",{children:n.cells.flatMap(((t,a)=>(0,o.jsx)("tr",Object.assign({id:`row-${a}`},{children:t.map(((t,i)=>(0,o.jsx)(us,{cell:t,cellRatio:s,enabled:"active"===n.state,board:e.board,setBoard:e.setBoard,boardWidth:e.boardWidth},`cell:${a}:${i}`)))}),`row:${a}:*`)))})}))}),[n]);return(0,o.jsxs)("div",Object.assign({className:"minefield"},{children:[a,e.children]}))}function hs(e){const[s,t]=(0,l.useState)(S);return(0,l.useEffect)((()=>{var s,n,a,i,o,r,l;const c=T(e.rows,e.cols,e.randomMines);e.unlocks&&e.unlocks.length>0&&c.cells.forEach((e=>e.forEach((e=>e.locked=!0)))),null===(s=e.mines)||void 0===s||s.forEach((([e,s])=>c.cells[e][s].contents="mine")),null===(n=e.hints)||void 0===n||n.forEach((([e,s])=>c.cells[e][s].state="hinted")),null===(a=e.flags)||void 0===a||a.forEach((([e,s])=>c.cells[e][s].state="flagged")),null===(i=e.reveals)||void 0===i||i.forEach((([e,s])=>c.cells[e][s].state="revealed")),null===(o=e.blowns)||void 0===o||o.forEach((([e,s])=>c.cells[e][s].state="blown")),null===(r=e.locks)||void 0===r||r.forEach((([e,s])=>c.cells[e][s].locked=!0)),null===(l=e.unlocks)||void 0===l||l.forEach((([e,s])=>c.cells[e][s].locked=!1)),t(M(c))}),[e]),(0,o.jsx)(ds,{board:s,setBoard:t,boardWidth:e.size})}const ms={10:{title:"What is minesweeper",body:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:"The game board consists of a playing field shaped like a grid of squares. There are a certain number of mines buried under this field. The objective of each game is to successfully clear all the empty cells, and flag the cells containing mines without triggering (exploding) them."})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:"Sample 3x3 board:"})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:(0,o.jsx)(hs,{rows:3,cols:3,randomMines:1,size:200})}))]}),greyOut:!0},15:{title:"Revealing a square",body:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:"Clicking or tapping on an empty square will reveal its contents. The contents of a square is either clear or a mine. When revealing a clear square, you are given a clue to the number of mines surrounding it  in all directions, including diagonals. Revealing a mine, however, would trigger it and explode!"})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:"Try clicking (or tapping) the hinted square below:"})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:(0,o.jsx)(hs,{rows:3,cols:3,size:200,mines:[[2,2]],hints:[[0,0]],unlocks:[[0,0]]})}))]}),greyOut:!0},20:{title:"Revealing squares",body:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:(0,o.jsxs)("span",{children:["The revealed contents of ",(0,o.jsx)(Y,{state:"revealed",neighbors:0,size:"1em"})," tells us there are no mines in the squares surrounding it, so it's safe to go ahead and reveal the 3 surrounding squares as well!"]})})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:"Try clicking (or tapping) the hinted squares below:"})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:(0,o.jsx)(hs,{rows:3,cols:3,size:200,mines:[[2,2]],reveals:[[0,0]],hints:[[0,1],[1,0],[1,1]],unlocks:[[0,1],[1,0],[1,1]]})}))]}),greyOut:!0},25:{title:"Reasoning about squares",body:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:(0,o.jsxs)("span",{children:["Uh oh! The ",(0,o.jsx)(Y,{state:"revealed",neighbors:1,size:"1em"})," in the middle means there's one mine hidden under one of the remaining squares around the centerpiece! Better be careful with this one..."]})})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"However, we know from the other 2 squares we just revealed that there are no mines in the 2 squares immediately surrounding those places."})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:(0,o.jsx)(hs,{rows:3,cols:3,size:200,mines:[[2,2]],reveals:[[0,0],[0,1],[1,0],[1,1]],hints:[[0,2],[1,2],[2,0],[2,1]],unlocks:[[0,2],[1,2],[2,0],[2,1]]})}))]}),greyOut:!0},30:{title:"Flagging squares",body:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:"This brings us to the final square in the corner which is obviously a mine! You won't want to set this off!"})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"Be careful with this one. Right (or meta) click on the square to flag it, or simply toggle the tapping mode to flag squares instead of revealing:"})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:(0,o.jsx)(hs,{rows:3,cols:3,size:200,mines:[[2,2]],reveals:[[0,0],[0,1],[1,0],[1,1],[0,2],[1,2],[2,0],[2,1]]})})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:(0,o.jsx)(ns,{showBuyAmount:!1})}))]}),greyOut:!0,onMount:(e,s)=>()=>{gs=s.settings.tapMode},onUnmount:(e,s)=>()=>{s.settings.tapMode=gs}},35:{title:"Winning a game",body:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:"No sweat if you accidentally set off the mine in the previous step."})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"Once you reveal all the squares and flag all the mines correctly, you win the playing field, and the game announces it to you."})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"Similarly, if you set off a mine, you lose the playing field and need to reset the board."})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"In either case, you will be presented with an option to reset the board and receive a brand new game to play. We can upgrade this box and its functions later on."}))]}),greyOut:!0}};let gs="reveal";const fs={100:{title:"Scoring",body:(e,s)=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:"Scores are awarded to the player based on how many cells have been successfully marked and how many playing fields have been cleared. These rewards can be used to purchase upgrades to the game to make it more engaging or challenging."})),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)(es,{resource:s.resourceManager.get("wins"),showChrome:!0})})),(0,o.jsx)("div",Object.assign({className:"half left"},{children:"Shows how many fields you have successfully cleared"})),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)(es,{resource:s.resourceManager.get("cells"),showChrome:!0})})),(0,o.jsx)("div",Object.assign({className:"half left"},{children:"Shows how many cells you have cleared without exploding"}))]}),enabled:(e,s)=>s.resourceManager.resources.resets.extra.total>1,highlightSelector:"div.panel#resource-bar",bounds:{top:"12rem",height:"400px"}},105:{title:"Other scores",body:(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",Object.assign({className:"full"},{children:"There are many other scores and resources tracked in the game that you can access via the STATISTICS tab above."}))}),highlightSelector:"div#tab-stats",bounds:{left:"100% - 300px - 2rem",width:"300px",height:"200px"}},110:{title:"Upgrades",body:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:"The UPGRADES tab allows you to upgrade various aspects of the game to make it more interesting."})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"Side note: this is what makes the game progressive  sometimes also called incremenetal."})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"Head over to this tab to check out the different upgrade options available."}))]}),highlightSelector:"div#tab-upgrades",enabled:(e,s)=>s.resourceManager.resources.resets.extra.total>1,nextStep:e=>document.location.href.includes("upgrades")?null:null==e?void 0:e.step},115:{title:"Upgrades",body:(e,s)=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:"You can increase the playing field size and difficulty of the game in Upgrades section. The cost of these upgrades increases over time, but you will eventually gain enough scores to upgrade them all!"})),(0,o.jsx)("div",Object.assign({className:"half left"},{children:"Game Width:"})),(0,o.jsx)("div",Object.assign({className:"half left"},{children:(0,o.jsx)(es,{resource:s.resourceManager.get("cols"),showChrome:!0,infix:"",className:"value-first"})})),(0,o.jsx)("div",Object.assign({className:"half left"},{children:"Game Height:"})),(0,o.jsx)("div",Object.assign({className:"half left"},{children:(0,o.jsx)(es,{resource:s.resourceManager.get("rows"),showChrome:!0,infix:"",className:"value-first"})})),(0,o.jsx)("div",Object.assign({className:"half left"},{children:"Game Difficulty:"})),(0,o.jsx)("div",Object.assign({className:"half left"},{children:(0,o.jsx)(es,{resource:s.resourceManager.get("difficulty"),showChrome:!0,showName:!1,infix:"",className:"value-first"})}))]}),highlightSelector:"div#game-upgrades",bounds:{top:"26rem",height:"200px"}},120:{title:"Quality Upgrades",body:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:"There are many other upgrades in this tab that improve the quality and various aspects of the game. Such as getting hints or revealing neighboring cells on double-tap!"})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"Try them all and make the game more enjoyable."})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"PRO TIP: There is a lot more to the game than these upgrades. Use them for a while and a whole lot of new features may open up as you go!"}))]})},200:{title:"Automation",body:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",Object.assign({className:"full"},{children:"The AUTOMATION tab provides new game mechanics to automatically perform some repetitive actions in the game, such as reseting the board or revealing neighboring squares!"})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"Head over to this tab to check out the different automation options available."}))]}),highlightSelector:"div#tab-auto",enabled:(e,s)=>s.resourceManager.resources.automation.extra.total>=5,nextStep:e=>document.location.href.includes("auto")?null:null==e?void 0:e.step}},vs=Object.assign(Object.assign(Object.assign({},cs),ms),fs);function xs(){const e=We(),s=function(e,s,t){const n={};for(const t in e){const a=t,i=e[t],o=s?s(0,t):i;n[a]=o}return n}(vs,((s,t)=>ls(null!=t?t:0,vs,e))),t=Object.keys(vs).map((e=>parseInt(e))).sort(((e,s)=>e-s));return(0,o.jsx)("div",Object.assign({id:"help"},{children:t.map((e=>function(e){const t=s[e];return t?(0,o.jsx)("div",Object.assign({className:"help"},{children:(0,o.jsxs)("div",Object.assign({className:"panel",id:`help-step-${e}`},{children:[null!=t.title&&""!==t.title&&(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:t.title})),t.body]}))}),`help-panel-${e}`):null}(e)))}))}const bs=JSON.parse('{"active":["Game in progress..."],"inavtive":["There\'s no game yet...?","Hmm... seems like you should reset the board.","Game is inactive :("],"won":["Hooray!!!","Minefield cleared!!","You win!","Game won!","Success!","Amazing job!!!","WIN!","#winning","Sweet!","We\'re all safe again"],"lost":["Oh no! :(","KABOOOM!!!!!","Minefield blown :/","TOTAL CATASTROPHIC LOSS OF EVERYTHING!!!!","Game lost!","You lost this one :(","#fail","What a tragedy...","It wasn\'t your fault!","sadpanda","Rave ruined"],"resetting":["Un-de-mining the playing field","Resetting the board","Ordering new landmines","Contemplating modern warfare","Bulldozing the ground","Wasting time for no reason","Treating shellshock","Rasterizing cell graphics","Writing new reset messages","Pre-computing game features","Calculating total land area","Integrating the area under board","Un-defusing the mines","Calling technical support","Taking the hobbits to Isengard","Reticulating splines","Swapping time and space","Grabbing extra minions","Rupturing the subspace barrier","Creating an anti-time reaction","Converging tachyon pulses","Bypassing control of the matter-antimatter integrator","Adjusting the dilithium crystal converter assembly","Reversing the shield polarity","Disrupting warp fields with an inverse graviton burst","Checking the gravitational constant in your locale","Reconfoobling energymotron","Counting backwards from Infinity","Creating time-loop inversion field","Computing chance of success","Adjusting flux capacitor","Connecting Neurotoxin Storage Tank","Constructing additional pylons","Roping some seaturtles","Locating Jebediah Kerman","Dividing by zero","Cracking military-grade encryption","Simulating traveling salesman","Proving P=NP","Entangling superstrings","Twiddling thumbs","Searching for plot device","Trying to sort in O(n)","Installing dependencies","Ordering 1s and 0s","Mining some bitcoins","Downloading more RAM","Updating to Windows Vista","Deleting System32 folder","Initializing the initializer","Optimizing the optimizer","Updating the updater","Downloading the downloader","Debugging the debugger","Discovering new ways of making you wait","Pushing pixels","Building a wall"]}');function ps(e,s){var t,n;const a=bs[e];return a&&0!==a.length?"string"==typeof a?a:(null!=s||(s=Math.floor(Math.random()*a.length)),null!==(n=null!==(t=a[s])&&void 0!==t?t:a[0])&&void 0!==n?n:e):e}function js({value:e,minValue:s=0,maxValue:t=1,width:n="100px",height:a=n,showPercent:i=!1,className:r,children:l}){const c=(e-s)/(t-s);return(0,o.jsxs)("div",Object.assign({className:`progress-circle ${null!=r?r:""}`,style:{minWidth:n,minHeight:a}},{children:[(0,o.jsxs)("div",Object.assign({className:"children"},{children:[i&&(0,o.jsxs)("span",{children:[Math.floor(100*c),"%"]}),l]})),(0,o.jsxs)("svg",Object.assign({viewBox:"-55 -55 110 110",width:n,height:a},{children:[(0,o.jsx)("circle",{className:"secondary",r:50}),(0,o.jsx)("circle",{className:"primary",r:50,transform:"rotate(-90)",strokeDasharray:Math.ceil(100*Math.PI),strokeDashoffset:Math.ceil(100*Math.PI*(1-c))})]}))]}))}function Ns(){const{context:e,board:s,resources:{resetSpeed:t}}=We(),[n,a]=(0,l.useState)(s.state),[i,r]=(0,l.useState)(!1),[c,u]=(0,l.useState)(""),[d,h]=(0,l.useState)(0);if((0,l.useEffect)((()=>{a(ps(s.state))}),[s,s.state]),0===s.rows||0===s.cols||"inactive"===s.state)return Me(e,!0),null;if("active"===s.state)return null;const m=Oe(e),g=t.extra.remainingTime;return!i&&g>0?(r(!0),h(0)):i&&g<.001&&r(!1),i&&(!c||m-g>=d)&&(u(ps("resetting")),h(d+2)),(0,o.jsx)("div",Object.assign({className:"reset-box"},{children:(0,o.jsxs)("div",Object.assign({className:`panel shadow board-state-${s.state}`},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:n})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:"Game over!"})),(0,o.jsx)("div",Object.assign({className:"full center"},{children:"You may reset the board to receive a brand new game to play:"})),(0,o.jsxs)(js,Object.assign({value:i?(m-g)/m:0,showPercent:i,width:"100%",height:"50%"},{children:[!i&&(0,o.jsx)("input",{type:"button",value:"Reset!",disabled:i,onClick:function(s){null==s||s.preventDefault(),i||(m<.001?Me(e,!1):t.extra.remainingTime<.001&&(t.extra.remainingTime=m,t.onChange=(s,t,n)=>s<.001&&"remainingTime"===t&&"tick"===n&&Me(e,!1)))},id:"button-reset"}),i&&(0,o.jsxs)("span",{children:[c,"..."]})]}))]}))}))}function Os(){const{context:e,board:s,setBoard:t,resources:{rows:n,cols:a,hints:i,resets:r}}=We(),l=s.rows!==n.value()||s.cols!==a.value();return(0,o.jsxs)("div",Object.assign({id:"main",className:"main"},{children:[(0,o.jsx)(is,{}),(0,o.jsx)(ds,{children:(0,o.jsx)(Ns,{})}),(0,o.jsx)(ns,{}),(0,o.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,o.jsx)("div",Object.assign({className:"half"},{children:(0,o.jsx)("button",Object.assign({className:"buy-button",onClick:function(){let n=M(s,0);t(Object.assign({},n)),Se(e,"board",n.state,!1)},id:"button-reset"},{children:(0,o.jsx)(es,{resource:r,value:1,showValue:!1,showChrome:!0,infix:"",suffix:"the Game"})}))})),(0,o.jsx)("div",Object.assign({className:"half"},{children:(0,o.jsx)(ts,{resource:i,overrideCount:0,overrideMaxCount:Ne(e),onPurchase:(n,a,o)=>function(n){(n=A(s,n,0,8,je(e)))>0&&(Ce(i,!1,n),t(Object.assign({},s)))}(o)})})),l&&(0,o.jsxs)("div",Object.assign({className:"left full",id:"reset-info"},{children:["On reset, game board will change to size to",` ${n.value()}x${a.value()}`]}))]}))]}))}const ks=JSON.parse('{"light":"Light Mode","dark":"Dark Mode","jumbo-light":"Jumbo Light","jumbo-dark":"Jumbo Dark","ocean":"Ocean","gold":"Gold","tomato":"Tomato","cyan":"Chocolate","comic":"Cute","murder":"Murder"}');function ws(){var e,s;const t=We(),[n,a]=(0,l.useState)(""),[i,r]=(0,l.useState)(!1),c=(0,Ve.s0)(),u=(0,Ve.TH)(),d=t.settings,h=ks,m=u.search.toLowerCase().includes("debug");function g(e,s){let t=parseInt(s);if(t>=1&&t<=1e3)switch(e){case"tick":d.ticksPerSecond=t;break;case"render":d.framesPerSecond=t;break;case"save":d.saveFrequencySecs=600/t}}function f(e){var s;d.theme=null!==(s=e.target.getAttribute("theme"))&&void 0!==s?s:void 0,V(d.theme)}return(0,o.jsxs)("div",Object.assign({id:"options"},{children:[(0,o.jsxs)("div",Object.assign({className:"panel options",id:"options-theme"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Theme Options"})),(0,o.jsxs)("div",Object.assign({className:"full"},{children:["Current theme is: ",null!==(s=h[null!==(e=d.theme)&&void 0!==e?e:""])&&void 0!==s?s:"default"]})),Object.keys(h).map((e=>(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)("div",Object.assign({className:"themed",id:`theme-${e}`,theme:e},{children:(0,o.jsx)("button",Object.assign({id:`button-theme-${e}`,theme:e,onClick:f},{children:h[e]}))}))}),`theme-${e}`)))]})),(0,o.jsxs)("div",Object.assign({className:"panel options",id:"options-data"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Game Data"})),(0,o.jsx)("div",Object.assign({className:"full"},{children:(0,o.jsx)(es,{epoch:d.lastReset/1e3,value:d.lastUpdate/1e3,display:"time",precision:0,prefix:"You started this game "})})),(0,o.jsx)("div",Object.assign({className:"full"},{children:(0,o.jsx)(es,{epoch:d.lastLoaded/1e3,value:d.lastUpdate/1e3,display:"time",precision:0,prefix:"This session started "})})),(0,o.jsx)("div",Object.assign({className:"full"},{children:(0,o.jsx)(es,{epoch:d.lastSaved/1e3,value:d.lastUpdate/1e3,display:"time",precision:0,prefix:"Game was last saved "})})),(0,o.jsx)("hr",{className:"separator"}),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)("input",{type:"button",value:"Load",onClick:function(){t.load()?(c({pathname:"/",search:u.search}),X.success("Game loaded!")):X.fail("Load failed!")},id:"button-load"})})),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)("input",{type:"button",value:"Save",onClick:function(){t.save(m),X.success("Game saved!")},id:"button-save"})})),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)("input",{type:"button",value:"Load from File",onClick:function(){!function(e,s){const t=document.createElement("input");t.type="file",t.addEventListener("change",(function(s){const t=s.target.files;if(!t||0===t.length||!t[0])return;const n=new FileReader;n.onload=function(s){var t;const n=null===(t=s.target)||void 0===t?void 0:t.result;n&&"string"==typeof n&&e&&e(n)},n.readAsText(t[0])}),!1),t.click()}((e=>{t.loadAs(e)?(c({pathname:"/",search:u.search}),X.success("Game imported!")):X.fail("Import failed!")}))},id:"button-file-load"})})),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)("input",{type:"button",value:"Save to File",onClick:function(){!function(e,s){s instanceof Blob||(s=new Blob([s],{type:"text/plain"}));const t=URL.createObjectURL(s),n=document.createElement("a");n.href=t,n.download=e,n.click(),URL.revokeObjectURL(t)}(`progressive-mine-sweep-${(new Date).toISOString().replace(/\D/g," ").trim().replace(/\D/g,"-")}`,t.saveAs(m)),X.success("Game exported!")},id:"button-file-save"})})),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)("input",{type:"button",value:"Import",onClick:function(){t.loadAs(n)?(c({pathname:"/",search:u.search}),X.success("Game imported!")):X.fail("Import failed!")},id:"button-import"})})),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)("input",{type:"button",value:"Export",onClick:function(){a(t.saveAs(m)),X.success("Game exported!")},id:"button-export"})})),(0,o.jsx)("div",Object.assign({className:"full center",id:"export-text"},{children:(0,o.jsx)("textarea",{value:n,onChange:e=>a(e.target.value)})}))]})),(0,o.jsxs)("div",Object.assign({className:"panel options",id:"options-advanced"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Advanced Settings"})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"If you are having performance issues, increase the time between updates. Faster updating frequncies lead to better game experience but might use a lot of CPU."})),(0,o.jsx)("div",Object.assign({className:"half"},{children:"Updating frequency:"})),(0,o.jsxs)("div",Object.assign({className:"half center"},{children:[Math.floor(1e3/d.ticksPerSecond),"ms"]})),(0,o.jsx)("div",{className:"half"}),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)("input",{type:"range",min:1,max:1e3,value:d.ticksPerSecond,onInput:e=>g("tick",e.target.value),id:"input-freq-tick"})})),(0,o.jsx)("div",{className:"full"}),(0,o.jsx)("div",Object.assign({className:"half"},{children:"Rendering frequency:"})),(0,o.jsxs)("div",Object.assign({className:"half center"},{children:[Math.floor(1e3/d.framesPerSecond),"ms"]})),(0,o.jsx)("div",{className:"half"}),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)("input",{type:"range",min:1,max:60,value:d.framesPerSecond,onInput:e=>g("render",e.target.value),id:"input-freq-render"})})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"Change how often the game is saved in the background. More frequent saving leads to faster backups, but increases CPU and I/O usage"})),(0,o.jsx)("div",Object.assign({className:"half"},{children:"Saving frequency:"})),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)(es,{value:d.saveFrequencySecs,display:"time",precision:0})})),(0,o.jsx)("div",{className:"half"}),(0,o.jsx)("div",Object.assign({className:"half center"},{children:(0,o.jsx)("input",{type:"range",min:1,max:60,value:600/d.saveFrequencySecs,onInput:e=>g("save",e.target.value),id:"input-freq-save"})}))]})),(0,o.jsxs)("div",Object.assign({className:"panel options reset",id:"options-reset"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar warning"},{children:"Game Reset"})),(0,o.jsx)("div",Object.assign({className:"full"},{children:"WARNING: this will completely reset your game and delete all saved progress and setting. Only use this if you want to restart the game from beginning, or if something in the settings is so messed up that the game is now unplayable."})),(0,o.jsx)("div",Object.assign({className:"full"},{children:(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"checkbox",checked:i,onChange:()=>r(!i),id:"acknowledge-box"}),"I understand what this means and still want to reset the game"]})})),(0,o.jsx)("div",Object.assign({className:"full right"},{children:(0,o.jsx)("input",{type:"button",value:"Reset everything",disabled:!i,onClick:function(){i&&(confirm("Are you sure you want to reset? This cannot be undone.")?(t.reset(),c({pathname:"/",search:u.search})):r(!1))},id:"button-wipeall"})}))]})),m&&(0,o.jsxs)("div",Object.assign({className:"panel options debug",id:"options-debug"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Debug Context"})),(0,o.jsx)("div",Object.assign({className:"half"},{children:"Settings:"})),(0,o.jsx)("div",Object.assign({className:"full",id:"debug-settings"},{children:JSON.stringify(d,null,2)})),(0,o.jsx)("hr",{className:"separator"}),(0,o.jsx)("div",Object.assign({className:"half"},{children:"Resources:"})),(0,o.jsx)("div",Object.assign({className:"full",id:"debug-resources"},{children:JSON.stringify(t.resourceManager,((e,s)=>ys.includes(e)?void 0:s),2)})),(0,o.jsx)("hr",{className:"separator"}),(0,o.jsx)("div",Object.assign({className:"half"},{children:"Board:"})),(0,o.jsx)("div",Object.assign({className:"full",id:"debug-board"},{children:JSON.stringify(t.board,null,2)}))]}))]}))}const ys=["context","manager"];function Cs(){const{resource:e}=We(),s=(0,Ve.TH)().search.toLowerCase().includes("debug");function t(t){const n=e(t);return(0,o.jsx)(es,{resource:n,length:"percentage"===n.display?"tiny":"compact",precision:"percentage"===n.display?1:void 0,showMaxValue:!0,showRate:!0,showExtras:s,showZeroRates:!0,showRateColors:!0,placeholder:""})}return(0,o.jsxs)("div",Object.assign({id:"stats"},{children:[(0,o.jsxs)("div",Object.assign({className:"panel stats",id:"stats-time"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Time Info"})),t("totalTime"),t("activeTime"),t("offlineTime")]})),(0,o.jsxs)("div",Object.assign({className:"panel stats",id:"stats-board"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Board Info"})),t("rows"),t("cols"),t("difficulty"),t("resetSpeed"),t("hintQuality")]})),(0,o.jsxs)("div",Object.assign({className:"panel stats",id:"stats-game"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Game Info"})),t("wins"),t("losses"),t("resets"),t("automation")]})),(0,o.jsxs)("div",Object.assign({className:"panel stats",id:"stats-cell"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Cell Info"})),t("cells"),t("flags"),t("hints"),t("explosions"),t("clicks"),t("revealNeighbors")]}))]}))}function Ss(){const{context:e,settings:s}=We(),t=ls(s.tutorialStep,vs,e);if((0,l.useEffect)((()=>{var e;const s=null==t?void 0:t.onMount,n=null==t?void 0:t.onUnmount;let a;try{a=document.querySelectorAll(null!==(e=null==t?void 0:t.highlightSelector)&&void 0!==e?e:"")}catch(e){}return(null==t?void 0:t.enabled)&&(null==a||a.forEach((e=>e.classList.add("highlight"))),s&&s()),()=>{null==a||a.forEach((e=>e.classList.remove("highlight"))),n&&n()}}),[null==t?void 0:t.step,null==t?void 0:t.enabled]),!t||!t.enabled||t.step!==s.tutorialStep||t.step<0)return null;function n(e){return null!=e&&null!=e&&e>=0&&e!==s.tutorialStep&&e!==(null==t?void 0:t.step)}function a(e,t){t.preventDefault(),n(e)&&(s.tutorialStep=e)}function i(e){return`max(5%, 1em, min(90%, calc(100% - 2em), calc(${e})))`}const r={left:i(t.bounds.left),bottom:i("100vh - "+t.bounds.top+" - "+t.bounds.height),width:i(t.bounds.width),minHeight:i(t.bounds.height),maxHeight:i("100%")},c=(0,o.jsx)("div",Object.assign({className:"tutorial",style:r,id:`tutorial-step-${t.step}`},{children:(0,o.jsxs)("div",Object.assign({className:"panel shadow",style:{minHeight:t.bounds.height}},{children:[null!=t.title&&""!==t.title&&(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:t.title})),t.body,n(t.prevStep)&&(0,o.jsx)("div",Object.assign({className:"prev"},{children:(0,o.jsx)("a",Object.assign({href:"",onClick:R(a,t.prevStep)},{children:t.prevStepTitle}))})),n(t.nextStep)&&(0,o.jsx)("div",Object.assign({className:"next"},{children:(0,o.jsx)("a",Object.assign({href:"",onClick:R(a,t.nextStep)},{children:t.nextStepTitle}))})),n(t.skipToStep)&&(0,o.jsx)("div",Object.assign({className:"skip"},{children:(0,o.jsx)("a",Object.assign({href:"",onClick:R(a,t.skipToStep)},{children:t.skipToStepTitle}))}))]}))}));return t.greyOut?(0,o.jsx)("div",Object.assign({className:"greyout"},{children:c})):c}function Ms(){var e,s,t;const{context:n,resources:{rows:a,cols:i,difficulty:r,hintQuality:l,hintsCount:c,resetSpeed:u,revealNeighbors:d}}=We();return(0,o.jsxs)("div",Object.assign({id:"upgrades"},{children:[(0,o.jsx)(is,{}),(0,o.jsx)(ns,{showTapMode:!1}),(0,o.jsxs)("div",Object.assign({className:"game-controls panel",id:"game-upgrades"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Game Upgrades"})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:"Game Width:"})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:(0,o.jsx)(es,{resource:i,showChrome:!0,infix:"",className:"value-first"})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:i,prefix:"Expand",overrideMaxCount:50})})),(0,o.jsx)("div",{className:"half"}),(0,o.jsx)("div",Object.assign({className:"right half"},{children:i.count>3&&(0,o.jsx)(ts,{resource:i,prefix:"Shrink",mode:"sell"})})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:"Game Height:"})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:(0,o.jsx)(es,{resource:a,showChrome:!0,infix:"",className:"value-first"})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:a,prefix:"Expand",overrideMaxCount:50})})),(0,o.jsx)("div",{className:"half"}),(0,o.jsx)("div",Object.assign({className:"right half"},{children:a.count>3&&(0,o.jsx)(ts,{resource:a,prefix:"Shrink",mode:"sell"})})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:"Game Difficulty:"})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:(0,o.jsx)(es,{resource:r,showChrome:!0,showName:!1,infix:"",className:"value-first"})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:r,prefix:"Increase"})})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:(0,o.jsx)("span",Object.assign({className:"computed"},{children:"Score Multiplier:"}))})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:(0,o.jsx)(es,{value:100*we(n),display:"percentage",showChrome:!0,className:"computed"})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:r.count>1&&(0,o.jsx)(ts,{resource:r,prefix:"Decrease",mode:"sell"})}))]})),(0,o.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,o.jsx)("div",Object.assign({className:"title-bar"},{children:"Quality Upgrades"})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:"Reset Speed:"})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:(0,o.jsx)(es,{resource:u,showChrome:!0,showName:!1,infix:"",className:"value-first"})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:u,prefix:u.count<(null!==(e=u.maxCount)&&void 0!==e?e:1/0)?"Speed up":"Max Speed!"})})),(0,o.jsx)("hr",{className:"separator"}),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:"Hint Quality:"})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:(0,o.jsx)(es,{resource:l,showChrome:!0,showName:!1,infix:"",className:"value-first"})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:l,prefix:"Improve"})})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:"Number of hints on purchase:"})),(0,o.jsx)("div",Object.assign({className:"quarter"},{children:(0,o.jsx)(es,{resource:c,showChrome:!0,infix:"",className:"value-first"})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:c,prefix:c.count<(null!==(s=c.maxCount)&&void 0!==s?s:1/0)?"Improve":"Max Quality!"})})),(0,o.jsx)("hr",{className:"separator"}),(0,o.jsx)("div",Object.assign({className:"half"},{children:(0,o.jsx)(es,{resource:d,showChrome:!0,infix:"",placeholder:"Nothing happens",suffix:"on double-tap",className:"value-first"})})),(0,o.jsx)("div",Object.assign({className:"right half"},{children:(0,o.jsx)(ts,{resource:d,allowUnlocking:!0,prefix:d.unlocked?d.count<(null!==(t=d.maxCount)&&void 0!==t?t:1/0)?"Additional":"Maxed out!":"Unlock"})})),(0,o.jsxs)("div",Object.assign({className:"full computed"},{children:["Reveals random (hidden) neighbors of the square being tapped on.",(0,o.jsx)("br",{}),"CAUTION: it might trigger a mine if they have not been properly flagged!"]}))]}))]}))}function Ts(e){if(null!=e.condition&&!e.condition)return null;const s=(0,Ve.TH)();let t=e.to.replace(/\W/g,"");return""===t&&(t="main"),(0,o.jsx)("div",Object.assign({id:`tab-${t}`},{children:(0,o.jsx)(Ke.OL,Object.assign({className:({isActive:e})=>e?"active":"",to:{pathname:e.to,search:s.search}},{children:e.children}))}))}function As(){const{context:e,settings:s,resourceManager:t,save:n,resources:{automation:a,resets:i}}=We(),[r,c]=(0,l.useState)(),[u,d]=(0,l.useState)(0);function h(){const a=e.board.state;t.update(void 0,"tick").includes(!0)&&(e.board=M(e.board,e.settings.maxErrors),e.board=Object.assign({},e.board),e.board.state!==a&&Se(e,"board",e.board.state,!e.board.hadUserAction)),s.lastUpdate-s.lastSaved>=1e3*s.saveFrequencySecs&&s.lastUpdate-s.lastLoaded>=1e3*s.saveFrequencySecs&&(n(),X.info("Game saved!")),d((e=>s.lastUpdate-e>=1e3/s.framesPerSecond?s.lastUpdate:e))}return(0,l.useEffect)((function(){return r&&clearInterval(r),c(setInterval(h,1e3/s.ticksPerSecond)),V(s.theme),()=>{r&&(clearInterval(r),c(void 0))}}),[s,s.ticksPerSecond,s.theme]),(0,o.jsxs)(Ke.UT,{children:[(0,o.jsxs)("nav",Object.assign({className:"navbar"},{children:[(0,o.jsxs)("div",Object.assign({className:"left"},{children:[(0,o.jsx)(Ts,Object.assign({to:"/"},{children:"Minefield"})),(0,o.jsx)(Ts,Object.assign({to:"/upgrades",condition:i.extra.total>1},{children:"Upgrades"})),(0,o.jsx)(Ts,Object.assign({to:"/auto",condition:a.extra.total>=5},{children:"Automation"}))]})),(0,o.jsx)("div",{className:"spacer"}),(0,o.jsxs)("div",Object.assign({className:"right"},{children:[(0,o.jsx)(Ts,Object.assign({to:"/achievements"},{children:"Achievements"})),(0,o.jsx)(Ts,Object.assign({to:"/stats"},{children:"Statistics"})),(0,o.jsx)(Ts,Object.assign({to:"/help"},{children:"Help"})),(0,o.jsx)(Ts,Object.assign({to:"/options"},{children:"Settings"}))]}))]})),(0,o.jsx)(Ss,{}),(0,o.jsxs)(Ve.Z5,{children:[(0,o.jsx)(Ve.AW,{path:"/",element:(0,o.jsx)(Os,{})}),(0,o.jsx)(Ve.AW,{path:"/upgrades",element:(0,o.jsx)(Ms,{})}),(0,o.jsx)(Ve.AW,{path:"/auto",element:(0,o.jsx)(rs,{})}),(0,o.jsx)(Ve.AW,{path:"/achievements",element:(0,o.jsx)(ss,{})}),(0,o.jsx)(Ve.AW,{path:"/stats",element:(0,o.jsx)(Cs,{})}),(0,o.jsx)(Ve.AW,{path:"/help",element:(0,o.jsx)(xs,{})}),(0,o.jsx)(Ve.AW,{path:"/options",element:(0,o.jsx)(ws,{})})]})]})}function Rs({frames:e=12,duration:s=1}){return(0,o.jsx)("svg",Object.assign({className:"spinner",width:"128px",height:"128px",viewBox:"0 0 100 100"},{children:Array.from(Array(e).keys()).map((t=>(0,o.jsx)("g",Object.assign({transform:`rotate(${360*t/e} 50 50)`},{children:(0,o.jsx)("rect",Object.assign({x:"47",y:"24",rx:"9.4",ry:"4.8",width:"6",height:"12",fill:"#32a0da"},{children:(0,o.jsx)("animate",{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:`${s}s`,begin:s/e*(t-e)+"s",repeatCount:"indefinite"})}))}),`g-${t}`)))}))}function Us(){const{context:e,load:s}=We(),[t,n]=(0,l.useState)(!1),[a,i]=(0,l.useState)(!1);function r(){try{e.init(),s(),n(!0)}catch(e){throw i(!0),e}}return(0,l.useEffect)((()=>{t||a||setTimeout(r,1)}),[t,a]),t?(0,o.jsx)(As,{}):a?(0,o.jsx)(Je,{}):(0,o.jsx)(Rs,{})}window.addEventListener("load",(()=>(0,r.s)(K("app")).render((0,o.jsx)(Le,{children:(0,o.jsx)(Us,{})}))),!1)},730:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function compileInlineFunction(body,thisBind,args=[],globals={},reserved=[],forceArgs=!1,forceGlobals=!1){let fnBody=body.replace(/\b\w+\b/gim,(function(e){return!e||"this"===e||reserved.includes(e)?e:args.includes(e)?(forceArgs=!0,"___param_"+e):globals[e]?(forceGlobals=!0,"___globals."+e):e})),fn;forceArgs&&(fnBody=`(function (${args.map((e=>"___param_"+e)).join(",")}) { return ${fnBody}; })`),forceGlobals&&(fnBody=`(function (___globals) { return (${fnBody}); })`);try{fn=eval(fnBody)}catch(e){fn=null}return thisBind&&"function"==typeof fn&&(fn=fn.bind(thisBind)),forceGlobals&&"function"==typeof fn&&(fn=fn(globals),thisBind&&"function"==typeof fn&&(fn=fn.bind(thisBind))),"function"!=typeof fn?forceArgs?()=>fn:compileInlineFunction(body,thisBind,args,globals,reserved,!0,forceGlobals):fn}__webpack_require__.d(__webpack_exports__,{K:()=>compileInlineFunction})}},e=>{e.O(0,[216,840],(()=>(116,e(e.s=116)))),e.O()}]);