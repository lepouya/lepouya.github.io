"use strict";(self.webpackChunkprogressive_mine_sweep=self.webpackChunkprogressive_mine_sweep||[]).push([[873],{285:(e,s,t)=>{t.r(s);var n=t(893),a=t(745),r=t(294);function i({frames:e=12,duration:s=1}){return(0,n.jsx)("svg",Object.assign({className:"spinner",width:"128px",height:"128px",viewBox:"0 0 100 100"},{children:Array.from(Array(e).keys()).map((t=>(0,n.jsx)("g",Object.assign({transform:`rotate(${360*t/e} 50 50)`},{children:(0,n.jsx)("rect",Object.assign({x:"47",y:"24",rx:"9.4",ry:"4.8",width:"6",height:"12",fill:"#32a0da"},{children:(0,n.jsx)("animate",{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:`${s}s`,begin:s/e*(t-e)+"s",repeatCount:"indefinite"})}))}),`g-${t}`)))}))}var l=t(711),c=t(974);function o({board:e}){return 100*(e.cellCounts.revealed+e.cellCounts.flagged)/(e.rows*e.cols)}function u({board:e}){return e.rows*e.cols-e.numMines-e.cellCounts.revealed}function d({resourceManager:{resources:{difficulty:e}}}){return(e.value()+10)/25}function h(e,s,t,n){const a=d(e),r=m[s+":"+t];let i=e.resourceManager.resources[null!=r?r:""];if(r&&i)i.count+=1*a,n?i.extra.auto+=1:i.extra.manual+=1;else switch(s+":"+t){case"cell:unflagged":i=e.resourceManager.resources.flags,i.count-=1*a,i.extra.unflags+=1;break;case"cell:unrevealed":i=e.resourceManager.resources.cells,i.count-=1*a,i.extra.hidden+=1}}const m={"board:active":"resets","board:lost":"losses","board:won":"wins","cell:blown":"explosions","cell:hinted":"hints","cell:flagged":"flags","cell:revealed":"cells"},g={"":{min:1,max:1,inc:1},x1:{min:1,max:1,inc:1},x5:{min:1,max:5,inc:5},x10:{min:1,max:10,inc:10},"+5":{min:5,max:5,inc:1},"+10":{min:10,max:10,inc:1},max:{min:1,max:100,inc:1}};function f(e){const s=e.startsWith(".."),t=(s?e:Math.random().toString(36)).substring(2,10);return(s?"":".."+t)+(s?e.slice(10):e).split("").map((e=>e.charCodeAt(0))).map(((e,s)=>String.fromCharCode(e^t.charCodeAt(s%8)))).join("")}function x(e){const s=[],t=e._save_properties;return null!=t&&"object"==typeof t&&Array.isArray(t)&&s.push(...t),s}function p(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map((e=>p(e)));if(0===Object.keys(e).length)return null;const s={},t=x(e);let n;for(n in e)if(!n.startsWith("_")&&null!=e[n]&&(0===t.length||t.includes(n))){const t=e[n];if("object"==typeof t){const e=p(t);null!=e&&(s[n.toString()]=e)}else"function"!=typeof t&&(s[n.toString()]=t)}return s}function v(e,s){const t=x(e);var n;return t.push(...s),Object.assign(e,{_save_properties:(n=t,n.filter(((e,s,t)=>t.indexOf(e)===s)))}),e}function j(e,...s){return[e,...s].flat().reduce(((e,s)=>{const t=e.find((e=>{var t,n;return(e.resource===s.resource||("string"==typeof e.resource?e.resource:e.resource.name)===("string"==typeof s.resource?s.resource:s.resource.name))&&(null!==(t=e.kind)&&void 0!==t?t:"")===(null!==(n=s.kind)&&void 0!==n?n:"")}));return t?(t.count+=s.count,e):[...e,s]}),[]).filter((({count:e})=>0!==e))}function b(e,s){return e.map((({resource:e,count:t,kind:n})=>({resource:e,count:s*t,kind:n})))}function y(e,s){return j(s.filter((({resource:s})=>{var t;return(null===(t=e.unlocked)||void 0===t||t)&&e.name===("string"==typeof s?s:s.name)})).map((({count:s,kind:t})=>{var n;const a=t?null!==(n=e.extra[t])&&void 0!==n?n:0:e.count;let r=Math.max(0,a+s);return!t&&e.maxCount&&r>e.maxCount&&(r=e.maxCount),t?e.extra[t]=r:e.count=r,[{resource:e,count:r-a,kind:t}]})).flat())}function w(e,s=0,t=1){return isNaN(e)||e<s?s:e>t?t:e}function O(e,s,t){e[s]&&t&&"object"==typeof t?e[s]=Object.assign(Object.assign({},e[s]),t):null!=t&&(e[s]=t)}const N={ticksPerSecond:60,framesPerSecond:10,saveFrequencySecs:60,rateUpdateSecs:1,minResourceUpdateSecs:.001,maxResourceUpdateSecs:86400,maxResourceTickSecs:1,lastReset:Date.now(),lastUpdate:Date.now(),lastSaved:0,lastLoaded:Date.now(),maxErrors:1,timeDilation:1,tapMode:"reveal",buyAmount:"x1"};function k(e,s){switch(s){case"flag":"hidden"===e.state||"hinted"===e.state?e.state="flagged":"flagged"===e.state&&(e.state="hidden");break;case"reveal":"hidden"!==e.state&&"hinted"!==e.state||("clear"===e.contents?e.state="revealed":"mine"===e.contents&&(e.state="blown"));break;case"hint":"hidden"===e.state&&(e.state="hinted");break;case"hide":"flagged"!==e.state&&"revealed"!==e.state||(e.state="hidden")}return e}const C={hidden:0,hinted:0,flagged:0,revealed:0,blown:0},M={rows:0,cols:0,cells:[],numMines:0,state:"inactive",cellCounts:Object.assign({},C)};function S(e,s=1){return e.cellCounts=Object.assign({},C),e.numMines=0,e.cells.forEach((s=>s.forEach((s=>{e.cellCounts[s.state]++,e.numMines+="mine"===s.contents?1:0,v(s,["contents","state"])})))),"lost"===e.state||e.cellCounts.blown>=s?(e.state="lost",e.cells.forEach((s=>s.forEach((s=>{e.cellCounts[s.state]--,k(s,"reveal"),e.cellCounts[s.state]++}))))):e.cols*e.rows==0?e.state="inactive":e.cellCounts.blown+e.cellCounts.flagged===e.numMines&&0===e.cellCounts.hidden&&e.cellCounts.revealed===e.cols*e.rows-e.numMines?e.state="won":e.state="active",function(e){e.cells.forEach((e=>e.forEach((e=>e.neighbors=0))));for(let s=0;s<e.rows;s++)for(let t=0;t<e.cols;t++)if(e.cells[s][t].row=s,e.cells[s][t].col=t,"mine"===e.cells[s][t].contents)for(let n=s-1;n<=s+1;n++)for(let a=t-1;a<=t+1;a++)n>=0&&a>=0&&n<e.rows&&a<e.cols&&(n!==s||a!==t)&&e.cells[n][a].neighbors++}(e),v(e,["rows","cols","cells"]),e}function q(){const e={resources:{},upsert:s=>function(e,s){var t,n;const a="string"==typeof s?s:null!==(t=s.name)&&void 0!==t?t:"",r=null!==(n=e.resources[a])&&void 0!==n?n:function(e){const s={name:e,count:0,extra:{},value:e=>{var t;return e?null!==(t=s.extra[e])&&void 0!==t?t:0:s.count},cost:()=>[],rate:{value:0}};return v(s,["name","unlocked","count","maxCount","extra"]),s}(a);if("string"!=typeof s){let e;for(e in s)O(r,e,s[e])}return r.buy=(s=1,t="partial",n="")=>T(e,[{resource:r,count:s,kind:n}],t),r.add=(e,s)=>r.buy(e,"free",s),r.canBuy=(e,s)=>r.buy(e,"dry-partial",s),r.name&&(e.resources[r.name]=r),r}(e,s),get:s=>R(e,s),purchase:(s,t)=>T(e,s,t),canAfford:s=>E(e,s),update:(s,t,n)=>function(e,s,t,n){var a;const{rateUpdateSecs:r=1,minResourceUpdateSecs:i=.001,maxResourceUpdateSecs:l=86400,maxResourceTickSecs:c=1,timeDilation:o=1}=t;s||(s=Date.now());let u=w((s-(null!==(a=t.lastUpdate)&&void 0!==a?a:s))/1e3,0,l);if(!(u<i)){for(t.lastUpdate=s;u>0;){const s=w(u,i,c);Object.values(e.resources).forEach((e=>e.tick&&e.tick(s/o,n))),u-=s}Object.values(e.resources).forEach((e=>{var s,n;const a=((null!==(s=t.lastUpdate)&&void 0!==s?s:0)-(null!==(n=e.rate.lastCheck)&&void 0!==n?n:0))/1e3;a>=r&&(void 0!==e.rate.lastCount?e.rate.value=(e.count-e.rate.lastCount)/a:e.rate.value=0),(void 0===e.rate.lastCheck||void 0===e.rate.lastCount||a>=r)&&(e.rate.lastCheck=t.lastUpdate,e.rate.lastCount=e.count)}))}}(e,s,null!=t?t:{},null!=n?n:"unknown")};return e}function R(e,s){return e.resources["string"==typeof s?s:s.name]}function T(e,s,t){const n=A(e,s).map((s=>{const n=function(e,s,t,n,a){var r,i;if(!s||0===t||null!==(r=s.unlocked)&&void 0!==r&&!r)return{count:0,gain:[],cost:[]};const l=n?null!==(i=s.extra[n])&&void 0!==i?i:0:s.count;let c=Math.max(0,l+t);if(!n&&s.maxCount&&c>s.maxCount&&(c=s.maxCount),"free"===a)return{count:c-l,gain:[{resource:s,count:c-l,kind:n}],cost:[]};let o=[],u=o,d=0;for(let t=l;t<c&&("partial"!==a&&"dry-partial"!==a||(u=j(u,A(e,s.cost(t+1,n))),E(e,u)));t++)d++,o=j(o,A(e,s.cost(t+1,n)));const h=[{resource:s,count:d,kind:n}];return"dry-full"!==a&&!E(e,o)||"full"===a&&l+d!==c?{count:0,gain:[],cost:[]}:{count:d,gain:h,cost:o}}(e,s.resource,s.count,s.kind,null!=t?t:"partial");if("dry-partial"===t||"dry-full"===t)return n;{const t=y(s.resource,n.gain),c=(a=t,r=s.resource.name,i=s.kind,null!==(l=a.filter((({resource:e,kind:s})=>(null!=i?i:"")===(null!=s?s:"")&&r===("string"==typeof e?e:e.name))).map((({count:e})=>e)).pop())&&void 0!==l?l:0),o=n.cost.map((({resource:s,count:t,kind:n})=>y(R(e,s),[{resource:s,count:-t,kind:n}]))).flat();return{count:c,gain:t,cost:o}}var a,r,i,l}));return{count:n.reduce(((e,s)=>e+s.count),0),gain:j(n.map((e=>e.gain)).flat()),cost:j(n.map((e=>e.cost)).flat())}}function A(e,s){return s.map((({resource:s,count:t,kind:n})=>({resource:R(e,s),count:t,kind:null!=n?n:""}))).filter((({resource:e,count:s})=>e&&s))}function E(e,s){return A(e,j(s)).every((e=>{return s=e.resource,t=[e],(null===(n=s.unlocked)||void 0===n||n)&&0===(i=s,a=[{resource:i,count:i.count},...Object.entries(i.extra).map((([e,s])=>({resource:i,count:s,kind:e})))].filter((({count:e})=>0!==e)),r=t.filter((({resource:e})=>s.name===("string"==typeof e?e:e.name))),j(a,b(r,-1))).filter((({count:e})=>e<0)).length;var s,t,n,a,r,i}))}function I(e,{kind:s="",source:t="",min:n=0,max:a=1/0,direction:r=-1,combineWithCurrentTick:i=!1,assignToResourceTick:l=!0}={},c){const o=e.tick,u=(i,l)=>{var o;if(!t||l===t){let t=null!==(o=s?e.extra[s]:e.count)&&void 0!==o?o:0;(t>n||r>0)&&(t<a||r<0)&&(t=w(t+r*i,n,a),s?e.extra[s]=t:e.count=t,!c||t!==n&&t!==a||c(e,t,s,l))}},d=o&&i?(e,s)=>{o(e,s),u(e,s)}:u;return l&&(e.tick=d),d}const P=[JSON.parse('[{"name":"totalTime","icon":"clock","display":"time"},{"name":"activeTime","icon":"alarm","display":"time","extra":{"current":0,"max":0}},{"name":"offlineTime","icon":"user-off","display":"time","extra":{"current":0,"max":0}}]'),JSON.parse('[{"name":"rows","singularName":"row","icon":"arrows-vertical","count":3},{"name":"cols","singularName":"col","icon":"arrows-horizontal","count":3},{"name":"difficulty","icon":"adjustments-horizontal","display":"percentage","count":15},{"name":"hintQuality","icon":"bulb","display":"percentage","count":0},{"name":"resetSpeed","icon":"refresh-alert","display":"percentage","count":0,"extra":{"remainingTime":0}}]'),JSON.parse('[{"name":"wins","singularName":"win","icon":"darkgreen square-check","extra":{"auto":0,"manual":0}},{"name":"losses","singularName":"lose","icon":"darkred square-x","extra":{"auto":0,"manual":0}},{"name":"resets","singularName":"reset","icon":"refresh","extra":{"auto":0,"manual":0}}]'),JSON.parse('[{"name":"clicks","singularName":"click","icon":"hand-click","extra":{"left":0,"right":0,"useless":0}},{"name":"cells","singularName":"cell","icon":"darkgreen square","extra":{"auto":0,"manual":0,"hidden":0}},{"name":"hints","singularName":"hint","icon":"green eye","extra":{"auto":0,"manual":0}},{"name":"flags","singularName":"flag","icon":"darkblue flag-2","extra":{"auto":0,"manual":0,"unflags":0}},{"name":"explosions","singularName":"explosion","icon":"red alert-triangle","extra":{"auto":0,"manual":0}}]')];function U(e){const s=null!=e?e:q();return P.flat().forEach((e=>s.upsert(e))),$(s.get("rows"),(e=>w(e,3,100))),$(s.get("cols"),(e=>w(e,3,100))),$(s.get("difficulty"),(e=>w(e,0,100))),$(s.get("hintQuality"),(e=>w(e,0,100))),$(s.get("resetSpeed"),((e,s)=>s?e:w(e,0,100))),s.get("rows").cost=e=>[{resource:"cells",count:Math.pow(e,2)}],s.get("cols").cost=e=>[{resource:"cells",count:Math.pow(e,2)}],s.get("hints").cost=()=>[{resource:"wins",count:1}],s.get("difficulty").cost=e=>[{resource:"flags",count:Math.floor(e/2)}],s.get("hintQuality").cost=e=>[{resource:"wins",count:1},{resource:"cells",count:e-1}],s.get("resetSpeed").cost=e=>[{resource:"resets",count:1},{resource:"cells",count:e}],I(s.get("resetSpeed"),{kind:"remainingTime"}),I(s.get("totalTime"),{direction:1}),D(s.get("activeTime"),"tick","load"),D(s.get("offlineTime"),"load","tick"),s}function $(e,s){e.value=t=>{var n;return s(null!==(n=t?e.extra[t]:e.count)&&void 0!==n?n:0,t)}}function D(e,s,t){e.tick=(n,a)=>{a===s?(e.count+=n,e.extra.current+=n,e.extra.current>e.extra.max&&(e.extra.max=e.extra.current)):a===t&&(e.extra.current=0)}}function L(){const e=window.localStorage,s="__storage_test__";if(!e)return!1;try{return e.setItem(s,s),e.removeItem(s),!0}catch(s){return s instanceof DOMException&&0!==e.length&&(22===s.code||1014===s.code||"QuotaExceededError"===s.name||"NS_ERROR_DOM_QUOTA_REACHED"===s.name)}}function z(){return{settings:Object.assign(Object.assign({},N),{lastReset:Date.now(),lastUpdate:Date.now(),lastLoaded:Date.now()}),board:Object.assign({},M),resourceManager:U(q())}}const F="Context";function G(e,s){const t=Object.assign({},e),n=!!s&&function(e,s){let t=null;if(!t)try{t=JSON.parse(f(window.atob(s)))}catch(e){t=null}if(!t)try{t=JSON.parse(window.atob(s))}catch(e){t=null}if(!t)try{t=JSON.parse(s)}catch(e){t=null}return!!t&&function(e,s){if(!s||"object"!=typeof s||"object"!=typeof e)return!1;let t;for(t in e)typeof s[t]==typeof e[t]&&(e[t]=s[t]);return!0}(e,t)}(e,s);if(n)e.settings=Object.assign(Object.assign(Object.assign({},t.settings),e.settings),{lastLoaded:Date.now()}),e.board=S(Object.assign(Object.assign({},t.board),e.board)),e.resourceManager=function(e,s){var t;let n;for(n in s)"resources"===n?Object.values(null!==(t=s[n])&&void 0!==t?t:{}).forEach((s=>e.upsert(s))):O(e,n,s[n]);return e}(t.resourceManager,e.resourceManager),e.resourceManager.update(e.settings.lastLoaded,e.settings,"load");else{let s;for(s in t)O(e,s,t[s])}return n}function _(e,s){return e.settings.lastSaved=Date.now(),function(e,s=!1){return s?JSON.stringify(p(e),null,2):window.btoa(f(JSON.stringify(p(e))))}(e,s)}const B=(0,r.createContext)(z()),W=e=>(0,n.jsx)(B.Provider,Object.assign({value:z()},{children:e.children}));function H(){return e=(0,r.useContext)(B),Object.assign(Object.assign(Object.assign({context:e},e),e.resourceManager),{setBoard:s=>e.board=s,resource:s=>e.resourceManager.get(s),load:()=>{return G(e,(s=F,L()?window.localStorage.getItem(s):null));var s},loadAs:s=>G(e,s),save:s=>{return t=F,n=_(e,s),void(L()&&n&&window.localStorage.setItem(t,n));var t,n},saveAs:s=>_(e,s),reset:()=>function(e){var s;s=F,L()&&window.localStorage.removeItem(s);const t=z();let n;for(n in t)O(e,n,t[n])}(e)});var e}function J(e){var s,t;const n="string"==typeof e?{id:e}:e;let a,r=document.getElementById(null!==(s=n.id)&&void 0!==s?s:"");for(a in r||(r=document.createElement(null!==(t=n.tagName)&&void 0!==t?t:"div"),document.body.appendChild(r)),n)O(r,a,n[a]);return r}const V=JSON.parse('{"hidden":"transparent question-mark","hinted":"green eye","flagged":"darkblue flag-2","blown":"red alert-triangle","revealed":["darkgreen square-dot","darkgreen square-1","darkgreen square-2","darkgreen square-3","darkgreen square-4","darkgreen square-5","darkgreen square-6","darkgreen square-7","darkgreen square-8","darkgreen square"]}');var Q=t(909);function Y(e){var s,t,a,r,i,l,c,o,u,d;let h=e.icon;if(!h){const n=V[null!==(a=null!==(t=null===(s=e.cell)||void 0===s?void 0:s.state)&&void 0!==t?t:e.state)&&void 0!==a?a:"hidden"];if(n instanceof Array)h=n[null!==(l=null!==(i=null===(r=e.cell)||void 0===r?void 0:r.neighbors)&&void 0!==i?i:e.neighbors)&&void 0!==l?l:0];else{if(null==n)return null;h=n}}const m=h.split(/\s+/).filter((e=>e.trim().length>0));h=null!==(c=m.pop())&&void 0!==c?c:h;const g=null!==(o=m.pop())&&void 0!==o?o:e.color,f=null!==(u=e.size)&&void 0!==u?u:24,x=null!==(d=e.stroke)&&void 0!==d?d:2;return(0,n.jsx)("svg",Object.assign({className:`icon icon-${h}`,width:f,height:f,color:g,strokeWidth:x},{children:(0,n.jsx)("use",{xlinkHref:`#tabler-${h}`})}))}function Z(e,s="expanded",t=!1,n=("expanded"===s?", ":":"),a="",r="",i=""){if(r.length>0&&e<0)return r;if(a.length>0&&0===e)return a;let l=Math.floor(e/1e3),c=Math.floor(e-1e3*l),o=Math.floor(l/60);l-=60*o;let u=Math.floor(o/60);o-=60*u;let d=Math.floor(u/24);u-=24*d;let h=Math.floor(d/365);if(d-=365*h,t||(c=0),a.length>0&&d+u+o+l+c===0)return a;let m=[];return m="expanded"!==s?[h>0?h.toFixed(0):"",d>0?d.toFixed(0):"",u>0||"compact"===s?u.toFixed(0):"",o>0||"compact"===s?o.toFixed(0):"",(l+c/1e3).toFixed(!t||"tiny"===s&&0===c?0:3)].map((e=>"compact"!==s||1!==e.length&&1!==e.indexOf(".")?e:"0"+e)):[[h,"year"],[d,"day"],[u,"hour"],[o,"minute"],[l,"second",h+d+u+o===0,c]].map((([e,s,t=!1,n=0])=>e>0||n>0||t&&0===e?e.toString()+(n>0?"."+n.toString():"")+" "+s+(1===e?"":"s"):"")),m.filter((e=>e.length>0)).join(n)+(i.length>0?" "+i:"")}window.addEventListener("load",(()=>J("icon").innerHTML=Q),!1);const K={floor:Math.floor,round:Math.round,ceil:Math.ceil};function X(e,s,t){const n=Math.pow(10,s);return K[t](e*n)/n}const ee={tiny:4,compact:9,expanded:21},se={number:1,percentage:1,time:1e3};function te(e){var s,t,a,r,i,{value:l,epoch:c,name:o,resource:u={name:o,count:l},kind:d,display:h=(null!==(s=u.display)&&void 0!==s?s:"number"),length:m="expanded",rounding:g=("number"===h?"floor":"round"),showLocked:f=!1,showIcon:x=!0,showName:p=!0,showValue:v=!0,showMaxValue:j=!1,showRawValue:b=!1,showRate:y=!1,showExtras:O=!1,showRawExtras:N=O&&b,showColors:k=!1,showRateColors:C=!0,showNegatives:M=!0,showZeros:S=!0,showPlusSign:q=!1,showGrouping:R="number"===h,showZeroRates:T=!1,showRatePercentages:A="number"===h,showCapitalized:E=!0,showChrome:I=!1,precision:P=("time"===h?3:"number"===h?2:0),valuePrecision:U=P,rawValuePrecision:$=U,ratePrecision:D=("time"===h?0:P),extrasPrecision:L=P,rawExtrasPrecision:z=L,reversedDirection:F=!1,prefix:G="",suffix:_="",infix:B=":",placeholder:W="-",timeSeparator:H=("expanded"===m?", ":":"),ago:J="ago",now:V="now",never:Q="never",className:K="",style:te}=e;const ne=[];function ae(e=NaN,s="",{prec:t=P,rnd:a=g,cls:r="",disp:i=h,len:l=m,neg:o=M,zero:u=S,plus:d=q,grp:f=R,color:x=k,paren:p=!1,sep:v=H,pre:j="",post:b="",ref:y=!1,dry:O=!1}){const N=X((e-(y&&c?c:0))*se[i],t,a);if(isNaN(N)||!o&&N<0||!u&&0===N)return"";const C=[i.toString()];if(r&&C.push(r),x){const e=F?-N:+N;C.push(e>0?"positive":e<0?"negative":"zero")}let T=W;return"number"===i||"percentage"===i?(T=function(e,s=21,t=3,n=!1,a=!1){const r={style:"decimal",notation:"standard",signDisplay:n?"always":"auto",useGrouping:a,minimumIntegerDigits:1,minimumFractionDigits:0,maximumFractionDigits:w(t,0,s-1),minimumSignificantDigits:1,maximumSignificantDigits:s},i=e.toLocaleString(void 0,r);return i.length>s?(r.notation="scientific",e.toLocaleString(void 0,r)):i}(N,ee[l],t,d,f),"percentage"===i&&(T+="%")):"time"===i&&(T=y&&Q.length>0&&(e<=0||(null!=c?c:-1/0)<=0)?Q:y&&null!=c?Z(N,l,t>0,v,V,Q,J):Z(N,l,t>0),d&&N>=0&&"expanded"!==l&&(T=`+${T}`)),T=j+T+b,p&&(T=`(${T})`),O||ne.push((0,n.jsx)("div",Object.assign({className:C.join(" ")},{children:T}),s)),T}function re(e,{condition:s=!0,empties:t=!1,caps:n=E}={}){return s&&(t||null!=e&&e.length>0)?n?(null!=e?e:"").replace(/([a-z])([A-Z]|_\S)/g,((e,s,t)=>`${s} ${t.slice(-1)}`)).replace(/(?:^|\s)\S/g,(e=>e.toUpperCase())):e:null}function ie(){var e,s,t;return null!==(t=null!==(e=null!=l?l:u.value?u.value(d):void 0)&&void 0!==e?e:(null!==(s=u.extra)&&void 0!==s?s:{})[null!=d?d:""])&&void 0!==t?t:u.count}const le=["resource"];if((x&&u.icon||p&&u.name)&&ne.push((0,n.jsxs)("div",Object.assign({className:"name"},{children:[x&&u.icon&&u.icon.length>0?(0,n.jsx)(Y,{icon:u.icon,size:"1em"}):null,re(function(){var e,s;if(o)return o;let t=X((null!==(e=ie())&&void 0!==e?e:0)*se[h],U,g);return null!==(s=1===Math.abs(t)?u.singularName:u.pluralName)&&void 0!==s?s:u.name}(),{condition:p}),B]}),"name")),v){const e=j?ae(u.maxCount,"denominator",{prec:U,pre:" / ",dry:!0}):"";ae(ie(),"value",{prec:U,ref:null!=c&&!isNaN(c),post:e,cls:"value"})}if(b&&ae(null!=l?l:d&&u.extra?u.extra[d]:u.count,"raw-value",{disp:"number",prec:$,paren:v,cls:"raw-value"}),y&&!d&&null!=u.rate&&(null!==(t=u.rate.lastCheck)&&void 0!==t?t:0)>0&&(T||0!==u.rate.value)&&ae(u.rate.value/(A&&u.rate.value>0?null!==(a=null!=l?l:u.value?u.value():u.count)&&void 0!==a?a:0:1),"rate",{disp:A&&u.rate.value>0?"percentage":h,prec:D,paren:v||b,color:C,len:A||"expanded"!==m?"tiny":"compact",cls:"rate",neg:!0,zero:!0,plus:!0,grp:!1,post:"/s"}),(O||N)&&!d&&u.extra&&Object.keys(u.extra).length>0)for(let e in u.extra)e.length>0&&(ne.length>0&&ne.push((0,n.jsx)("div",{className:"break"},`break-${e}`)),ne.push((0,n.jsxs)("div",Object.assign({className:"extra-name"},{children:[re(e),B]}),`extra-name-${e}`))),O&&ae(u.value?u.value(e):u.extra[e],`extra-value-${e}`,{disp:e.toLowerCase().indexOf("time")>=0?"time":h,prec:L,cls:"extra-value"}),N&&ae(u.extra[e],`extra-raw-${e}`,{disp:"number",prec:z,paren:O,cls:"raw-extra-value"}),y&&null!=u.rate&&(null!==(r=u.rate.lastCheck)&&void 0!==r?r:0)>0&&(T||0!==u.rate.value)&&ne.push((0,n.jsx)("div",Object.assign({className:"rate"},{children:W}),`extra-rate-${e}`));f||null===(i=u.unlocked)||void 0===i||i||(le.push("locked"),ne.splice(0,ne.length,(0,n.jsx)("div",Object.assign({className:"placeholder"},{children:W}),"lock")));const ce=I?void 0:te;K&&!I&&le.push(K);const oe=(0,n.jsxs)("div",Object.assign({className:le.join(" "),style:ce},{children:[G&&(0,n.jsx)("div",Object.assign({className:"prefix"},{children:G})),ne,_&&(0,n.jsx)("div",Object.assign({className:"suffix"},{children:_}))]}));return I?(0,n.jsx)("div",Object.assign({className:K||void 0,style:te},{children:oe})):oe}function ne({resource:e,kind:s,enabled:t=!0,count:a,maxCount:r=1/0,maxNum:i,minNum:l,increment:c,gainMultiplier:o=1,costMultiplier:u=1,prefix:d="Buy",suffix:h="",infix:m="for",and:f="&",className:x,style:p,onPurchase:v}){const{resourceManager:j,settings:{buyAmount:y}}=H(),O=j.get(e),N=function(e){var s;return null!==(s=g[null!=e?e:""])&&void 0!==s?s:g[""]}(y);function k(e,s,t,a){return e.map(((e,r)=>(0,n.jsx)(te,{resource:"string"==typeof e.resource?{name:e.resource}:e.resource,value:e.count*s,kind:e.kind,display:"string"!=typeof e.resource?e.resource.display:"number",infix:"",prefix:r>0?f:"",showLocked:!0,showColors:!0,showChrome:!0,showPlusSign:t,className:"value-first",reversedDirection:a},"string"==typeof e.resource?e.resource:e.resource.name)))}function C(e=0,s=1){const t=null!=a?a:O.count;return w(Math.floor((t+e)/s)*s-t,0,r-t)}null!=l||(l=N.min),null!=i||(i=N.max),null!=c||(c=N.inc);let M=!0,S=O.buy(C(i,c),"dry-partial",s);S.count%c!=0&&(S=O.buy(C(S.count,c),"dry-partial",s)),(S.count<l||S.count<=0)&&(S=O.buy(Math.max(1,C(w(c,l,i))),"dry-full",s),M=!1),t||(S.cost=[]);const q=S.cost.reduce(((e,s)=>e+s.count),0),R=["buy-button",`buy-button-${M?"":"un"}affordable`,x].filter((e=>!!e));return(0,n.jsxs)("button",Object.assign({onClick:()=>function(e=0){if(!t||e<1)return;const n=O.buy(e,"partial",s);let a=n.count;1!=o&&(a+=j.purchase(b(n.gain,o-1),"free").count),1!=u&&j.purchase(b(n.cost,1-u),"free"),v&&v(O,s,a)}(M&&t?S.count:0),disabled:!M||!t,className:R.join(" "),style:p},{children:[d&&(0,n.jsx)("div",Object.assign({className:"prefix"},{children:d})),k(S.gain,o,!0,!1),q>0&&m&&(0,n.jsx)("div",Object.assign({className:"infix"},{children:m})),q>0&&k(S.cost,u,!1,!0),h&&(0,n.jsx)("div",Object.assign({className:"suffix"},{children:h}))]}))}function ae({cell:e,size:s,enabled:t,tapMode:a}){const{context:i,board:l,setBoard:c,resources:o,settings:u}=H(),d=(0,r.useCallback)((s=>{s.preventDefault();const n=o.clicks;if(n.count++,!t)return void n.extra.useless++;const r=e.state;if(2===s.button||0===s.button&&(s.altKey||s.ctrlKey||s.metaKey||"flag"===a)?(n.extra.right++,k(e,"flag")):0===s.button&&"reveal"===a&&(n.extra.left++,k(e,"reveal")),r===e.state)n.extra.useless++;else if(h(i,"cell",e.state,!1),"hidden"===e.state&&h(i,"cell","un"+r,!1),"active"===l.state){let e=S(l,u.maxErrors);c(Object.assign({},e)),"active"!==e.state&&h(i,"board",e.state,!1)}}),[e,t,a]),m=`min(${s}vmin, ${Math.floor(640*s/100)}px)`;return(0,n.jsx)("td",Object.assign({className:`cell cell-${e.state}`,onClick:d,onContextMenu:d},{children:(0,n.jsx)("div",Object.assign({style:{width:m,height:m}},{children:(0,n.jsx)(Y,{cell:e,size:"80%"})}))}))}function re(){const{board:e,settings:{tapMode:s}}=H(),t=(0,r.useMemo)((function(){const t=w(Math.floor(95/Math.max(e.rows,e.cols)),2,30);return(0,n.jsx)("table",{children:(0,n.jsx)("tbody",{children:e.cells.flatMap(((a,r)=>(0,n.jsx)("tr",{children:a.map(((a,i)=>(0,n.jsx)(ae,{cell:a,size:t,enabled:"active"===e.state,tapMode:s},`cell:${r}:${i}`)))},`row:${r}:*`)))})})}),[e,s]);return(0,n.jsx)("div",Object.assign({className:"minefield"},{children:t}))}function ie(){const{context:e,board:s,resources:{wins:t,cells:a}}=H();return(0,n.jsxs)("div",Object.assign({className:`panel board-state-${s.state}`},{children:[(0,n.jsx)(te,{resource:t,precision:0,showRate:!0,showZeroRates:!0,showRatePercentages:!1,showChrome:!0}),(0,n.jsx)(te,{resource:a,precision:0,showRate:!0,showZeroRates:!0,showRatePercentages:!1,showChrome:!0}),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)(te,{name:"Board",suffix:`${s.rows}x${s.cols}`,showChrome:!0}),(0,n.jsx)(te,{name:"progress",value:o(e),display:"percentage",showChrome:!0}),(0,n.jsx)(te,{resource:{name:"Mines",count:s.cellCounts.flagged,maxCount:s.numMines},showMaxValue:!0,showChrome:!0})]}))}const le=JSON.parse('{"active":["Game in progress..."],"inavtive":["There\'s no game yet...?","Hmm... seems like you should reset the board.","Game is inactive :("],"won":["Hooray!!!","Minefield cleared!!","You win!","Game won!","Success!","Amazing job!!!","WIN!","#winning"],"lost":["Oh no! :(","KABOOOM!!!!!","Minefield blown :/","TOTAL CATASTROPHIC LOSS OF EVERYTHING!!!!","Game lost!","You lost this one :(","#fail","What a tragedy...","It wasn\'t your fault!"],"resetting":["Un-de-mining the playing field...","Resetting the board...","Ordering new landmines...","Contemplating modern warfare...","Bulldozing the ground...","Wasting time for no reason...","Treating shellshock...","Rasterizing cell graphics...","Writing new reset messages...","Pre-computing game features...","Calculating total land area...","Integrating the area under board...","Un-defusing the mines...","Calling technical support..."]}'),ce=t.t(le,2);function oe(e,s){var t,n;const a=ce[e];return a&&0!==a.length?"string"==typeof a?a:(null!=s||(s=Math.floor(Math.random()*a.length)),null!==(n=null!==(t=a[s])&&void 0!==t?t:a[0])&&void 0!==n?n:e):e}function ue({value:e,minValue:s=0,maxValue:t=1,width:a="100px",height:r=a,showPercent:i=!1,className:l,children:c}){const o=(e-s)/(t-s);return(0,n.jsxs)("div",Object.assign({className:`progress-circle ${null!=l?l:""}`,style:{minWidth:a,minHeight:r}},{children:[(0,n.jsxs)("div",Object.assign({className:"children"},{children:[i&&(0,n.jsxs)("span",{children:[Math.floor(100*o),"%"]}),c]})),(0,n.jsxs)("svg",Object.assign({viewBox:"-55 -55 110 110",width:a,height:r},{children:[(0,n.jsx)("circle",{className:"secondary",r:50}),(0,n.jsx)("circle",{className:"primary",r:50,transform:"rotate(-90)",strokeDasharray:100*Math.PI,strokeDashoffset:100*Math.PI*(1-o)})]}))]}))}function de(){const{context:e,board:s,setBoard:t,settings:a,resources:{rows:i,cols:l,resetSpeed:c}}=H(),[o,u]=(0,r.useState)(s.state),[d,m]=(0,r.useState)(!1),[g,f]=(0,r.useState)(""),[x,p]=(0,r.useState)(0);if((0,r.useEffect)((()=>{u(oe(s.state))}),[s,s.state]),0===s.rows||0===s.cols||"inactive"===s.state)return b(),null;if("active"===s.state)return null;const v=function({resourceManager:{resources:{rows:e,cols:s,difficulty:t,resetSpeed:n}}}){return(1-n.value()/100)*Math.sqrt(e.value()*s.value()*(t.value()/100)*10)}(e),j=c.extra.remainingTime;function b(){h(e,"board","active",0===s.rows||0===s.cols);const n=function({resourceManager:{resources:{rows:e,cols:s,difficulty:t}}}){return e.value()*s.value()*(t.value()/100)}(e);t(function(e,s,t,n){let a=function(e,s){const t=[];for(let n=0;n<e;n++){t[n]=[];for(let e=0;e<s;e++)t[n][e]={row:n,col:e,contents:"clear",state:"hidden",neighbors:0}}return{rows:e,cols:s,cells:t,numMines:0,state:"active",cellCounts:Object.assign(Object.assign({},C),{hidden:e*s})}}(e,s);return a=function(e,s,t){var n,a;s=null!==(n=null!=s?s:t)&&void 0!==n?n:0,t=null!==(a=null!=t?t:s)&&void 0!==a?a:0;let r=w(Math.floor(s+Math.random()*(1+t-s)),0,e.rows*e.cols-e.numMines-1);for(;r>0;){const s=Math.floor(Math.random()*e.rows),t=Math.floor(Math.random()*e.cols);"clear"===e.cells[s][t].contents&&(e.cells[s][t].contents="mine",e.numMines++,r--)}return e}(a,t,n),a=S(a),a}(i.value(),l.value(),Math.floor(n),Math.ceil(n))),a.tapMode="reveal"}return d&&(!g||v-j>=x)&&(f(oe("resetting")),p(x+2)),d&&0===j&&(m(!1),b()),(0,n.jsx)("div",Object.assign({className:`reset-box board-state-${s.state}`},{children:(0,n.jsxs)("div",Object.assign({className:"panel"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:o})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:"Game over!"})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:"You may reset the board to receive a brand new game to play:"})),(0,n.jsxs)(ue,Object.assign({value:d?(v-j)/v:0,showPercent:d,width:"100%",height:"50%"},{children:[!d&&(0,n.jsx)("input",{type:"button",value:"Reset!",disabled:d,onClick:function(){d||(m(!0),p(0),c.extra.remainingTime=v)}}),d&&(0,n.jsx)("span",{children:g})]}))]}))}))}function he({showTapMode:e=!0,showBuyAmount:s=!0}){const{settings:t}=H();function a(e){t.buyAmount=e.target.value}function r(e){return e===t.buyAmount?"selected":"unselected"}return(0,n.jsxs)("div",Object.assign({className:"panel mode-controls"},{children:[e&&(0,n.jsxs)("div",Object.assign({className:"left"},{children:[(0,n.jsx)("span",{children:"Tap mode:"}),(0,n.jsxs)("button",Object.assign({type:"button",value:t.tapMode,onClick:function(){t.tapMode="reveal"===t.tapMode?"flag":"reveal"}},{children:[(0,n.jsx)(Y,{state:"reveal"===t.tapMode?"revealed":"flagged",neighbors:9,size:"1em"}),"reveal"===t.tapMode?"Revealing":"Flagging"]}))]})),(0,n.jsx)("div",{className:"spacer"}),s&&(0,n.jsxs)("div",Object.assign({className:"right"},{children:[(0,n.jsx)("span",{children:"Buy amount:"}),(0,n.jsxs)("button",Object.assign({type:"button",value:"x1",className:r("x1"),onClick:a},{children:[(0,n.jsx)(Y,{icon:"x",size:"1em"}),"1"]})),(0,n.jsxs)("button",Object.assign({type:"button",value:"x5",className:r("x5"),onClick:a},{children:[(0,n.jsx)(Y,{icon:"arrow-bar-to-right",size:"1em"}),"5"]})),(0,n.jsxs)("button",Object.assign({type:"button",value:"+5",className:r("+5"),onClick:a},{children:[(0,n.jsx)(Y,{icon:"x",size:"1em"}),"5"]})),(0,n.jsxs)("button",Object.assign({type:"button",value:"x10",className:r("x10"),onClick:a},{children:[(0,n.jsx)(Y,{icon:"arrow-bar-to-right",size:"1em"}),"10"]})),(0,n.jsxs)("button",Object.assign({type:"button",value:"+10",className:r("+10"),onClick:a},{children:[(0,n.jsx)(Y,{icon:"x",size:"1em"}),"10"]})),(0,n.jsx)("button",Object.assign({type:"button",value:"max",className:r("max"),onClick:a},{children:"MAX"}))]}))]}))}function me(){const{context:e,board:s,setBoard:t,resources:{rows:a,cols:r,hints:i,resets:l}}=H(),c=s.rows!==a.value()||s.cols!==r.value();return(0,n.jsxs)("div",Object.assign({className:"main"},{children:[(0,n.jsx)(ie,{}),(0,n.jsx)(de,{}),(0,n.jsx)(re,{}),(0,n.jsx)(he,{}),(0,n.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,n.jsx)("div",Object.assign({className:"half"},{children:(0,n.jsx)("button",Object.assign({className:"buy-button",onClick:function(){let n=S(s,0);t(Object.assign({},n)),h(e,"board",n.state,!1)}},{children:(0,n.jsx)(te,{resource:l,value:1,showValue:!1,showChrome:!0,infix:"",suffix:"the Game"})}))})),(0,n.jsx)("div",Object.assign({className:"half"},{children:(0,n.jsx)(ne,{resource:i,count:0,maxCount:u(e),onPurchase:function(n,a,r=0){(function(e,s,t=0,n=8,a=0){if(s=Math.floor(w(s,0,100)),t=Math.floor(w(t,0,8)),n=Math.floor(w(n,0,8)),a=w(a,0,1),0===s)return 0;const r=e.cells.flat().filter((e=>"hidden"===e.state&&"clear"===e.contents&&e.neighbors>=t&&e.neighbors<=n)).sort(((e,s)=>e.neighbors-s.neighbors));if(r.length<=s)return r.forEach((s=>{k(s,"hint"),e.cellCounts.hinted++,e.cellCounts.hidden--})),r.length;for(let t=0;t<s;t++){let s=0;const t=a,n=Math.random();s=.5===t?n:(Math.sqrt(t*t+n-2*t*n)-t)/(1-2*t),s=Math.floor(s*r.length),r.splice(s,1).map((s=>{k(s,"hint"),e.cellCounts.hinted++,e.cellCounts.hidden--}))}return s})(s,r,0,8,function({resourceManager:{resources:{hintQuality:e}}}){return e.value()/100}(e))>0&&(i.extra.manual++,t(Object.assign({},s)))}})})),c&&(0,n.jsxs)("div",Object.assign({className:"left full"},{children:["On reset, game board will change to size to",` ${a.value()}x${r.value()}`]}))]}))]}))}function ge(){return(0,n.jsx)("div",{children:(0,n.jsxs)("div",Object.assign({className:"panel help"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Progressive Mine Sweep"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"This game is my take on the classic Minesweeper puzzle and making incremental aspects to it. The incremental part is not quite ready yet, so this version of the game has a normal playable field with controls at the bottom of the page to change the size and difficulty level."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"I will put some more info here later about how to play minesweeper, but for now, you need to know that there is a playing field, and there is a number of mines buried under the squares on the field. The size of the field is shown on upper left corner of the scoreboard, and the number of mines is displaying on the upper right corner."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"You can reveal the squares on the field by tapping on them. Each square is either a mine, or shows a clue of how many squares neighboring it have a mine on them -- from 8-ways, including diagonal neighbors. If a square that was revealed was a mine, the field explodes and you lose the game."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"When you flag a square, you are marking it as a possible location for a mine. Have in mind that this doesn't necessarily mean it has a mine under it, as you might have made a mistake. Eventually, the number of flagged mines should match the number of mines on the field and the rest of squares should be revealed to win the game."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"You can flag a square by either right clicking on it, or (when right click is not an option) by holding any of the modifier keys (either ctrl, alt, or meta) and clicking. Additionally, there is a selector at the top of the field to change the tapping style on mobile devices to be either revealing the squares, or flagging them. Tap on this button to toggle the reveal/flag mode."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"The game is won when all the squares are revealed and all the mines are correctly flagged."}))]}))})}function fe(){const e=H(),[s,t]=(0,r.useState)(""),[a,i]=(0,r.useState)(!1),l=(0,c.s0)(),o=(0,c.TH)(),u=e.settings,d=`${o.pathname} ${o.search} ${o.hash} ${o.key}`.toLowerCase().indexOf("debug")>=0;function h(e,s){let t=parseInt(s);if(t>=1&&t<=1e3)switch(e){case"tick":u.ticksPerSecond=t;break;case"render":u.framesPerSecond=t;break;case"save":u.saveFrequencySecs=600/t}}return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",Object.assign({className:"panel options"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Game Data"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:(0,n.jsx)(te,{epoch:u.lastReset/1e3,value:u.lastUpdate/1e3,display:"time",precision:0,prefix:"You started this game "})})),(0,n.jsx)("div",Object.assign({className:"full"},{children:(0,n.jsx)(te,{epoch:u.lastLoaded/1e3,value:u.lastUpdate/1e3,display:"time",precision:0,prefix:"This session started "})})),(0,n.jsx)("div",Object.assign({className:"full"},{children:(0,n.jsx)(te,{epoch:u.lastSaved/1e3,value:u.lastUpdate/1e3,display:"time",precision:0,prefix:"Game was last saved "})})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Load",onClick:function(){e.load()&&l({pathname:"/",search:o.search})}})})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Save",onClick:function(){e.save(d)}})})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Load from File",onClick:function(){!function(e,s){const t=document.createElement("input");t.type="file",t.addEventListener("change",(function(s){const t=s.target.files;if(!t||0===t.length||!t[0])return;const n=new FileReader;n.onload=function(s){var t;const n=null===(t=s.target)||void 0===t?void 0:t.result;n&&"string"==typeof n&&e&&e(n)},n.readAsText(t[0])}),!1),t.click()}((s=>{e.loadAs(s)&&l({pathname:"/",search:o.search})}))}})})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Save to File",onClick:function(){!function(e,s){s instanceof Blob||(s=new Blob([s],{type:"text/plain"}));const t=URL.createObjectURL(s),n=document.createElement("a");n.href=t,n.download=e,n.click(),URL.revokeObjectURL(t)}(`progressive-mine-sweep-${(new Date).toISOString().replace(/\D/g," ").trim().replace(/\D/g,"-")}`,e.saveAs(d))}})})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Import",onClick:function(){e.loadAs(s)&&l({pathname:"/",search:o.search})}})})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"button",value:"Export",onClick:function(){t(e.saveAs(d))}})})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:(0,n.jsx)("textarea",{value:s,onChange:e=>t(e.target.value)})}))]})),(0,n.jsxs)("div",Object.assign({className:"panel options"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Advanced Settings"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"If you are having performance issues, increase the time between updates. Faster updating frequncies lead to better game experience but might use a lot of CPU."})),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Updating frequency:"})),(0,n.jsxs)("div",Object.assign({className:"half center"},{children:[Math.floor(1e3/u.ticksPerSecond),"ms"]})),(0,n.jsx)("div",{className:"half"}),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"range",min:1,max:1e3,value:u.ticksPerSecond,onInput:e=>h("tick",e.target.value)})})),(0,n.jsx)("div",{className:"full"}),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Rendering frequency:"})),(0,n.jsxs)("div",Object.assign({className:"half center"},{children:[Math.floor(1e3/u.framesPerSecond),"ms"]})),(0,n.jsx)("div",{className:"half"}),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"range",min:1,max:60,value:u.framesPerSecond,onInput:e=>h("render",e.target.value)})})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"Change how often the game is saved in the background. More frequent saving leads to faster backups, but increases CPU and I/O usage"})),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Saving frequency:"})),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)(te,{value:u.saveFrequencySecs,display:"time",precision:0})})),(0,n.jsx)("div",{className:"half"}),(0,n.jsx)("div",Object.assign({className:"half center"},{children:(0,n.jsx)("input",{type:"range",min:1,max:60,value:600/u.saveFrequencySecs,onInput:e=>h("save",e.target.value)})}))]})),(0,n.jsxs)("div",Object.assign({className:"panel options reset"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar warning"},{children:"Game Reset"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"WARNING: this will completely reset your game and delete all saved progress and setting. Only use this if you want to restart the game from beginning, or if something in the settings is so messed up that the game is now unplayable."})),(0,n.jsx)("div",Object.assign({className:"full"},{children:(0,n.jsxs)("label",{children:[(0,n.jsx)("input",{type:"checkbox",checked:a,onChange:()=>i(!a)}),"I understand what this means and still want to reset the game"]})})),(0,n.jsx)("div",Object.assign({className:"full right"},{children:(0,n.jsx)("input",{type:"button",value:"Reset everything",disabled:!a,onClick:function(){a&&(confirm("Are you sure you want to reset? This cannot be undone.")?(e.reset(),l({pathname:"/",search:o.search})):i(!1))}})}))]})),d&&(0,n.jsxs)("div",Object.assign({className:"panel options debug"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Debug Context"})),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Settings:"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:JSON.stringify(u,null,2)})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Resources:"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:JSON.stringify(e.resourceManager,null,2)})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"half"},{children:"Board:"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:JSON.stringify(e.board,null,2)}))]}))]})}function xe(e){if(null!=e.condition&&!e.condition)return null;const s=(0,c.TH)();return(0,n.jsx)("div",{children:(0,n.jsx)(l.OL,Object.assign({className:({isActive:e})=>e?"active":"",to:{pathname:e.to,search:s.search}},{children:e.children}))})}function pe(){const{resource:e}=H();function s(s){const t=e(s);return(0,n.jsx)(te,{resource:t,length:"percentage"===t.display?"tiny":"compact",precision:"percentage"===t.display?1:void 0,showMaxValue:!0,showRate:!0,showExtras:!0,showZeroRates:!0,showRateColors:!0})}return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",Object.assign({className:"panel stats"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Time Info"})),s("totalTime"),s("activeTime"),s("offlineTime")]})),(0,n.jsxs)("div",Object.assign({className:"panel stats"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Board Info"})),s("rows"),s("cols"),s("difficulty"),s("resetSpeed"),s("hintQuality")]})),(0,n.jsxs)("div",Object.assign({className:"panel stats"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Game Info"})),s("wins"),s("losses"),s("resets")]})),(0,n.jsxs)("div",Object.assign({className:"panel stats"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Cell Info"})),s("cells"),s("flags"),s("hints"),s("explosions"),s("clicks")]}))]})}function ve(){const{context:e,resources:{rows:s,cols:t,difficulty:a,hintQuality:r,resetSpeed:i}}=H();return(0,n.jsxs)("div",{children:[(0,n.jsx)(ie,{}),(0,n.jsx)(he,{}),(0,n.jsxs)("div",Object.assign({className:"game-controls panel"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Upgrades"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:"Game Width:"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(te,{resource:t,showChrome:!0,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ne,{resource:t,prefix:"Expand",maxCount:50})})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:"Game Height:"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(te,{resource:s,showChrome:!0,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ne,{resource:s,prefix:"Expand",maxCount:50})})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:"Game Difficulty:"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(te,{resource:a,showChrome:!0,showName:!1,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ne,{resource:a,prefix:"Increase",maxCount:100})})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)("span",Object.assign({className:"computed"},{children:"Score Multiplier:"}))})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(te,{value:100*d(e),display:"percentage",showChrome:!0,className:"computed"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ne,{resource:a,prefix:"Decrease",gainMultiplier:-1,enabled:a.count>0,minNum:1,maxNum:1,increment:1})})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:"Reset Speed:"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(te,{resource:i,showChrome:!0,showName:!1,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ne,{resource:i,prefix:"Speed up",maxCount:100})})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:"Hint Quality:"})),(0,n.jsx)("div",Object.assign({className:"quarter"},{children:(0,n.jsx)(te,{resource:r,showChrome:!0,showName:!1,infix:"",className:"value-first"})})),(0,n.jsx)("div",Object.assign({className:"right half"},{children:(0,n.jsx)(ne,{resource:r,prefix:"Improve",maxCount:100})}))]}))]})}function je(){const{settings:e,resourceManager:s,save:t,resources:{resets:a}}=H(),[i,o]=(0,r.useState)(),[u,d]=(0,r.useState)(0),h=a.extra.auto+a.extra.manual>1;function m(){s.update(void 0,e,"tick"),e.lastUpdate-e.lastSaved>=1e3*e.saveFrequencySecs&&e.lastUpdate-e.lastLoaded>=1e3*e.saveFrequencySecs&&t(),d((s=>e.lastUpdate-s>=1e3/e.framesPerSecond?e.lastUpdate:s))}return(0,r.useEffect)((()=>(i&&clearInterval(i),o(setInterval(m,1e3/e.ticksPerSecond)),()=>{i&&(clearInterval(i),o(void 0))})),[e,e.ticksPerSecond]),(0,n.jsxs)(l.UT,{children:[(0,n.jsxs)("nav",Object.assign({className:"navbar"},{children:[(0,n.jsxs)("div",Object.assign({className:"left"},{children:[(0,n.jsx)(xe,Object.assign({to:"/"},{children:"Minefield"})),(0,n.jsx)(xe,Object.assign({to:"/upgrades",condition:h},{children:"Upgrades"}))]})),(0,n.jsx)("div",{className:"spacer"}),(0,n.jsxs)("div",Object.assign({className:"right"},{children:[(0,n.jsx)(xe,Object.assign({to:"/stats"},{children:"Statistics"})),(0,n.jsx)(xe,Object.assign({to:"/help"},{children:"Help"})),(0,n.jsx)(xe,Object.assign({to:"/options"},{children:"Settings"}))]}))]})),(0,n.jsx)("div",Object.assign({className:"main"},{children:(0,n.jsxs)(c.Z5,{children:[(0,n.jsx)(c.AW,{path:"/",element:(0,n.jsx)(me,{})}),(0,n.jsx)(c.AW,{path:"/upgrades",element:(0,n.jsx)(ve,{})}),(0,n.jsx)(c.AW,{path:"/stats",element:(0,n.jsx)(pe,{})}),(0,n.jsx)(c.AW,{path:"/help",element:(0,n.jsx)(ge,{})}),(0,n.jsx)(c.AW,{path:"/options",element:(0,n.jsx)(fe,{})})]})}))]})}function be(){const e=H(),s=(0,r.useMemo)((()=>e.saveAs(!0)),[]);return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",Object.assign({className:"panel options"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar"},{children:"Load Failure!"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"Looks like something went very wrong in loading the game. It's possible that the game version is out of date, or that the save data is corrupt."})),(0,n.jsx)("hr",{className:"separator"}),(0,n.jsx)("div",Object.assign({className:"full"},{children:"For your records, here is the current contents of the save state. Keep this somewhere before resetting the game:"})),(0,n.jsx)("div",Object.assign({className:"full center"},{children:(0,n.jsx)("textarea",{value:s,readOnly:!0})}))]})),(0,n.jsxs)("div",Object.assign({className:"panel options reset"},{children:[(0,n.jsx)("div",Object.assign({className:"title-bar warning"},{children:"Game Reset"})),(0,n.jsx)("div",Object.assign({className:"full"},{children:"WARNING: this will completely reset your game and delete all saved progress and settings. This will hard reset the game from beginning."})),(0,n.jsx)("div",Object.assign({className:"full right"},{children:(0,n.jsx)("input",{type:"button",value:"Hard Reset Everything",onClick:function(){confirm("Are you sure you want to reset? This cannot be undone.")&&(e.reset(),window.location.reload())}})}))]}))]})}function ye(){const{load:e}=H(),[s,t]=(0,r.useState)(!1),[a,l]=(0,r.useState)(!1);function c(){try{e(),t(!0)}catch(e){throw l(!0),e}}return(0,r.useEffect)((()=>{s||a||setTimeout(c,1)}),[s,a]),s?(0,n.jsx)(je,{}):a?(0,n.jsx)(be,{}):(0,n.jsx)(i,{})}window.addEventListener("load",(()=>(0,a.s)(J("app")).render((0,n.jsx)(W,{children:(0,n.jsx)(ye,{})}))),!1)}},e=>{e.O(0,[216,840],(()=>(285,e(e.s=285)))),e.O()}]);