import{j as jsxRuntimeExports,c as clientExports,r as reactExports,u as useNavigate,a as useLocation,N as NavLink,H as HashRouter,R as Routes,b as Route}from"./vendors-B6DOKDHe.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();const achievements_advanced=[{name:"achieveAutomation",description:"Speed up all automation by 20% per milestone!",singularName:"Automated Gameplay",pluralName:"Automated Gameplay",icon:"robot",display:"none",autoAward:!0,count:0,maxCount:4,cost:"cells:auto: 5**(n+1); wins: auto:(n+1)**2",onPurchase:"achievementAwarded"},{name:"achieveExtraMistake",description:"Allow making 1 mistake on a game and still winning it!",singularName:"Maximum Overdrive",pluralName:"Maximum Overdrive",icon:"robot",display:"none",autoAward:!0,count:0,maxCount:1,cost:"hintQuality: 100; resetSpeed: 100; revealNeighbors: 8",onPurchase:"achievementAwarded"}],achievements_normal=[{name:"achieveResets",singularName:"Game Started",pluralName:"Games Started",icon:"refresh",autoAward:!0,count:0,maxCount:5,value:"10**(this.count-1)",cost:"resets:total: 10**(n-1)",onPurchase:"achievementAwarded"},{name:"achieveClicks",singularName:"Click on Board",pluralName:"Clicks on Board",icon:"hand-click",autoAward:!0,count:0,maxCount:5,value:"10**(this.count-1)",cost:"clicks: 10**(n-1)",onPurchase:"achievementAwarded"},{name:"achieveWins",singularName:"Game Won",pluralName:"Games Won",icon:"square-check",autoAward:!0,count:0,maxCount:5,value:"5**(this.count-1)",cost:"wins:total: 5**(n-1)",onPurchase:"achievementAwarded"},{name:"achieveLosses",singularName:"Game Lost",pluralName:"Games Lost",icon:"square-x",autoAward:!0,count:0,maxCount:5,value:"5**(this.count-1)",cost:"losses:total: 5**(n-1)",onPurchase:"achievementAwarded"},{name:"achievePlayTime",singularName:"Minute Playing",pluralName:"Minutes Playing",icon:"clock",autoAward:!0,count:0,maxCount:5,value:"100/60 * 6**this.count",cost:"activeTime:100 * 6**n",onPurchase:"achievementAwarded"},{name:"achieveBoardSize",singularName:"Board Size",pluralName:"Board Size",icon:"arrows-cross",autoAward:!0,count:0,maxCount:5,value:"[3,5,8,10,20,32][this.count] ** 2",cost:"rows: [3,5,8,10,20,32][n]; cols: [3,5,8,10,20,32][n]",onPurchase:"achievementAwarded"}],achievements_secret=[{name:"achieveWinStreak",singularName:"Game Win Streak",pluralName:"Game Win Streak",icon:"box-multiple",autoAward:!0,unlocked:!1,count:0,maxCount:5,value:"[0,3,5,10,25,100][this.count]",cost:"wins:longestStreak: [0,3,5,10,25,100][n]",onPurchase:"achievementAwarded"},{name:"achieveLoseStreak",singularName:"Game Lose Streak",pluralName:"Game Lose Streak",icon:"box-multiple",autoAward:!0,unlocked:!1,count:0,maxCount:5,value:"[0,3,5,10,25,100][this.count]",cost:"losses:longestStreak: [0,3,5,10,25,100][n]",onPurchase:"achievementAwarded"},{name:"achieveWastedClicks",singularName:"Pointless Click",pluralName:"Pointless Clicks",icon:"trash",autoAward:!0,unlocked:!1,count:0,maxCount:1,value:"50*this.count",cost:"clicks:useless: 50*n",onPurchase:"achievementAwarded"},{name:"achieveDifficulty",singularName:"Impossible Difficulty",pluralName:"Impossible Difficulty",icon:"adjustments-horizontal",display:"none",autoAward:!0,unlocked:!1,count:0,maxCount:1,cost:"difficulty: 40*n",onPurchase:"achievementAwarded"},{name:"achieveOnlineTime",singularName:"Hour Online",pluralName:"Hours Online",icon:"alarm",autoAward:!0,unlocked:!1,count:0,maxCount:2,value:"this.count ** 2",cost:"activeTime:max: 60*60 * n**2",onPurchase:"achievementAwarded"},{name:"achieveOfflineTime",singularName:"Hour Offline",pluralName:"Hours Offline",icon:"user-off",autoAward:!0,unlocked:!1,count:0,maxCount:1,value:"12 * this.count",cost:"offlineTime:max: 12*60*60*n",onPurchase:"achievementAwarded"}],tasks_auto=[{name:"autoRevealNeighbors",unlocked:!1,count:0,cost:"automation: Math.floor((n+1)**1.5)",shouldTick:"shouldAutoTick",tick:"revealNeighborsTask(context, dt, source)"},{name:"autoFlagMines",unlocked:!1,count:0,cost:"automation: Math.floor((n+1)**1.5)",shouldTick:"shouldAutoTick",tick:"flagMinesTask(context, dt, source)"},{name:"autoRevealHints",unlocked:!1,count:0,cost:"automation: Math.floor((n+1)**1.5)",shouldTick:"shouldAutoTick",tick:"revealHintsTask(context, dt, source)"},{name:"autoPurchaseHints",unlocked:!1,count:0,cost:"automation: (n+1)**2",shouldTick:"shouldAutoTick",tick:"purchaseHintsTask(context, dt, source)"},{name:"autoResetGame",unlocked:!1,count:0,cost:"automation: Math.floor((n+1)**1.5)",shouldTick:"shouldAutoTick",tick:"resetGameTask(context, dt, source)"},{name:"autoClickBoard",unlocked:!1,count:0,cost:"automation: Math.floor((n+1)**2)"},{name:"autoBoardUpgrade",singularName:"Auto Expand Board",pluralName:"Auto Expand Board",unlocked:!1,count:0,cost:"automation: (n+1)**2",shouldTick:"shouldAutoTick",tick:"expandBoardDims(context, dt, source)"}],resources_board=[{name:"rows",singularName:"row",icon:"arrows-vertical",count:3,minCount:3,cost:"cells: n**2",value:"Math.floor(this.count)"},{name:"cols",singularName:"col",icon:"arrows-horizontal",count:3,minCount:3,cost:"cells: n**2",value:"Math.floor(this.count)"},{name:"difficulty",icon:"adjustments-horizontal",display:"percentage",count:15,minCount:1,maxCount:100,cost:"flags: Math.floor(n/2)"},{name:"hintQuality",icon:"icon-hinted bulb",display:"percentage",count:0,maxCount:100,cost:"wins: Math.floor(n/10); cells: n*2"},{name:"hintsCount",singularName:"hint",pluralName:"hints",count:1,cost:"wins: (n+1)**2; cells: 2**(n+1)",value:"Math.floor(this.count)"},{name:"resetSpeed",icon:"refresh-alert",display:"percentage",count:0,maxCount:100,extra:{remainingTime:0},cost:"resets: 1; cells: n",tick:"timer({ kind: 'remainingTime', direction: -1 })"},{name:"revealNeighbors",icon:"icon-revealed arrows-maximize",unlocked:!1,count:0,maxCount:8,extra:{reveals:0,explosions:0,auto:0,manual:0,useless:0},cost:"cells: 2**(n+1)",value:"Math.floor(value(kind))"}],resources_cell=[{name:"clicks",singularName:"click",icon:"hand-click",count:0,extra:{left:0,right:0,double:0,useless:0}},{name:"cells",singularName:"cell",icon:"icon-revealed square",count:0,extra:{auto:0,manual:0,total:0,hidden:0}},{name:"hints",singularName:"hint",icon:"icon-hinted eye",count:0,extra:{auto:0,manual:0,total:0},cost:"wins: 1",gainMultiplier:"m * hintsCount.count"},{name:"flags",singularName:"flag",icon:"icon-flagged flag-2",count:0,extra:{auto:0,manual:0,total:0,unflags:0}},{name:"explosions",singularName:"explosion",icon:"icon-blown alert-triangle",count:0,extra:{auto:0,manual:0,total:0}}],resources_game=[{name:"wins",singularName:"win",icon:"icon-won square-check",count:0,extra:{auto:0,manual:0,total:0,streak:0,longestStreak:0}},{name:"losses",singularName:"lose",icon:"icon-lost square-x",count:0,extra:{auto:0,manual:0,total:0,streak:0,longestStreak:0}},{name:"resets",singularName:"reset",icon:"refresh",count:0,extra:{auto:0,manual:0,total:0}},{name:"automation",icon:"robot",count:0,extra:{total:0}}],resources_time=[{name:"totalTime",icon:"clock",display:"time",tick:"timer()"},{name:"activeTime",icon:"alarm",display:"time",extra:{current:0,max:0},tick:"timer({ tickSource: 'tick' })"},{name:"offlineTime",icon:"user-off",display:"time",extra:{current:0,max:0},tick:"timer({ tickSource: 'load' })"}];function assign(e,t,s){e[t]&&s&&typeof s=="object"?e[t]={...e[t],...s}:s!=null&&s!=null&&(e[t]=s)}function _storageAvailable(){const e=window.localStorage,t="__storage_test__";if(!e)return!1;try{return e.setItem(t,t),e.removeItem(t),!0}catch(s){return s instanceof DOMException&&e.length!==0&&(s.code===22||s.code===1014||s.name==="QuotaExceededError"||s.name==="NS_ERROR_DOM_QUOTA_REACHED")}}function resetOnBrowser(e){_storageAvailable()&&window.localStorage.removeItem(e)}function saveToBrowser(e,t){_storageAvailable()&&t&&window.localStorage.setItem(e,t)}function loadFromBrowser(e){return _storageAvailable()?window.localStorage.getItem(e):null}function dedupe(e){return e.filter((t,s,n)=>n.indexOf(t)===s)}function _codec(e){const t=e.startsWith(".."),s=(t?e:Math.random().toString(36)).substring(2,10);return(t?"":".."+s)+(t?e.slice(10):e).split("").map(n=>n.charCodeAt(0)).map((n,a)=>String.fromCharCode(n^s.charCodeAt(a%8))).join("")}function _save_properties(e){const t=[],s=e._save_properties;return s!=null&&typeof s=="object"&&Array.isArray(s)&&t.push(...s),t}function _toObject(e){if(!e||typeof e!="object")return e;if(Array.isArray(e))return e.map(a=>_toObject(a));if(Object.keys(e).length===0)return null;const t={},s=_save_properties(e);let n;for(n in e)if(!n.startsWith("_")&&e[n]!=null&&(s.length===0||s.includes(n))){const a=e[n];if(typeof a=="object"){const o=_toObject(a);o!=null&&(t[n.toString()]=o)}else typeof a!="function"&&(t[n.toString()]=a)}return t}function _fromObject(e,t){if(!e||!t||typeof t!="object"||typeof e!="object")return!1;let s;for(s in e)typeof t[s]==typeof e[s]&&(e[s]=t[s]);return!0}function saveAs(e,t=!1){return t?JSON.stringify(_toObject(e),null,2):window.btoa(_codec(JSON.stringify(_toObject(e))))}function loadAs(e,t){let s=null;if(!s)try{s=JSON.parse(_codec(window.atob(t)))}catch{s=null}if(!s)try{s=JSON.parse(window.atob(t))}catch{s=null}if(!s)try{s=JSON.parse(t)}catch{s=null}return s?_fromObject(e,s):!1}function setSaveProperties(e,t){if(!e||typeof e!="object")return e;const s=_save_properties(e);return s.push(...t),Object.assign(e,{_save_properties:dedupe(s)}),e}function clamp(e=0,t=0,s=1){return isNaN(e)||e<t?t:e>s?s:e}const emptyCell={row:0,col:0,contents:"clear",state:"hidden",neighborContents:{clear:0,mine:0},neighborStates:{hidden:0,hinted:0,flagged:0,revealed:0,blown:0}};function actOnCell(e,t){switch(t){case"flag":e.state==="hidden"||e.state==="hinted"?e.state="flagged":e.state==="flagged"&&(e.state="hidden");break;case"reveal":(e.state==="hidden"||e.state==="hinted")&&(e.contents==="clear"?e.state="revealed":e.contents==="mine"&&(e.state="blown"));break;case"hint":e.state==="hidden"&&(e.state="hinted");break;case"hide":(e.state==="flagged"||e.state==="revealed")&&(e.state="hidden");break}return e}const emptyBoard={rows:0,cols:0,cells:[],numMines:0,state:"inactive",cellCounts:{hidden:0,hinted:0,flagged:0,revealed:0,blown:0},hadUserAction:!1};function makeClearBoard(e,t){const s=[];for(let n=0;n<e;n++){s[n]=[];for(let a=0;a<t;a++)s[n][a]={...emptyCell,row:n,col:a}}return{rows:e,cols:t,cells:s,numMines:0,state:"active",cellCounts:{...emptyBoard.cellCounts,hidden:e*t},hadUserAction:!1}}function populateRandomMines(e,t,s){t=t??s??0,s=s??t??0;let n=clamp(Math.floor(t+Math.random()*(1+s-t)),0,e.rows*e.cols-e.numMines-1);for(;n>0;){const a=Math.floor(Math.random()*e.rows),o=Math.floor(Math.random()*e.cols);e.cells[a][o].contents==="clear"&&(e.cells[a][o].contents="mine",e.numMines++,n--)}return e}function genBoardState(e,t=1){e.cellCounts={...emptyBoard.cellCounts},e.numMines=0,e.cells.forEach(s=>s.forEach(n=>{n.neighborContents={...emptyCell.neighborContents},n.neighborStates={...emptyCell.neighborStates}}));for(let s=0;s<e.rows;s++)for(let n=0;n<e.cols;n++){const a=e.cells[s][n];e.numMines+=a.contents==="mine"?1:0,e.cellCounts[a.state]++,a.row=s,a.col=n,a.locked=!!a.locked||void 0,setSaveProperties(a,["contents","state","locked"]);for(let o=s-1;o<=s+1;o++)for(let i=n-1;i<=n+1;i++){const r=(e.cells[o]??[])[i];r&&!(o===s&&i===n)&&(a.neighborContents[r.contents]++,a.neighborStates[r.state]++)}}return e.state==="lost"||e.cellCounts.blown>=t?(e.state="lost",e.cells.forEach(s=>s.forEach(n=>{e.cellCounts[n.state]--,actOnCell(n,"reveal"),e.cellCounts[n.state]++}))):e.cols*e.rows===0?e.state="inactive":e.cellCounts.blown+e.cellCounts.flagged>=e.numMines&&e.cellCounts.hidden===0&&e.cellCounts.revealed>=e.cols*e.rows-e.numMines?e.state="won":e.state="active",setSaveProperties(e,["rows","cols","cells","hadUserAction"])}function genBoard(e,t,s,n){let a=makeClearBoard(e,t);return a=populateRandomMines(a,s,n),a=genBoardState(a),a}function genHints(e,t,s=0,n=8,a=0){if(t=Math.floor(clamp(t,0,100)),s=Math.floor(clamp(s,0,8)),n=Math.floor(clamp(n,0,8)),a=clamp(a,0,1),t===0)return 0;const o=e.cells.flat().filter(i=>i.state==="hidden"&&i.contents==="clear"&&i.neighborContents.mine>=s&&i.neighborContents.mine<=n).sort((i,r)=>i.neighborContents.mine-r.neighborContents.mine);if(o.length<=t)return o.forEach(i=>{actOnCell(i,"hint"),e.cellCounts.hinted++,e.cellCounts.hidden--}),o.length;for(let i=0;i<t;i++){let r=0;const l=a,c=Math.random();l===.5?r=c:r=(Math.sqrt(l*l+c-2*l*c)-l)/(1-2*l),r=Math.floor(r*o.length),o.splice(r,1).map(d=>{actOnCell(d,"hint"),e.cellCounts.hinted++,e.cellCounts.hidden--})}return t}function apply(e,...t){return(...s)=>e(...t,...s)}function compileInlineFunction(body,thisBind,args=[],globals={},reserved=[],forceArgs=!1,forceGlobals=!1){let fnBody=body.replace(/\b\w+\b/gim,function(e){return!e||e==="this"||reserved.includes(e)?e:args.includes(e)?(forceArgs=!0,"___param_"+e):globals[e]?(forceGlobals=!0,"___globals."+e):e});forceArgs&&(fnBody=`(function (${args.map(e=>"___param_"+e).join(",")}) { return ${fnBody}; })`),forceGlobals&&(fnBody=`(function (___globals) { return (${fnBody}); })`);let fn;try{fn=eval(fnBody)}catch(e){fn=null}return thisBind&&typeof fn=="function"&&(fn=fn.bind(thisBind)),forceGlobals&&typeof fn=="function"&&(fn=fn(globals),thisBind&&typeof fn=="function"&&(fn=fn.bind(thisBind))),typeof fn!="function"?forceArgs?()=>fn:compileInlineFunction(body,thisBind,args,globals,reserved,!0,forceGlobals):fn}function tickTimer(e,{kind:t="",tickSource:s="",minValue:n=0,maxValue:a=1/0,direction:o=1,streakKind:i="current",maxStreakKind:r="max",minStreakKind:l="min",resetStreakSource:c=""}={}){return(d,x)=>{if(!s||x===s){let u=(t&&e.extra?e.extra[t]:e.count)??0;(u>n||o>0)&&(u<a||o<0)&&(u=clamp(u+o*d,n,a),t&&e.extra?e.extra[t]=u:e.count=u,i&&e.extra&&e.extra[i]!=null&&(e.extra[i]=clamp(e.extra[i]+o*d,n,a),r&&e.extra[r]!=null&&e.extra[r]<e.extra[i]&&(e.extra[r]=e.extra[i]),l&&e.extra[l]!=null&&e.extra[l]>e.extra[i]&&(e.extra[l]=e.extra[i])))}else(!c||x===c)&&i&&e.extra&&(e.extra[i]=o>0?n:o<0?a:0);return null}}function genResource(e,t){const s={manager:e,name:t,count:0,extra:{},value:n=>valueFunction(s,n),cost:()=>[],buy:(n=1,a="partial",o="",i=1,r=1)=>purchase(e,[{resource:s,count:n,kind:o}],a,i,r),sell:(n,a,o)=>s.buy(-(n??1),void 0,a,void 0,o),add:(n,a,o)=>s.buy(n,"free",a,o),canBuy:(n,a,o)=>s.buy(n,"dry-partial",a,void 0,o),execution:{},rate:{count:0,ticks:0,pastCounts:[],pastTicks:[]}};return setSaveProperties(s,["name","unlocked","disabled","count","extra"])}function genResourceManager(e,t){const s={context:e,settings:t,resources:{},upsert:n=>upsert(s,n),get:n=>resolve(s,n),purchase:(n,a="partial",o=1,i=1)=>purchase(s,n,a,o,i),canAfford:n=>canAfford(s,n),update:(n,a)=>update(s,n??Date.now(),a??"unknown")};return setSaveProperties(s,["resources"])}function resolve(e,t){return e.resources[typeof t=="string"?t:t.name]??upsert(e,t)}function upsert(e,t){const s=typeof t=="string"?t:t.name??"",n=e.resources[s]??genResource(e,s);if(typeof t!="string"){let a;for(a in t)assign(n,a,t[a])}return n.name&&(e.resources[n.name]=n),n}function update(e,t,s){const{rateUpdateSecs:n=1,rateHistoryWindow:a=10,minResourceUpdateSecs:o=.001,maxResourceUpdateSecs:i=86400,maxResourceTickSecs:r=1,timeDilation:l=1}=e.settings;let c=clamp((t-(e.settings.lastUpdate??t))/1e3,0,i);if(c<o&&e.settings.lastUpdate!=null)return[];e.settings.lastUpdate=t;const d=t-c*1e3,x={},u=Object.values(e.resources).filter(m=>m.unlocked??!0);u.forEach(m=>{var f,R;m.onChange&&(x[m.name]={...m.extra,"":m.count}),(f=m.rate).lastCountUpdate??(f.lastCountUpdate=d),(R=m.rate).lastCount??(R.lastCount=m.count),m.execution.lastTick=clamp(m.execution.lastTick??d,t-i*1e3,t),m.execution.lastAttempt=t});const h={},g=u.filter(m=>m.tick&&!m.disabled),j=1/1e3/l;for(;c>0;){c-=clamp(c,o,r);const m=t-c*1e3;g.forEach(f=>{var p;const R=(m-f.execution.lastTick)*j;R>0&&(!f.shouldTick||f.shouldTick(R,s))&&(f.execution.lastResult=f.tick(R,s),f.execution.lastTick=m,f.rate.deltaTicks=(f.rate.deltaTicks??0)+1,(p=f.rate).lastTickUpdate??(p.lastTickUpdate=m),f.execution.lastResult&&(h[f.name]||(h[f.name]=[]),h[f.name].includes(f.execution.lastResult)||h[f.name].push(f.execution.lastResult)))})}return u.forEach(m=>{const f=(t-(m.rate.lastCountUpdate??0))/1e3;(m.rate.lastCountUpdate==null||m.rate.lastCount==null||f>=n)&&(m.rate.count=(m.count-(m.rate.lastCount??0))/f,m.rate.lastCount=m.count,m.rate.lastCountUpdate=t,m.rate.pastCounts.unshift(m.rate.count),m.rate.pastCounts.splice(a));const R=(t-(m.rate.lastTickUpdate??0))/1e3;if((m.rate.lastTickUpdate==null||m.rate.deltaTicks==null||R>=n)&&(m.rate.ticks=(m.rate.deltaTicks??0)/R,m.rate.deltaTicks=0,m.rate.lastTickUpdate=t,m.rate.pastTicks.unshift(m.rate.ticks),m.rate.pastTicks.splice(a)),m.onChange){const p=[];m.count!==(x[m.name]??{})[""]&&p.push(m.onChange(m.count,void 0,s));for(const w in m.extra)m.extra[w]!==(x[m.name]??{})[w]&&p.push(m.onChange(m.extra[w],w,s));h[m.name]=dedupe([...h[m.name]??[],...p])}}),Object.values(e.resources).forEach(m=>{if(m.autoAward&&!m.disabled&&m.count<(m.maxCount??0)){const f=m.cost(m.count+1);canAfford(e,f,!1)&&(m.count++,(m.unlocked??!0)||(m.unlocked=!0),m.onPurchase&&m.onPurchase({count:1,gain:[{resource:m,count:1}],cost:[]}),m.onChange&&(h[m.name]=dedupe([...h[m.name]??[],m.onChange(m.count,void 0,s)])))}}),dedupe(Object.values(h).flat())}function purchase(e,t,s,n,a){const o=e.gainMultiplier?e.gainMultiplier(n):n,i=e.costMultiplier?e.costMultiplier(a):a,r=resolveAll(e,t).map(l=>{const c=l.resource,d=c.gainMultiplier?c.gainMultiplier(o):o,x=c.costMultiplier?c.costMultiplier(i):i,u=getPurchaseCost(e,c,l.count,l.kind,s,d,x);if(s==="dry-partial"||s==="dry-full")return u;{const h=applyToResource(c,u.gain),g=u.cost.map(({resource:m,count:f,kind:R})=>applyToResource(resolve(e,m),[{resource:m,count:-f,kind:R}])).flat(),j={count:u.count,gain:h,cost:g};return c.onPurchase&&c.onPurchase(j),j}});return{count:r.reduce((l,c)=>l+c.count,0),gain:combineResources(r.map(l=>l.gain).flat()),cost:combineResources(r.map(l=>l.cost).flat())}}function resolveAll(e,t){return t.map(({resource:s,count:n,kind:a})=>({resource:resolve(e,s),count:n,kind:a??""})).filter(({resource:s,count:n})=>s&&n)}function canAfford(e,t,s=!0){return resolveAll(e,combineResources(t)).every(n=>checkHasResources(n.resource,[n],s))}function getPurchaseCost(e,t,s,n,a,o,i){if(!t||s===0||!(t.unlocked??!0)&&!a.includes("dry"))return{count:0,gain:[],cost:[]};let r=n?t.extra[n]??0:t.count,l=clamp(r+s,n?0:t.minCount??0,n?1/0:t.maxCount??1/0);if(a==="free")return{count:l-r,gain:[{resource:t,count:o*(l-r),kind:n}],cost:[]};r>l&&([r,l]=[l,r],[o,i]=[-o,-i*(e.settings.sellRatio??1)]);let c=[],d=c,x=0;for(let u=r;u<l;u++){const h=scaleResources(resolveAll(e,t.cost(u+1,n)),i);if(a.includes("partial")&&(d=combineResources(d,h),!canAfford(e,d)))break;x++,c=combineResources(c,h)}return a!=="dry-full"&&!canAfford(e,c)||a==="full"&&r+x!==l?{count:0,gain:[],cost:[]}:{count:x*Math.sign(o),gain:[{resource:t,count:o*x,kind:n}],cost:c}}function combineResources(e,...t){return[e,...t].flat().reduce((s,n)=>{const a=s.find(o=>(o.resource===n.resource||(typeof o.resource=="string"?o.resource:o.resource.name)===(typeof n.resource=="string"?n.resource:n.resource.name))&&(o.kind??"")===(n.kind??""));return a?(a.count+=n.count,s):[...s,{...n}]},[]).filter(({count:s})=>s!==0)}function scaleResources(e,t){return e.map(({resource:s,count:n,kind:a})=>({resource:s,count:t*n,kind:a}))}function checkHasResources(e,t,s=!1){return(e.unlocked??!0)&&combineResources(t).every(({resource:n,count:a,kind:o})=>e.name!==(typeof n=="string"?n:n.name)||e.value(o)-a>=(s&&!o&&typeof n!="string"?n.minCount??0:0))}function applyToResource(e,t){return combineResources(t.filter(({resource:s})=>(e.unlocked??!0)&&e.name===(typeof s=="string"?s:s.name)).map(({count:s,kind:n})=>{const a=n?e.extra[n]??0:e.count,o=clamp(a+s,n?0:e.minCount??0,n?1/0:e.maxCount??1/0);return n?e.extra[n]=o:e.count=o,[{resource:e,count:o-a,kind:n}]}).flat())}function valueFunction(e,t){return t?e.extra[t]??0:clamp(e.count,e.minCount??0,e.maxCount??1/0)}function compileAllResources(e){Object.values(e.resources).forEach(t=>{const s={...t.manager.context,...t.manager,...t.manager.resources,timer:apply(tickTimer,t),value:apply(valueFunction,t)};if(typeof t.value=="string"&&(t.value=compileInlineFunction(t.value,t,["kind"],s)),typeof t.cost=="string"){const n="["+t.cost.replace(/\s/gim,"").split(/[;]/gim).map(a=>{const o=a.split(/:/gim),i=[`resource: ${o[0]}`,`count: ${o[o.length-1]}`];return o.length>2&&i.push(`kind: "${o[1]}"`),"{"+i.join(", ")+"}"}).join(", ")+"]";t.cost=compileInlineFunction(n,t,["n"],s)}typeof t.shouldTick=="string"&&(t.shouldTick=compileInlineFunction(t.shouldTick,t,["dt","source"],s)),typeof t.tick=="string"&&(t.tick=compileInlineFunction(t.tick,t,["dt","source"],s)),typeof t.gainMultiplier=="string"&&(t.gainMultiplier=compileInlineFunction(t.gainMultiplier,t,["m"],s)),typeof t.costMultiplier=="string"&&(t.costMultiplier=compileInlineFunction(t.costMultiplier,t,["m"],s)),typeof t.onPurchase=="string"&&(t.onPurchase=compileInlineFunction(t.onPurchase,t,["purchase"],s)),typeof t.onChange=="string"&&(t.onChange=compileInlineFunction(t.onChange,t,["value","kind","source"],s))})}const defaultSettings={ticksPerSecond:60,framesPerSecond:10,saveFrequencySecs:60,rateUpdateSecs:1,rateHistoryWindow:10,minResourceUpdateSecs:.001,maxResourceUpdateSecs:86400,maxResourceTickSecs:1,lastReset:Date.now(),lastUpdate:Date.now(),lastSaved:0,lastLoaded:Date.now(),maxErrors:1,sellRatio:.8,automationBaseSecs:60,timeDilation:1,tutorialStep:0,tapMode:"reveal",buyAmount:"x1",theme:""};function emptyContext(e){const t=e||{};return t.init??(t.init=()=>{}),t.settings={...defaultSettings,lastReset:Date.now(),lastUpdate:Date.now(),lastLoaded:Date.now()},t.board={...emptyBoard},t.resourceManager=genResourceManager(t,t.settings),t.init(),setSaveProperties(t,["settings","board","resourceManager"])}function wrapContext(e){return{...e.resourceManager,...e,context:e,setBoard:t=>e.board=t,resource:t=>e.resourceManager.get(t),load:()=>_load(e,loadFromBrowser(_store)),loadAs:t=>_load(e,t),save:t=>saveToBrowser(_store,_save(e,t)),saveAs:t=>_save(e,t),reset:()=>_reset(e)}}const _store="Context";function _load(e,t){const s={...e},n=!!t&&loadAs(s,t);if(n){e.init();let a;for(a in s.settings)assign(e.settings,a,s.settings[a]);e.board=genBoardState({...e.board,...s.board}),Object.values(s.resourceManager.resources).forEach(o=>e.resourceManager.upsert(o)),e.settings.lastLoaded=Date.now(),e.resourceManager.update(void 0,"load")}return n}function _save(e,t){return e.settings.lastSaved=Date.now(),saveAs(e,t)}function _reset(e){resetOnBrowser(_store),emptyContext(e)}function getHTMLElement(e){const t=typeof e=="string"?{id:e}:e;let s=document.getElementById(t.id??"");s||(s=document.createElement(t.tagName??"div"),document.body.appendChild(s));let n;for(n in t)assign(s,n,t[n]);return s}function setTheme(e){e?document.documentElement.setAttribute("theme",e):document.documentElement.removeAttribute("theme")}const hidden="question-mark",hinted="eye",flagged="flag-2",blown="alert-triangle",revealed=["square-dot","square-1","square-2","square-3","square-4","square-5","square-6","square-7","square-8","square"],cellIcons={hidden,hinted,flagged,blown,revealed};function Icon(e){var r,l,c;const t=((r=e.cell)==null?void 0:r.state)??e.state,s=((c=(l=e.cell)==null?void 0:l.neighborContents)==null?void 0:c.mine)??e.neighbors;let n=e.icon;if(!n){const d=cellIcons[t??"hidden"];if(d instanceof Array)n=d[s??0];else if(d!=null)n=d;else return null}const a=n.split(/\s+/).filter(d=>d.trim().length>0);n=a.pop()??n;let o=a.pop()??e.color;const i=["icon"];return n&&i.push("icon-"+n),t&&i.push("icon-"+t),o&&!o.startsWith("#")&&(i.push(o),o=void 0),e.className&&i.push(e.className),jsxRuntimeExports.jsx("svg",{className:i.join(" "),width:e.size,height:e.size,color:o,children:jsxRuntimeExports.jsx("use",{xlinkHref:`#tabler-${n}`})})}window.addEventListener("load",()=>{fetch("sprites/tabler-sprite-nostroke.svg").then(e=>e.text()).then(e=>getHTMLElement("icon").innerHTML=e).catch(e=>console.error("Error loading icons:",e))},!1);function toast(e){return genToast(typeof e=="string"?{message:e}:e??{})}toast.info=(e,t)=>genToast({...t,message:e,type:"info"});toast.success=(e,t)=>genToast({...t,message:e,type:"success"});toast.fail=(e,t)=>genToast({...t,message:e,type:"fail"});const rows={top:"top",bottom:"bottom"},groups={left:"left",center:"center",right:"right"},icons={info:"info-circle",success:"circle-check",fail:"alert-circle"};let all_toasts,root,idx=0;window.addEventListener("load",()=>root=clientExports.createRoot(getHTMLElement("toasts-root")),!1);function genToast(e){e=e??{},e.id=e.id??idx++;const t=e.position??"top-right";all_toasts=all_toasts??{},all_toasts[t]=all_toasts[t]??[],t.includes("bottom")?all_toasts[t].unshift(e):all_toasts[t].push(e);const s=e.onHide;return e.onHide=n=>{const a=n.position??"top-right";all_toasts[a]=all_toasts[a].filter(o=>o.id!==n.id),renderAllToasts(),s&&s(n)},renderAllToasts(),{...new Promise(n=>setTimeout(n,(e.duration??3)*1e3)),hide:()=>e.onHide(e)}}function renderAllToasts(){root.render(Object.keys(rows).map(e=>jsxRuntimeExports.jsx("div",{className:`row ${e}`,children:Object.keys(groups).map(t=>{const s=`${e}-${t}`;return jsxRuntimeExports.jsx("div",{className:`group ${t}`,children:(all_toasts[s]??[]).map(n=>jsxRuntimeExports.jsx(Toast,{...n},`toast_${s}_${n.id}`))},s)})},e)))}function Toast(e){const[t,s]=reactExports.useState("hidden");function n(){s("hidden"),setTimeout(()=>{e.onHide&&e.onHide(e)},300)}reactExports.useEffect(()=>{const i=setTimeout(()=>s("shown"),50),r=setTimeout(()=>{e.duration!==0&&n()},(e.duration??3)*1e3);return()=>{clearTimeout(i),clearTimeout(r)}},[]);const a=typeof e.icon=="object"?e.icon:e.icon?{icon:e.icon}:e.type?{icon:icons[e.type]}:void 0,o=["toast",t,e.type,e.className].filter(i=>!!i).join(" ");return jsxRuntimeExports.jsxs("div",{className:o,onClick:e.onClick??n,children:[a&&jsxRuntimeExports.jsx(Icon,{...a}),jsxRuntimeExports.jsxs("div",{children:[e.heading&&jsxRuntimeExports.jsx("h4",{children:e.heading}),e.message&&jsxRuntimeExports.jsx("div",{className:"message",children:e.message})]})]})}function formatNumber(e,t=21,s=3,n=!1,a=!1){const o={style:"decimal",notation:"standard",signDisplay:n?"always":"auto",useGrouping:a,minimumIntegerDigits:1,minimumFractionDigits:0,maximumFractionDigits:clamp(s,0,t-1),minimumSignificantDigits:1,maximumSignificantDigits:t},i=e.toLocaleString(void 0,o);return i.replace(/\D/g,"").length>t?(o.notation="scientific",e.toLocaleString(void 0,o)):i}function formatTime(e,t="expanded",s=!1,n=t==="expanded"?", ":":",a="",o="",i=""){if(o.length>0&&e<0)return o;if(a.length>0&&e===0)return a;let r=Math.floor(e/1e3),l=Math.floor(e-r*1e3),c=Math.floor(r/60);r-=c*60;let d=Math.floor(c/60);c-=d*60;let x=Math.floor(d/24);d-=x*24;let u=Math.floor(x/365);if(x-=u*365,s||(l=0),a.length>0&&x+d+c+r+l===0)return a;let h=[];return t!=="expanded"?h=[u>0?u.toFixed(0):"",x>0?x.toFixed(0):"",d>0||t==="compact"?d.toFixed(0):"",c>0||t==="compact"?c.toFixed(0):"",(r+l/1e3).toFixed(!s||t==="tiny"&&l===0?0:3)].map(g=>t==="compact"&&(g.length===1||g.indexOf(".")===1)?"0"+g:g):h=[[u,"year"],[x,"day"],[d,"hour"],[c,"minute"],[r,"second",u+x+d+c===0,l]].map(([g,j,m=!1,f=0])=>g>0||f>0||m&&g===0?g.toString()+(f>0?"."+f.toString():"")+" "+j+(g===1?"":"s"):""),h.filter(g=>g.length>0).join(n)+(i.length>0?" "+i:"")}function formatWord(e,t,s){if(e||(e=(Math.abs((t==null?void 0:t.count)??0)===1?t==null?void 0:t.singularName:t==null?void 0:t.pluralName)??(t==null?void 0:t.name)),(s==null?void 0:s.condition)??!0)return!e&&!((s==null?void 0:s.allowEmpties)??!1)?void 0:(s==null?void 0:s.capitalize)??!0?(e??"").replace(/([a-z])([A-Z]|_\S)/g,(n,a,o)=>`${a} ${o.slice(-1)}`).replace(/(?:^|\s)\S/g,n=>n.toUpperCase()):e}function achievementAwarded(){const e=Math.floor(this.value()),t=this.display==="none"?"":e.toFixed()+" ";_achievementTotal=void 0,toast({heading:"Achievement Unlocked!",icon:this.icon,type:"success",message:t+formatWord(void 0,{...this,count:e})}),this.name==="achieveExtraMistake"&&(this.manager.context.settings.maxErrors=2)}let _achievementTotal;function achievementScoreMultiplier({resourceManager:{resources:e}}){return _achievementTotal||(_achievementTotal=0,Object.values(e).forEach(t=>{t.autoAward&&(_achievementTotal=(_achievementTotal??0)+t.count)})),1+_achievementTotal/50}function achievementAutomationDiscount(e){return 1-.2*e.resourceManager.resources.achieveAutomation.count}const GameAchievements=Object.freeze(Object.defineProperty({__proto__:null,achievementAutomationDiscount,achievementAwarded,achievementScoreMultiplier},Symbol.toStringTag,{value:"Module"}));function shuffle(e){for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e}function gainMultiplier(e){return e*difficultyScoreMultiplier(this.context)*achievementScoreMultiplier(this.context)}function costMultiplier(e){return e}function boardProgressFormula({board:e}){return 100*(e.cellCounts.revealed+e.cellCounts.flagged)/(e.rows*e.cols)}function numMinesFormula({resourceManager:{resources:{rows:e,cols:t,difficulty:s}}}){return e.value()*t.value()*(s.value()/100)}function hintFormula({resourceManager:{resources:{hintQuality:e}}}){return e.value()/100}function remainingHintsFormula({board:e}){return e.rows*e.cols-e.numMines-e.cellCounts.revealed}function resetTimeFormula({resourceManager:{resources:{rows:e,cols:t,difficulty:s,resetSpeed:n}}}){return(1-n.value()/100)*Math.sqrt(e.value()*t.value()*(s.value()/100)*10)}function getBuyAmount(e){return _buyAmounts[e??""]??_buyAmounts[""]}function difficultyScoreMultiplier({resourceManager:{resources:{difficulty:e}}}){return(e.value()+10)/25}function revealNeighbors(e,t,s,n,a,o){var l;const i=e.resourceManager.resources.revealNeighbors,r=[];for(let c=s.row-1;c<=s.row+1;c++)for(let d=s.col-1;d<=s.col+1;d++)((l=(t.cells[c]??[])[d])==null?void 0:l.state)==="hidden"&&r.push(t.cells[c][d]);shuffle(r).splice(n);for(const c of r)actOnCell(c,"reveal"),a&&(stateChanged(e,"cell",c.state,!0),c.state==="revealed"&&c.contents==="clear"?i.extra.reveals++:c.state==="blown"||c.contents==="mine"?i.extra.explosions++:i.extra.useless++);return a&&(countActions(i,o),r.length===0&&i.extra.useless++),r.length}function countActions(e,t,s=1){if(t){const n=e.manager.resources.automation;n.add(s),n.extra.total+=s,e.extra.auto!=null&&(e.extra.auto+=s)}else e.extra.manual!=null&&(e.extra.manual+=s);e.extra.total!=null&&(e.extra.total+=s),e.extra.streak!=null&&(e.extra.streak+=s,e.extra.longestStreak!=null&&e.extra.streak>e.extra.longestStreak&&(e.extra.longestStreak=e.extra.streak))}function stateChanged(e,t,s,n,a=1){const o=e.resourceManager.resources,i=o[_targetStates[t+":"+s]??""];switch(i&&(i.add(a),countActions(i,n,a)),t+":"+s){case"cell:unflagged":o.flags.add(-a),o.flags.extra.unflags+=a;break;case"cell:unrevealed":o.cells.add(-a),o.cells.extra.hidden+=a;break;case"board:won":o.losses.extra.streak=0;break;case"board:lost":o.wins.extra.streak=0;break}}function boardReset(e,t=!1){const s=e.resourceManager.resources,n=t&&e.board.state==="inactive"&&s.resets.count===0&&s.resets.extra.total===0,a=n?1:numMinesFormula(e);if(e.settings.tapMode="reveal",e.board=genBoard(s.rows.value(),s.cols.value(),Math.floor(a),Math.ceil(a)),n&&(genHints(e.board,1,0,0,1)===0&&genHints(e.board,1,0,1,1),stateChanged(e,"board","active",!0),stateChanged(e,"cell","hinted",!0)),s.autoClickBoard.count>0&&(s.autoClickBoard.unlocked??!0)&&!s.autoClickBoard.disabled)for(let o=s.autoClickBoard.value();o>0;o--){const i=Math.floor(Math.random()*s.rows.value()),r=Math.floor(Math.random()*s.cols.value()),l=e.board.cells[i][r];l.state==="hidden"&&e.board.state==="active"&&(actOnCell(l,"reveal"),stateChanged(e,"cell",l.state,!0))}return!0}const _targetStates={"board:active":"resets","board:lost":"losses","board:won":"wins","cell:blown":"explosions","cell:hinted":"hints","cell:flagged":"flags","cell:revealed":"cells"},_buyAmounts={"":{min:1,max:1,inc:1},x1:{min:1,max:1,inc:1},x5:{min:1,max:5,inc:5},x10:{min:1,max:10,inc:10},"+5":{min:5,max:5,inc:1},"+10":{min:10,max:10,inc:1},max:{min:1,max:100,inc:1}},GameFormulas=Object.freeze(Object.defineProperty({__proto__:null,boardProgressFormula,boardReset,costMultiplier,countActions,difficultyScoreMultiplier,gainMultiplier,getBuyAmount,hintFormula,numMinesFormula,remainingHintsFormula,resetTimeFormula,revealNeighbors,stateChanged},Symbol.toStringTag,{value:"Module"}));function getTickProgress(e,t){if(!e||e.count<=0||!(e.unlocked??!0)||e.disabled)return NaN;const s=e.manager.context;return t??(t=(Date.now()-(e.execution.lastTick??Date.now()))/1e3/s.settings.timeDilation),t*e.count/s.settings.automationBaseSecs/achievementAutomationDiscount(s)}function shouldAutoTick(e,t){return t==="tick"&&getTickProgress(this,e)>=1}function canRevealNeighbors(e){return e.state==="revealed"&&e.contents==="clear"&&e.neighborContents.mine===e.neighborStates.flagged+e.neighborStates.blown&&e.neighborStates.hidden>0}function revealNeighborsTask(e){const t=e.resourceManager.resources.autoRevealNeighbors;if(t.count<=0||!(t.unlocked??!0)||t.disabled||e.board.state!=="active")return null;const s=e.board.cells.flat().filter(canRevealNeighbors);return s.length===0?!1:revealNeighbors(e,e.board,shuffle(s)[0],e.resourceManager.resources.revealNeighbors.count,!0,!0)>0}function resetGameTask(e){const t=e.resourceManager.resources;if(t.autoResetGame.count<=0||!(t.autoResetGame.unlocked??!0)||t.autoResetGame.disabled||e.board.state==="active"||e.board.state==="inactive"||t.resetSpeed.extra.remainingTime>0)return null;const s=resetTimeFormula(e);return s<.001?(boardReset(e,!0),!0):(t.resetSpeed.extra.remainingTime=s,t.resetSpeed.onChange=(n,a,o)=>n<.001&&a==="remainingTime"&&o==="tick"&&boardReset(e,!0),!1)}function canFlagMines(e){return e.state==="revealed"&&e.contents==="clear"&&e.neighborContents.mine===e.neighborStates.flagged+e.neighborStates.blown+e.neighborStates.hidden&&e.neighborContents.clear===e.neighborStates.revealed&&e.neighborStates.hidden>0}function flagMinesTask(e){var i;const t=e.resourceManager.resources.autoFlagMines;if(t.count<=0||!(t.unlocked??!0)||t.disabled||e.board.state!=="active")return null;const s=e.board.cells.flat().filter(canFlagMines);if(s.length===0)return!1;const n=shuffle(s)[0],a=[];for(let r=n.row-1;r<=n.row+1;r++)for(let l=n.col-1;l<=n.col+1;l++)((i=(e.board.cells[r]??[])[l])==null?void 0:i.state)==="hidden"&&a.push(e.board.cells[r][l]);if(a.length===0)return!1;const o=shuffle(a)[0];return actOnCell(o,"flag"),stateChanged(e,"cell",o.state,!0),!0}function canRevealHints(e){return e.state==="hinted"&&e.contents==="clear"}function revealHintsTask(e){const t=e.resourceManager.resources.autoRevealHints;if(t.count<=0||!(t.unlocked??!0)||t.disabled||e.board.state!=="active")return null;const s=e.board.cells.flat().filter(canRevealHints);if(s.length===0)return!1;const n=shuffle(s)[0];return actOnCell(n,"reveal"),stateChanged(e,"cell",n.state,!0),!0}function purchaseHintsTask(e){const t=e.resourceManager.resources.autoPurchaseHints;if(t.count<=0||!(t.unlocked??!0)||t.disabled||e.board.state!=="active"||remainingHintsFormula(e)===0)return null;const s=e.resourceManager.resources.hints;if(e.board.cells.flat().filter(i=>canRevealHints(i)||canRevealNeighbors(i)||canFlagMines(i)).length>0)return!1;const a=s.buy();if(a.count===0)return!1;const o=genHints(e.board,a.gain[0].count,0,8,hintFormula(e));return o>0?(countActions(s,!0,o),!0):!1}function expandBoardDims(e){const t=e.resourceManager.resources;if(t.autoBoardUpgrade.count<=0||!(t.autoBoardUpgrade.unlocked??!0)||t.autoBoardUpgrade.disabled)return null;const s=t.rows.count<t.cols.count?t.rows:t.cols;return s.buy().count===0?!1:(countActions(s,!0),!0)}const GameAutomation=Object.freeze(Object.defineProperty({__proto__:null,expandBoardDims,flagMinesTask,getTickProgress,purchaseHintsTask,resetGameTask,revealHintsTask,revealNeighborsTask,shouldAutoTick},Symbol.toStringTag,{value:"Module"})),context=emptyContext(),GameReactContext=reactExports.createContext(context);function GameContextProvider(e){return jsxRuntimeExports.jsx(GameReactContext.Provider,{value:context,children:e.children})}function useGameContext(){return wrapContext(reactExports.useContext(GameReactContext))}const _load_resources=[resources_time,resources_board,resources_game,resources_cell,tasks_auto,achievements_normal,achievements_advanced,achievements_secret];Object.assign(context,{...GameAchievements,...GameAutomation,...GameFormulas,init:function(){this.resourceManager.gainMultiplier=gainMultiplier,this.resourceManager.costMultiplier=costMultiplier,_load_resources.flat().forEach(e=>this.resourceManager.upsert(e)),compileAllResources(this.resourceManager)}});function Reset(){const e=useGameContext(),t=reactExports.useMemo(()=>e.saveAs(!0),[]);function s(){confirm("Are you sure you want to reset? This cannot be undone.")&&(e.reset(),window.location.reload())}return jsxRuntimeExports.jsxs("div",{id:"reset",children:[jsxRuntimeExports.jsxs("div",{className:"panel options",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Load Failure!"}),jsxRuntimeExports.jsx("div",{className:"full",children:"Looks like something went very wrong in loading the game. It's possible that the game version is out of date, or that the save data is corrupt."}),jsxRuntimeExports.jsx("hr",{className:"separator"}),jsxRuntimeExports.jsx("div",{className:"full",children:"For your records, here is the current contents of the save state. Keep this somewhere before resetting the game:"}),jsxRuntimeExports.jsx("div",{className:"full center",children:jsxRuntimeExports.jsx("textarea",{value:t,readOnly:!0})})]}),jsxRuntimeExports.jsxs("div",{className:"panel options reset",children:[jsxRuntimeExports.jsx("div",{className:"title-bar warning",children:"Game Reset"}),jsxRuntimeExports.jsx("div",{className:"full",children:"WARNING: this will completely reset your game and delete all saved progress and settings. This will hard reset the game from beginning."}),jsxRuntimeExports.jsx("div",{className:"full right",children:jsxRuntimeExports.jsx("input",{type:"button",value:"Hard Reset Everything",onClick:s})})]})]})}const roundMethods={floor:Math.floor,round:Math.round,ceil:Math.ceil};function round(e,t,s){const n=10**t;return roundMethods[s](e*n)/n}const maxLengths={tiny:4,compact:9,expanded:21},multipliers={none:0,number:1,percentage:1,time:1e3};function ResourceRender({value:e,epoch:t,name:s,resource:n={name:s,count:e},kind:a=void 0,display:o=n.display??"number",length:i="expanded",rounding:r=o==="number"?"floor":"round",showLocked:l=!1,showIcon:c=!0,showName:d=!0,showValue:x=o!=="none",showMaxValue:u=!1,showRawValue:h=!1,showRate:g=!1,showExtras:j=!1,showRawExtras:m=j&&h,showColors:f=!1,showRateColors:R=!0,showNegatives:p=!0,showZeros:w=!0,showPlusSign:T=!1,showGrouping:J=o==="number",showZeroRates:N=!1,showRatePercentages:O=o==="number",showRateHistory:U=!1,showCapitalized:q=!0,showChrome:I=!1,precision:S=o==="time"?3:o==="number"?2:0,valuePrecision:E=S,rawValuePrecision:$=E,ratePrecision:Q=o==="time"?0:S,extrasPrecision:y=S,rawExtrasPrecision:C=y,reversedDirection:b=!1,prefix:L="",suffix:te="",infix:se=(c||d)&&(x||u||h||g||j||m)?":":"",placeholder:Y="-",timeSeparator:re=i==="expanded"?", ":":",ago:le="ago",now:ce="now",never:Z="never",className:D="",style:ne}){const A=[];function F(v=NaN,G="",{prec:M=S,rnd:H=r,cls:W="",disp:B=o,len:P=i,neg:z=p,zero:de=w,plus:oe=T,grp:me=J,color:xe=f,paren:he=!1,sep:fe=re,pre:pe="",post:ge="",ref:V=!1,dry:je=!1}){const _=round((v-(V&&t?t:0))*multipliers[B],M,H);if(isNaN(_)||!z&&_<0||!de&&_===0)return"";const ee=[B.toString()];if(W&&ee.push(W),xe){const ie=b?-_:+_;ee.push(ie>0?"positive":ie<0?"negative":"zero")}let k=Y;return B==="number"||B==="percentage"?(k=formatNumber(_,maxLengths[P],M,oe,me),B==="percentage"&&(k+="%")):B==="time"?(V&&Z.length>0&&(v<=0||(t??-1/0)<=0)?k=Z:V&&t!=null?k=formatTime(_,P,M>0,fe,ce,Z,le):k=formatTime(_,P,M>0),oe&&_>=0&&P!=="expanded"&&(k=`+${k}`)):B==="none"&&(k=""),k=pe+k+ge,he&&(k=`(${k})`),je||A.push(jsxRuntimeExports.jsx("div",{className:ee.join(" "),children:k},G)),k}const X=["resource"],K=e??(n.value?n.value(a):void 0)??(n.extra??{})[a??""]??n.count;if((c&&n.icon||d&&n.name)&&A.push(jsxRuntimeExports.jsxs("div",{className:"name",children:[c&&n.icon&&n.icon.length>0?jsxRuntimeExports.jsx(Icon,{icon:n.icon,size:"1em"}):null,formatWord(s,{count:round(K*multipliers[o],E,r),name:n.name,singularName:n.singularName,pluralName:n.pluralName},{condition:d,allowEmpties:!1,capitalize:q}),se]},"name")),x){const v=u?F(n.maxCount,"denominator",{prec:E,pre:" / ",dry:!0}):"";F(K,"value",{prec:E,ref:t!=null&&!isNaN(t),post:v,cls:"value"})}if(h&&F(e??(a&&n.extra?n.extra[a]:n.count),"raw-value",{disp:"number",prec:$,paren:x,cls:"raw-value"}),g&&!a&&n.rate!=null&&(n.rate.lastCountUpdate??0)>0&&(N||n.rate.count!==0)){let v=0;if(U&&n.rate.pastCounts.length>0){let H=0,W=n.rate.pastCounts.length;n.rate.pastCounts.forEach((B,P)=>{const z=W-P;v+=B*z,H+=z}),v/=H}else v=n.rate.count;let G=O,M=O?K:1;(M===0||G&&(v/M<.01||M<1e3))&&(G=!1,M=1),F(v/M,"rate",{disp:G?"percentage":o,prec:Q,paren:x||h,color:R,len:G||i!=="expanded"?"tiny":"compact",cls:"rate",neg:!0,zero:!0,plus:!0,grp:!1,post:"/s"})}if((j||m)&&!a&&n.extra&&Object.keys(n.extra).length>0)for(let v in n.extra)v.length>0&&(A.length>0&&A.push(jsxRuntimeExports.jsx("div",{className:"break"},`break-${v}`)),A.push(jsxRuntimeExports.jsxs("div",{className:"extra-name",children:[formatWord(v,void 0,{capitalize:q}),se]},`extra-name-${v}`))),j&&F(n.value?n.value(v):n.extra[v],`extra-value-${v}`,{disp:v.toLowerCase().indexOf("time")>=0?"time":o,prec:y,cls:"extra-value"}),m&&F(n.extra[v],`extra-raw-${v}`,{disp:"number",prec:C,paren:j,cls:"raw-extra-value"}),g&&n.rate!=null&&(n.rate.lastCountUpdate??0)>0&&(N||n.rate.count!==0)&&A.push(jsxRuntimeExports.jsx("div",{className:"rate",children:Y},`extra-rate-${v}`));!l&&!(n.unlocked??!0)&&(X.push("locked"),A.splice(0,A.length,jsxRuntimeExports.jsx("div",{className:"placeholder",children:Y},"lock")));const ue=I?void 0:ne;D&&!I&&X.push(D);const ae=jsxRuntimeExports.jsxs("div",{className:X.join(" "),style:ue,id:`resource-${s??n.name}`,children:[L&&jsxRuntimeExports.jsx("div",{className:"prefix",children:L}),A,te&&jsxRuntimeExports.jsx("div",{className:"suffix",children:te})]});return I?jsxRuntimeExports.jsx("div",{className:D||void 0,style:ne,id:`resource-chrome-${s??n.name}`,children:ae}):ae}function Achievements(){const{context:e,resource:t}=useGameContext();let[s,n]=[0,0];const a=achievements_normal.flat().map(({name:l})=>{const c=t(l);return s+=c.count,n+=c.maxCount??0,c}),o=achievements_advanced.flat().map(({name:l})=>{const c=t(l);return s+=c.count,n+=c.maxCount??0,c}),i=achievements_secret.flat().map(({name:l})=>{const c=t(l);return s+=c.count,n+=c.maxCount??0,c});function r(l){return jsxRuntimeExports.jsxs("div",{className:`achievement ${l.count?"":"un"}earned`,children:[jsxRuntimeExports.jsx(ResourceRender,{resource:l,showChrome:!0,showIcon:!1,showValue:l.count>0,infix:"",placeholder:"???",className:"value-first"}),(l.unlocked??!0)&&l.description&&jsxRuntimeExports.jsx("div",{className:"subtext",children:l.description}),(l.unlocked??!0)&&l.maxCount&&l.maxCount>1&&jsxRuntimeExports.jsxs("div",{className:"subtext",children:["Gained ",l.count," / ",l.maxCount," milestones"]})]},l.name)}return jsxRuntimeExports.jsxs("div",{id:"achievements",children:[jsxRuntimeExports.jsxs("div",{className:"panel",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Achievements"}),jsxRuntimeExports.jsx("div",{className:"half right",children:"Total achievements score:"}),jsxRuntimeExports.jsxs("div",{className:"half left",children:[s," / ",n]}),jsxRuntimeExports.jsx("div",{className:"half right",children:"Score multiplier from achievements:"}),jsxRuntimeExports.jsxs("div",{className:"half left",children:[Math.floor(achievementScoreMultiplier(e)*100),"%"]})]}),jsxRuntimeExports.jsxs("div",{className:"panel",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Normal Achievements"}),a.map(r)]}),jsxRuntimeExports.jsxs("div",{className:"panel",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Advanced Achievements"}),o.map(r)]}),jsxRuntimeExports.jsxs("div",{className:"panel",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Secret Achievements"}),i.map(r)]})]})}function BuyButton({resource:e,kind:t,enabled:s=!0,allowUnlocking:n=!1,maxNum:a,minNum:o,increment:i,precision:r=0,gainMultiplier:l=1,costMultiplier:c=1,mode:d="buy",overrideCount:x,overrideMaxCount:u,overrideMinCount:h,prefix:g="Buy",suffix:j="",infix:m="for",and:f="&",className:R,style:p,onPurchase:w}){const{resourceManager:T,settings:{buyAmount:J}}=useGameContext(),N=T.get(e),O=getBuyAmount(J);o??(o=O.min),a??(a=O.max),i??(i=O.inc),(N.unlocked??!0)||(n?o=a=i=1:(o=a=i=0,s=!1)),d==="sell"&&([o,a,i]=[-o,-a,-i]);function U(y,C){return y.map((b,L)=>jsxRuntimeExports.jsx(ResourceRender,{resource:typeof b.resource=="string"?{name:b.resource}:b.resource,value:b.count*C,kind:b.kind,display:typeof b.resource!="string"?b.resource.display:"number",precision:r,infix:"",placeholder:"",prefix:L>0?f:"",showLocked:n,showValue:typeof b.resource=="string"?!0:b.resource.unlocked??!0,showColors:!0,showChrome:!0,showPlusSign:!0,className:"value-first"},typeof b.resource=="string"?b.resource:b.resource.name))}function q(y,C){if(C.preventDefault(),!s||y===0)return;!(N.unlocked??!0)&&n&&(N.unlocked=!0);const b=N.buy(y,"partial",t,l,c);w&&b.gain.length>0&&w(N,t,b.gain[0].count)}function I(y=0){const C=x??N.value(t);return clamp(Math.floor((C+y)/(i??1))*(i??1),Math.max(h??-1/0,N.minCount??0),Math.min(u??1/0,N.maxCount??1/0))-C}let S=!0,E=N.buy(I(a),"dry-partial",t,l,c);if(E.count%i!==0&&(E=N.buy(I(E.count),"dry-partial",t,l,c)),o>=0&&E.count<o||o<0&&E.count>o||E.count===0){const y=I(clamp(i,Math.min(o,a),Math.max(o,a)));E=N.buy(Math.abs(y)<1?Math.sign(i):y,"dry-full",t,l,c),S=!1}s||(E.cost=[]);const $=E.cost.reduce((y,C)=>y+=C.count,0),Q=["buy-button",`buy-button-${S?"":"un"}affordable`,R].filter(y=>!!y);return jsxRuntimeExports.jsxs("button",{onClick:apply(q,S&&s?E.count:0),disabled:!S||!s,className:Q.join(" "),style:p,id:`button-buy-${N.name}`,children:[g&&jsxRuntimeExports.jsx("div",{className:"prefix",children:g}),U(E.gain,1),$!==0&&m&&jsxRuntimeExports.jsx("div",{className:"infix",children:m}),$!==0&&U(E.cost,-1),j&&jsxRuntimeExports.jsx("div",{className:"suffix",children:j})]})}function ModeControls({showTapMode:e=!0,showBuyAmount:t=!0}){const{settings:s}=useGameContext(),[n,a]=reactExports.useState(s.tapMode),[o,i]=reactExports.useState(s.buyAmount);function r(x){x.preventDefault(),s.tapMode=s.tapMode==="reveal"?"flag":"reveal",a(s.tapMode)}function l(x){x.preventDefault(),s.buyAmount=x.target.value,i(s.buyAmount)}function c(x){return x===s.buyAmount?"selected":"unselected"}function d(x,u,h){return jsxRuntimeExports.jsxs("button",{type:"button",value:x,className:c(x),onClick:l,id:`button-${x.replace(/\W/g,"")}`,children:[u&&jsxRuntimeExports.jsx(Icon,{icon:u}),h]})}return jsxRuntimeExports.jsxs("div",{className:"panel mode-controls",children:[e&&jsxRuntimeExports.jsxs("div",{className:"left",children:[jsxRuntimeExports.jsx("span",{children:"Tap mode:"}),jsxRuntimeExports.jsxs("button",{type:"button",value:s.tapMode,onClick:r,id:"button-tapmode",children:[jsxRuntimeExports.jsx(Icon,{state:s.tapMode==="reveal"?"revealed":"flagged",neighbors:9}),s.tapMode==="reveal"?"Revealing":"Flagging"]})]}),jsxRuntimeExports.jsx("div",{className:"spacer"}),t&&jsxRuntimeExports.jsxs("div",{className:"right",children:[jsxRuntimeExports.jsx("span",{children:"Buy amount:"}),d("x1","x","1"),d("x5","arrow-bar-to-right","5"),d("+5","x","5"),d("x10","arrow-bar-to-right","10"),d("+10","x","10"),d("max",void 0,"MAX")]})]})}function ProgressBar({value:e=NaN,minValue:t=0,maxValue:s=1,orientation:n="horizontal",width:a=n==="horizontal"?"100%":"1ex",height:o=n==="vertical"?"100%":"1ex",showPercent:i=!1,enabled:r=!isNaN(e),className:l,children:c}){const d=clamp((e-t)/(s-t)),x=n==="horizontal"?d:1,u=n==="vertical"?d:1;return jsxRuntimeExports.jsxs("div",{className:`progress-bar ${l??""}`,style:{minWidth:a,minHeight:o},children:[jsxRuntimeExports.jsxs("div",{className:"children",children:[r&&i&&jsxRuntimeExports.jsxs("span",{children:[Math.floor(100*d),"%"]}),c]}),r&&d>.001&&jsxRuntimeExports.jsx("div",{className:"primary",style:{width:`${x*100}%`,height:`${u*100}%`}}),jsxRuntimeExports.jsx("div",{className:r?"secondary":"disabled"})]})}function ResourceBar(){const{context:e,board:t,resources:{wins:s,cells:n,automation:a}}=useGameContext();return jsxRuntimeExports.jsxs("div",{className:`panel board-state-${t.state}`,id:"resource-bar",children:[jsxRuntimeExports.jsx(ResourceRender,{resource:s,precision:0,showRate:!0,showZeroRates:!0,showRatePercentages:!1,showChrome:!0}),a.extra.total>=5&&jsxRuntimeExports.jsx(ResourceRender,{resource:a,precision:0,showRate:!0,showZeroRates:!0,showRatePercentages:!1,showChrome:!0}),jsxRuntimeExports.jsx(ResourceRender,{resource:n,precision:0,showRate:!0,showZeroRates:!0,showRatePercentages:!1,showChrome:!0}),jsxRuntimeExports.jsx("hr",{className:"separator"}),jsxRuntimeExports.jsx(ResourceRender,{name:"Board",suffix:`${t.rows}x${t.cols}`,showChrome:!0}),jsxRuntimeExports.jsx(ResourceRender,{name:"progress",value:boardProgressFormula(e),display:"percentage",showChrome:!0}),jsxRuntimeExports.jsx(ResourceRender,{resource:{name:"Mines",count:t.cellCounts.flagged,maxCount:t.numMines},showMaxValue:!0,showChrome:!0})]})}function ToggleButton({enabled:e=!0,checked:t=!1,onChange:s,checkedContents:n,unCheckedContents:a,className:o,style:i,children:r}){const[l,c]=reactExports.useState(!1);reactExports.useEffect(()=>{c(t)},[t]);function d(u){u.preventDefault(),e&&(c(!l),s&&s(!l))}const x=["toggle-button",`toggle-button-${e?"en":"dis"}abled`,`toggle-button-${t?"":"un"}checked`,o].filter(u=>!!u);return jsxRuntimeExports.jsxs("div",{onClick:d,className:x.join(" "),style:i,children:[jsxRuntimeExports.jsx("div",{className:"check",children:jsxRuntimeExports.jsx("div",{children:n})}),jsxRuntimeExports.jsx("div",{className:"contents",children:r}),jsxRuntimeExports.jsx("div",{className:"uncheck",children:jsxRuntimeExports.jsx("div",{children:a})}),jsxRuntimeExports.jsx("div",{className:"circle"})]})}function Automation(){const{context:e,resources:{revealNeighbors:t,autoRevealNeighbors:s,autoFlagMines:n,autoRevealHints:a,autoPurchaseHints:o,autoResetGame:i,autoClickBoard:r,autoBoardUpgrade:l}}=useGameContext(),c=e.settings.automationBaseSecs*achievementAutomationDiscount(e),d=formatTime(1e3*c);function x(u){return!u.disabled&&c/u.value()<=1?1:getTickProgress(u)}return jsxRuntimeExports.jsxs("div",{id:"automation",className:"automation",children:[jsxRuntimeExports.jsx(ResourceBar,{}),jsxRuntimeExports.jsx(ModeControls,{showTapMode:!1}),jsxRuntimeExports.jsxs("div",{className:"game-controls panel",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Cell Automation"}),jsxRuntimeExports.jsx("div",{className:"half",children:jsxRuntimeExports.jsx(ResourceRender,{resource:s,showChrome:!0,showLocked:!0,infix:"",suffix:`time${s.count===1?"":"s"} every ${d}`})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:s,allowUnlocking:!0,enabled:t.unlocked&&t.count>0,prefix:s.unlocked?"Additional":"Unlock"})}),jsxRuntimeExports.jsxs("div",{className:"full right",children:["Enabled:",jsxRuntimeExports.jsx(ToggleButton,{checked:s.unlocked&&!s.disabled,onChange:u=>s.disabled=!u,checkedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot"}),unCheckedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot-off"}),enabled:s.unlocked&&s.count>0})]}),jsxRuntimeExports.jsx(ProgressBar,{value:x(s),className:"full computed",children:"Automatically reveals the neighboring hidden squares if all the mines around it have been flagged."}),jsxRuntimeExports.jsx("hr",{className:"separator"}),jsxRuntimeExports.jsx("div",{className:"half",children:jsxRuntimeExports.jsx(ResourceRender,{resource:n,showChrome:!0,showLocked:!0,infix:"",suffix:`time${n.count===1?"":"s"} every ${d}`})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:n,allowUnlocking:!0,enabled:s.unlocked&&s.count>0,prefix:n.unlocked?"Additional":"Unlock"})}),jsxRuntimeExports.jsxs("div",{className:"full right",children:["Enabled:",jsxRuntimeExports.jsx(ToggleButton,{checked:n.unlocked&&!n.disabled,onChange:u=>n.disabled=!u,checkedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot"}),unCheckedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot-off"}),enabled:n.unlocked&&n.count>0})]}),jsxRuntimeExports.jsx(ProgressBar,{value:x(n),className:"full computed",children:"Automatically flags the hidden mines around a square if there are no more hidden clear squares left around it."}),jsxRuntimeExports.jsx("hr",{className:"separator"}),jsxRuntimeExports.jsx("div",{className:"half",children:jsxRuntimeExports.jsx(ResourceRender,{resource:a,showChrome:!0,showLocked:!0,infix:"",suffix:`time${a.count===1?"":"s"} every ${d}`})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:a,allowUnlocking:!0,prefix:a.unlocked?"Additional":"Unlock"})}),jsxRuntimeExports.jsxs("div",{className:"full right",children:["Enabled:",jsxRuntimeExports.jsx(ToggleButton,{checked:a.unlocked&&!a.disabled,onChange:u=>a.disabled=!u,checkedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot"}),unCheckedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot-off"}),enabled:a.unlocked&&a.count>0})]}),jsxRuntimeExports.jsx(ProgressBar,{value:x(a),className:"full computed",children:"Automatically reveals any purchased hints."}),jsxRuntimeExports.jsx("hr",{className:"separator"}),jsxRuntimeExports.jsx("div",{className:"half",children:jsxRuntimeExports.jsx(ResourceRender,{resource:o,showChrome:!0,showLocked:!0,infix:"",suffix:`time${o.count===1?"":"s"} every ${d}`})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:o,allowUnlocking:!0,prefix:o.unlocked?"Additional":"Unlock"})}),jsxRuntimeExports.jsxs("div",{className:"full right",children:["Enabled:",jsxRuntimeExports.jsx(ToggleButton,{checked:o.unlocked&&!o.disabled,onChange:u=>o.disabled=!u,checkedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot"}),unCheckedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot-off"}),enabled:o.unlocked&&o.count>0})]}),jsxRuntimeExports.jsx(ProgressBar,{value:x(o),className:"full computed",children:"Automatically makes a hint purchase when there are no other actions available."})]}),jsxRuntimeExports.jsxs("div",{className:"game-controls panel",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Game Automation"}),jsxRuntimeExports.jsx("div",{className:"half",children:jsxRuntimeExports.jsx(ResourceRender,{resource:i,showChrome:!0,showLocked:!0,infix:"",suffix:`time${i.count===1?"":"s"} every ${d}`})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:i,allowUnlocking:!0,prefix:i.unlocked?"Additional":"Unlock"})}),jsxRuntimeExports.jsxs("div",{className:"full right",children:["Enabled:",jsxRuntimeExports.jsx(ToggleButton,{checked:i.unlocked&&!i.disabled,onChange:u=>i.disabled=!u,checkedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot"}),unCheckedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot-off"}),enabled:i.unlocked&&i.count>0})]}),jsxRuntimeExports.jsx(ProgressBar,{value:x(i),className:"full computed",children:"Automatically initiates game reset when the game is either won or lost."}),jsxRuntimeExports.jsx("hr",{className:"separator"}),jsxRuntimeExports.jsx("div",{className:"half",children:jsxRuntimeExports.jsx(ResourceRender,{resource:r,showChrome:!0,showLocked:!0,infix:"",suffix:`time${r.count===1?"":"s"} after reset`})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:r,allowUnlocking:!0,prefix:r.unlocked?"Additional":"Unlock"})}),jsxRuntimeExports.jsxs("div",{className:"full right",children:["Enabled:",jsxRuntimeExports.jsx(ToggleButton,{checked:r.unlocked&&!r.disabled,onChange:u=>r.disabled=!u,checkedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot"}),unCheckedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot-off"}),enabled:r.unlocked&&r.count>0})]}),jsxRuntimeExports.jsx("div",{className:"full computed",children:"Automatically reveals cells on new games. Does not differentiate between mines and clear cells."})]}),jsxRuntimeExports.jsxs("div",{className:"game-controls panel",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Board Automation"}),jsxRuntimeExports.jsx("div",{className:"half",children:jsxRuntimeExports.jsx(ResourceRender,{resource:l,showChrome:!0,showLocked:!0,infix:"",suffix:`time${l.count===1?"":"s"} every ${d}`})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:l,allowUnlocking:!0,prefix:l.unlocked?"Additional":"Unlock"})}),jsxRuntimeExports.jsxs("div",{className:"full right",children:["Enabled:",jsxRuntimeExports.jsx(ToggleButton,{checked:l.unlocked&&!l.disabled,onChange:u=>l.disabled=!u,checkedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot"}),unCheckedContents:jsxRuntimeExports.jsx(Icon,{icon:"robot-off"}),enabled:l.unlocked&&l.count>0})]}),jsxRuntimeExports.jsx(ProgressBar,{value:x(l),className:"full computed",children:"Automatically purchases game width and game height expansions if affordable."})]})]})}function generate(e,t,...s){const n={...t};if(e){let a;for(a in e){let o=e[a];assign(n,a,typeof o=="function"?o(n,...s):o)}}return n}function resolveTutorialStep(e,t,s){const n=t[e];if(!n)return;const a=Object.keys(t).map(d=>parseInt(d)).sort((d,x)=>d-x),o=a.indexOf(e),i=a[o-1],r=a[o+1],l=round(e+100,-2,"floor");return generate(n,{step:e,enabled:!0,title:`Tutorial step #${e}`,body:"...",prevStep:i,prevStepTitle:"< back",nextStep:r>=0?r:l,nextStepTitle:r>=0?"next >":"done",skipToStep:l,skipToStepTitle:"skip >>>",highlightSelector:"",greyOut:!1,bounds:{left:"50% - 200px",top:"6rem",width:"400px",height:"450px"}},s)}const tsInit={0:{title:"Progressive Mine Sweep",body:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:"Hi! Welcome to progressive mine sweeper."}),jsxRuntimeExports.jsx("div",{className:"full",children:"This is my special take on the classic minesweeper game with progressive / incremental aspects built into it."}),jsxRuntimeExports.jsx("div",{className:"full",children:"The first part of this tutorial will walk you through how to play minesweeper. At any point in tutorial you can move to the next or previous pages. Feel free to skip to the next chapter if you already know how to play!"})]}),greyOut:!0}};function MineCell(e){const t=useGameContext(),[s,n]=reactExports.useState(0),a=e.board??t.board,o=e.cell,i=!e.board,r=reactExports.useCallback(function(u){u.preventDefault();const h=t.resources.clicks;if(i&&h.count++,!(e.enabled??!0)||o.locked){i&&h.extra.useless++;return}const g=o.state;if(u.button===2&&u.type==="contextmenu"||u.button===0&&u.type==="click"&&(t.settings.tapMode==="flag"||u.altKey||u.ctrlKey||u.metaKey||u.shiftKey)?(i&&h.extra.right++,actOnCell(o,"flag")):u.button===0&&u.type==="click"&&t.settings.tapMode==="reveal"?(i&&h.extra.left++,actOnCell(o,"reveal")):u.button===0&&u.type==="dblclick"&&(i&&(h.extra.double++,n(j=>(h.extra.useless-=clamp(j,0,2),h.extra.left-=clamp(j,0,2),0))),t.resources.revealNeighbors.unlocked??!0?revealNeighbors(t,a,o,t.resources.revealNeighbors.count,i,!1):i&&h.extra.useless++),g===o.state&&u.type!=="dblclick")n(j=>j+1),i&&h.extra.useless++;else if(n(0),i&&g!==o.state&&(stateChanged(t,"cell",o.state,!1),o.state==="hidden"&&stateChanged(t,"cell","un"+g,!1)),a.hadUserAction=!0,a.state==="active"){let j=genBoardState(a,t.settings.maxErrors);(e.setBoard??t.setBoard)({...j}),j.state!=="active"&&i&&stateChanged(t,"board",j.state,!1)}},[a,o,e.enabled]),l=Math.floor((e.boardWidth??640)*e.cellRatio*.98/100),c=Math.floor(e.cellRatio*.95),d=Math.floor(e.cellRatio*.8),x=`min(${c}vw, ${d}vh, ${l}px)`;return jsxRuntimeExports.jsx("td",{className:`cell cell-${o.state}`,onClick:r,onDoubleClick:r,onContextMenu:r,id:`col-${o.col}`,children:jsxRuntimeExports.jsx("div",{style:{width:x,height:x},id:`cell-${o.row}-${o.col}`,children:jsxRuntimeExports.jsx(Icon,{cell:o})})})}function MineField(e){const t=useGameContext(),s=e.board??t.board,n=reactExports.useMemo(function(){const a=100/Math.max(s.rows,s.cols);return jsxRuntimeExports.jsx("table",{id:s===t.board?"board-main":"board-custom",className:"board",children:jsxRuntimeExports.jsx("tbody",{children:s.cells.flatMap((o,i)=>jsxRuntimeExports.jsx("tr",{id:`row-${i}`,children:o.map((r,l)=>jsxRuntimeExports.jsx(MineCell,{cell:r,cellRatio:a,enabled:s.state==="active",board:e.board,setBoard:e.setBoard,boardWidth:e.boardWidth},`cell:${i}:${l}`))},`row:${i}:*`))})})},[s]);return jsxRuntimeExports.jsxs("div",{className:"minefield",children:[n,e.children]})}function MineFieldWrapper(e){const[t,s]=reactExports.useState(emptyBoard);return reactExports.useEffect(()=>{var a,o,i,r,l,c,d;const n=genBoard(e.rows,e.cols,e.randomMines);e.unlocks&&e.unlocks.length>0&&n.cells.forEach(x=>x.forEach(u=>u.locked=!0)),(a=e.mines)==null||a.forEach(([x,u])=>n.cells[x][u].contents="mine"),(o=e.hints)==null||o.forEach(([x,u])=>n.cells[x][u].state="hinted"),(i=e.flags)==null||i.forEach(([x,u])=>n.cells[x][u].state="flagged"),(r=e.reveals)==null||r.forEach(([x,u])=>n.cells[x][u].state="revealed"),(l=e.blowns)==null||l.forEach(([x,u])=>n.cells[x][u].state="blown"),(c=e.locks)==null||c.forEach(([x,u])=>n.cells[x][u].locked=!0),(d=e.unlocks)==null||d.forEach(([x,u])=>n.cells[x][u].locked=!1),s(genBoardState(n))},[e]),jsxRuntimeExports.jsx(MineField,{board:t,setBoard:s,boardWidth:e.size})}const tsPlaying={10:{title:"What is minesweeper",body:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:"The game board consists of a playing field shaped like a grid of squares. There are a certain number of mines buried under this field. The objective of each game is to successfully clear all the empty cells, and flag the cells containing mines without triggering (exploding) them."}),jsxRuntimeExports.jsx("div",{className:"full center",children:"Sample 3x3 board:"}),jsxRuntimeExports.jsx("div",{className:"full center",children:jsxRuntimeExports.jsx(MineFieldWrapper,{rows:3,cols:3,randomMines:1,size:200})})]}),greyOut:!0},15:{title:"Revealing a square",body:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:"Clicking or tapping on an empty square will reveal its contents. The contents of a square is either clear or a mine. When revealing a clear square, you are given a clue to the number of mines surrounding it  in all directions, including diagonals. Revealing a mine, however, would trigger it and explode!"}),jsxRuntimeExports.jsx("div",{className:"full center",children:"Try clicking (or tapping) the hinted square below:"}),jsxRuntimeExports.jsx("div",{className:"full center",children:jsxRuntimeExports.jsx(MineFieldWrapper,{rows:3,cols:3,size:200,mines:[[2,2]],hints:[[0,0]],unlocks:[[0,0]]})})]}),greyOut:!0},20:{title:"Revealing squares",body:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:jsxRuntimeExports.jsxs("span",{children:["The revealed contents of ",jsxRuntimeExports.jsx(Icon,{state:"revealed",neighbors:0,size:"1em"})," tells us there are no mines in the squares surrounding it, so it's safe to go ahead and reveal the 3 surrounding squares as well!"]})}),jsxRuntimeExports.jsx("div",{className:"full center",children:"Try clicking (or tapping) the hinted squares below:"}),jsxRuntimeExports.jsx("div",{className:"full center",children:jsxRuntimeExports.jsx(MineFieldWrapper,{rows:3,cols:3,size:200,mines:[[2,2]],reveals:[[0,0]],hints:[[0,1],[1,0],[1,1]],unlocks:[[0,1],[1,0],[1,1]]})})]}),greyOut:!0},25:{title:"Reasoning about squares",body:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:jsxRuntimeExports.jsxs("span",{children:["Uh oh! The ",jsxRuntimeExports.jsx(Icon,{state:"revealed",neighbors:1,size:"1em"})," in the middle means there's one mine hidden under one of the remaining squares around the centerpiece! Better be careful with this one..."]})}),jsxRuntimeExports.jsx("div",{className:"full",children:"However, we know from the other 2 squares we just revealed that there are no mines in the 2 squares immediately surrounding those places."}),jsxRuntimeExports.jsx("div",{className:"full center",children:jsxRuntimeExports.jsx(MineFieldWrapper,{rows:3,cols:3,size:200,mines:[[2,2]],reveals:[[0,0],[0,1],[1,0],[1,1]],hints:[[0,2],[1,2],[2,0],[2,1]],unlocks:[[0,2],[1,2],[2,0],[2,1]]})})]}),greyOut:!0},30:{title:"Flagging squares",body:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:"This brings us to the final square in the corner which is obviously a mine! You won't want to set this off!"}),jsxRuntimeExports.jsx("div",{className:"full",children:"Be careful with this one. Right (or meta) click on the square to flag it, or simply toggle the tapping mode to flag squares instead of revealing:"}),jsxRuntimeExports.jsx("div",{className:"full center",children:jsxRuntimeExports.jsx(MineFieldWrapper,{rows:3,cols:3,size:200,mines:[[2,2]],reveals:[[0,0],[0,1],[1,0],[1,1],[0,2],[1,2],[2,0],[2,1]]})}),jsxRuntimeExports.jsx("div",{className:"full center",children:jsxRuntimeExports.jsx(ModeControls,{showBuyAmount:!1})})]}),greyOut:!0,onMount:(e,t)=>()=>{_tempTapMode=t.settings.tapMode},onUnmount:(e,t)=>()=>{t.settings.tapMode=_tempTapMode}},35:{title:"Winning a game",body:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:"No sweat if you accidentally set off the mine in the previous step."}),jsxRuntimeExports.jsx("div",{className:"full",children:"Once you reveal all the squares and flag all the mines correctly, you win the playing field, and the game announces it to you."}),jsxRuntimeExports.jsx("div",{className:"full",children:"Similarly, if you set off a mine, you lose the playing field and need to reset the board."}),jsxRuntimeExports.jsx("div",{className:"full",children:"In either case, you will be presented with an option to reset the board and receive a brand new game to play. We can upgrade this box and its functions later on."})]}),greyOut:!0}};let _tempTapMode="reveal";const tsScoring={100:{title:"Scoring",body:(e,t)=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:"Scores are awarded to the player based on how many cells have been successfully marked and how many playing fields have been cleared. These rewards can be used to purchase upgrades to the game to make it more engaging or challenging."}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx(ResourceRender,{resource:t.resourceManager.get("wins"),showChrome:!0})}),jsxRuntimeExports.jsx("div",{className:"half left",children:"Shows how many fields you have successfully cleared"}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx(ResourceRender,{resource:t.resourceManager.get("cells"),showChrome:!0})}),jsxRuntimeExports.jsx("div",{className:"half left",children:"Shows how many cells you have cleared without exploding"})]}),enabled:(e,t)=>t.resourceManager.resources.resets.extra.total>1,highlightSelector:"div.panel#resource-bar",bounds:{top:"12rem",height:"400px"}},105:{title:"Other scores",body:jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"full",children:"There are many other scores and resources tracked in the game that you can access via the STATISTICS tab above."})}),highlightSelector:"div#tab-stats",bounds:{left:"100% - 300px - 2rem",width:"300px",height:"200px"}},110:{title:"Upgrades",body:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:"The UPGRADES tab allows you to upgrade various aspects of the game to make it more interesting."}),jsxRuntimeExports.jsx("div",{className:"full",children:"Side note: this is what makes the game progressive  sometimes also called incremenetal."}),jsxRuntimeExports.jsx("div",{className:"full",children:"Head over to this tab to check out the different upgrade options available."})]}),highlightSelector:"div#tab-upgrades",enabled:(e,t)=>t.resourceManager.resources.resets.extra.total>1,nextStep:e=>document.location.href.includes("upgrades")?null:e==null?void 0:e.step},115:{title:"Upgrades",body:(e,t)=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:"You can increase the playing field size and difficulty of the game in Upgrades section. The cost of these upgrades increases over time, but you will eventually gain enough scores to upgrade them all!"}),jsxRuntimeExports.jsx("div",{className:"half left",children:"Game Width:"}),jsxRuntimeExports.jsx("div",{className:"half left",children:jsxRuntimeExports.jsx(ResourceRender,{resource:t.resourceManager.get("cols"),showChrome:!0,infix:"",className:"value-first"})}),jsxRuntimeExports.jsx("div",{className:"half left",children:"Game Height:"}),jsxRuntimeExports.jsx("div",{className:"half left",children:jsxRuntimeExports.jsx(ResourceRender,{resource:t.resourceManager.get("rows"),showChrome:!0,infix:"",className:"value-first"})}),jsxRuntimeExports.jsx("div",{className:"half left",children:"Game Difficulty:"}),jsxRuntimeExports.jsx("div",{className:"half left",children:jsxRuntimeExports.jsx(ResourceRender,{resource:t.resourceManager.get("difficulty"),showChrome:!0,showName:!1,infix:"",className:"value-first"})})]}),highlightSelector:"div#game-upgrades",bounds:{top:"26rem",height:"200px"}},120:{title:"Quality Upgrades",body:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:"There are many other upgrades in this tab that improve the quality and various aspects of the game. Such as getting hints or revealing neighboring cells on double-tap!"}),jsxRuntimeExports.jsx("div",{className:"full",children:"Try them all and make the game more enjoyable."}),jsxRuntimeExports.jsx("div",{className:"full",children:"PRO TIP: There is a lot more to the game than these upgrades. Use them for a while and a whole lot of new features may open up as you go!"})]})},200:{title:"Automation",body:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"full",children:"The AUTOMATION tab provides new game mechanics to automatically perform some repetitive actions in the game, such as reseting the board or revealing neighboring squares!"}),jsxRuntimeExports.jsx("div",{className:"full",children:"Head over to this tab to check out the different automation options available."})]}),highlightSelector:"div#tab-auto",enabled:(e,t)=>t.resourceManager.resources.automation.extra.total>=5,nextStep:e=>document.location.href.includes("auto")?null:e==null?void 0:e.step}},tutorialSteps={...tsInit,...tsPlaying,...tsScoring};function recordMap(e,t,s){const n={};for(const a in e){const o=a,i=e[a],r=t?t(i,a):i;n[o]=r}return n}function Help(){const e=useGameContext(),t=recordMap(tutorialSteps,(a,o)=>resolveTutorialStep(o??0,tutorialSteps,e)),s=Object.keys(tutorialSteps).map(a=>parseInt(a)).sort((a,o)=>a-o);function n(a){const o=t[a];return o?jsxRuntimeExports.jsx("div",{className:"help",children:jsxRuntimeExports.jsxs("div",{className:"panel",id:`help-step-${a}`,children:[o.title!=null&&o.title!==""&&jsxRuntimeExports.jsx("div",{className:"title-bar",children:o.title}),o.body]})},`help-panel-${a}`):null}return jsxRuntimeExports.jsx("div",{id:"help",children:s.map(a=>n(a))})}const active=["Game in progress..."],inavtive=["There's no game yet...?","Hmm... seems like you should reset the board.","Game is inactive :("],won=["Hooray!!!","Minefield cleared!!","You win!","Game won!","Success!","Amazing job!!!","WIN!","#winning","Sweet!","We're all safe again"],lost=["Oh no! :(","KABOOOM!!!!!","Minefield blown :/","TOTAL CATASTROPHIC LOSS OF EVERYTHING!!!!","Game lost!","You lost this one :(","#fail","What a tragedy...","It wasn't your fault!","sadpanda","Rave ruined"],resetting=["Un-de-mining the playing field","Resetting the board","Ordering new landmines","Contemplating modern warfare","Bulldozing the ground","Wasting time for no reason","Treating shellshock","Rasterizing cell graphics","Writing new reset messages","Pre-computing game features","Calculating total land area","Integrating the area under board","Un-defusing the mines","Calling technical support","Taking the hobbits to Isengard","Reticulating splines","Swapping time and space","Grabbing extra minions","Rupturing the subspace barrier","Creating an anti-time reaction","Converging tachyon pulses","Bypassing control of the matter-antimatter integrator","Adjusting the dilithium crystal converter assembly","Reversing the shield polarity","Disrupting warp fields with an inverse graviton burst","Checking the gravitational constant in your locale","Reconfoobling energymotron","Counting backwards from Infinity","Creating time-loop inversion field","Computing chance of success","Adjusting flux capacitor","Connecting Neurotoxin Storage Tank","Constructing additional pylons","Roping some seaturtles","Locating Jebediah Kerman","Dividing by zero","Cracking military-grade encryption","Simulating traveling salesman","Proving P=NP","Entangling superstrings","Twiddling thumbs","Searching for plot device","Trying to sort in O(n)","Installing dependencies","Ordering 1s and 0s","Mining some bitcoins","Downloading more RAM","Updating to Windows Vista","Deleting System32 folder","Initializing the initializer","Optimizing the optimizer","Updating the updater","Downloading the downloader","Debugging the debugger","Discovering new ways of making you wait","Pushing pixels","Building a wall"],messages={active,inavtive,won,lost,resetting};function message(e,t){const s=messages[e];return!s||s.length===0?e:typeof s=="string"?s:(t??(t=Math.floor(Math.random()*s.length)),s[t]??s[0]??e)}function ProgressCircle({value:e,minValue:t=0,maxValue:s=1,width:n="100px",height:a=n,showPercent:o=!1,className:i,children:r}){const l=(e-t)/(s-t);return jsxRuntimeExports.jsxs("div",{className:`progress-circle ${i??""}`,style:{minWidth:n,minHeight:a},children:[jsxRuntimeExports.jsxs("div",{className:"children",children:[o&&jsxRuntimeExports.jsxs("span",{children:[Math.floor(100*l),"%"]}),r]}),jsxRuntimeExports.jsxs("svg",{viewBox:"-55 -55 110 110",width:n,height:a,children:[jsxRuntimeExports.jsx("circle",{className:"secondary",r:50}),jsxRuntimeExports.jsx("circle",{className:"primary",r:50,transform:"rotate(-90)",strokeDasharray:Math.ceil(Math.PI*100),strokeDashoffset:Math.ceil(Math.PI*100*(1-l))})]})]})}function ResetBox(){const{context:e,board:t,resources:{resetSpeed:s}}=useGameContext(),[n,a]=reactExports.useState(t.state),[o,i]=reactExports.useState(!1),[r,l]=reactExports.useState(""),[c,d]=reactExports.useState(0);if(reactExports.useEffect(()=>{a(message(t.state))},[t,t.state]),t.rows===0||t.cols===0||t.state==="inactive")return boardReset(e,!0),null;if(t.state==="active")return null;const x=resetTimeFormula(e),u=s.extra.remainingTime;!o&&u>0?(i(!0),d(0)):o&&u<.001&&i(!1),o&&(!r||x-u>=c)&&(l(message("resetting")),d(c+2));function h(g){g==null||g.preventDefault(),o||(x<.001?boardReset(e,!1):s.extra.remainingTime<.001&&(s.extra.remainingTime=x,s.onChange=(j,m,f)=>j<.001&&m==="remainingTime"&&f==="tick"&&boardReset(e,!1)))}return jsxRuntimeExports.jsx("div",{className:"reset-box",children:jsxRuntimeExports.jsxs("div",{className:`panel shadow board-state-${t.state}`,children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:n}),jsxRuntimeExports.jsx("div",{className:"full center",children:"Game over!"}),jsxRuntimeExports.jsx("div",{className:"full center",children:"You may reset the board to receive a brand new game to play:"}),jsxRuntimeExports.jsxs(ProgressCircle,{value:o?(x-u)/x:0,showPercent:o,width:"100%",height:"50%",children:[!o&&jsxRuntimeExports.jsx("input",{type:"button",value:"Reset!",disabled:o,onClick:h,id:"button-reset"}),o&&jsxRuntimeExports.jsxs("span",{children:[r,"..."]})]})]})})}function Main(){const{context:e,board:t,setBoard:s,resources:{rows:n,cols:a,hints:o,resets:i}}=useGameContext(),r=t.rows!==n.value()||t.cols!==a.value();function l(){let d=genBoardState(t,0);s({...d}),stateChanged(e,"board",d.state,!1)}function c(d){d=genHints(t,d,0,8,hintFormula(e)),d>0&&(countActions(o,!1,d),s({...t}))}return jsxRuntimeExports.jsxs("div",{id:"main",className:"main",children:[jsxRuntimeExports.jsx(ResourceBar,{}),jsxRuntimeExports.jsx(MineField,{children:jsxRuntimeExports.jsx(ResetBox,{})}),jsxRuntimeExports.jsx(ModeControls,{}),jsxRuntimeExports.jsxs("div",{className:"game-controls panel",children:[jsxRuntimeExports.jsx("div",{className:"half",children:jsxRuntimeExports.jsx("button",{className:"buy-button",onClick:l,id:"button-reset",children:jsxRuntimeExports.jsx(ResourceRender,{resource:i,value:1,showValue:!1,showChrome:!0,infix:"",suffix:"the Game"})})}),jsxRuntimeExports.jsx("div",{className:"half",children:jsxRuntimeExports.jsx(BuyButton,{resource:o,overrideCount:0,overrideMaxCount:remainingHintsFormula(e),onPurchase:(d,x,u)=>c(u)})}),r&&jsxRuntimeExports.jsxs("div",{className:"left full",id:"reset-info",children:["On reset, game board will change to size to",` ${n.value()}x${a.value()}`]})]})]})}const light="Light Mode",dark="Dark Mode",ocean="Ocean",gold="Gold",tomato="Tomato",cyan="Chocolate",comic="Cute",murder="Murder",themeData={light,dark,"jumbo-light":"Jumbo Light","jumbo-dark":"Jumbo Dark",ocean,gold,tomato,cyan,comic,murder};function saveToFile(e,t){t instanceof Blob||(t=new Blob([t],{type:"text/plain"}));const s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download=e,n.click(),URL.revokeObjectURL(s)}function loadFromFile(e,t){const s=document.createElement("input");s.type="file",s.addEventListener("change",function(n){const a=n.target.files;if(!a||a.length===0||!a[0])return;const o=new FileReader;o.onload=function(i){var l;const r=(l=i.target)==null?void 0:l.result;!r||typeof r!="string"||e&&e(r)},o.readAsText(a[0])},!1),s.click()}function Options(){const e=useGameContext(),[t,s]=reactExports.useState(""),[n,a]=reactExports.useState(!1),o=useNavigate(),i=useLocation(),r=e.settings,l=themeData,c=i.search.toLowerCase().includes("debug");function d(){e.save(c),toast.success("Game saved!")}function x(){e.load()?(o({pathname:"/",search:i.search}),toast.success("Game loaded!")):toast.fail("Load failed!")}function u(){s(e.saveAs(c)),toast.success("Game exported!")}function h(){e.loadAs(t)?(o({pathname:"/",search:i.search}),toast.success("Game imported!")):toast.fail("Import failed!")}function g(){const p=new Date().toISOString().replace(/\D/g," ").trim().replace(/\D/g,"-");saveToFile(`progressive-mine-sweep-${p}`,e.saveAs(c)),toast.success("Game exported!")}function j(){loadFromFile(p=>{e.loadAs(p)?(o({pathname:"/",search:i.search}),toast.success("Game imported!")):toast.fail("Import failed!")})}function m(p,w){let T=parseInt(w);if(T>=1&&T<=1e3)switch(p){case"tick":r.ticksPerSecond=T;break;case"render":r.framesPerSecond=T;break;case"save":r.saveFrequencySecs=600/T;break}}function f(p){r.theme=p.target.getAttribute("theme")??void 0,setTheme(r.theme)}function R(){n&&(confirm("Are you sure you want to reset? This cannot be undone.")?(e.reset(),o({pathname:"/",search:i.search})):a(!1))}return jsxRuntimeExports.jsxs("div",{id:"options",children:[jsxRuntimeExports.jsxs("div",{className:"panel options",id:"options-theme",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Theme Options"}),jsxRuntimeExports.jsxs("div",{className:"full",children:["Current theme is: ",l[r.theme??""]??"default"]}),Object.keys(l).map(p=>jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx("div",{className:"themed",id:`theme-${p}`,theme:p,children:jsxRuntimeExports.jsx("button",{id:`button-theme-${p}`,theme:p,onClick:f,children:l[p]})})},`theme-${p}`))]}),jsxRuntimeExports.jsxs("div",{className:"panel options",id:"options-data",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Game Data"}),jsxRuntimeExports.jsx("div",{className:"full",children:jsxRuntimeExports.jsx(ResourceRender,{epoch:r.lastReset/1e3,value:r.lastUpdate/1e3,display:"time",precision:0,prefix:"You started this game "})}),jsxRuntimeExports.jsx("div",{className:"full",children:jsxRuntimeExports.jsx(ResourceRender,{epoch:r.lastLoaded/1e3,value:r.lastUpdate/1e3,display:"time",precision:0,prefix:"This session started "})}),jsxRuntimeExports.jsx("div",{className:"full",children:jsxRuntimeExports.jsx(ResourceRender,{epoch:r.lastSaved/1e3,value:r.lastUpdate/1e3,display:"time",precision:0,prefix:"Game was last saved "})}),jsxRuntimeExports.jsx("hr",{className:"separator"}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx("input",{type:"button",value:"Load",onClick:x,id:"button-load"})}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx("input",{type:"button",value:"Save",onClick:d,id:"button-save"})}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx("input",{type:"button",value:"Load from File",onClick:j,id:"button-file-load"})}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx("input",{type:"button",value:"Save to File",onClick:g,id:"button-file-save"})}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx("input",{type:"button",value:"Import",onClick:h,id:"button-import"})}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx("input",{type:"button",value:"Export",onClick:u,id:"button-export"})}),jsxRuntimeExports.jsx("div",{className:"full center",id:"export-text",children:jsxRuntimeExports.jsx("textarea",{value:t,onChange:p=>s(p.target.value)})})]}),jsxRuntimeExports.jsxs("div",{className:"panel options",id:"options-advanced",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Advanced Settings"}),jsxRuntimeExports.jsx("div",{className:"full",children:"If you are having performance issues, increase the time between updates. Faster updating frequncies lead to better game experience but might use a lot of CPU."}),jsxRuntimeExports.jsx("div",{className:"half",children:"Updating frequency:"}),jsxRuntimeExports.jsxs("div",{className:"half center",children:[Math.floor(1e3/r.ticksPerSecond),"ms"]}),jsxRuntimeExports.jsx("div",{className:"half"}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx("input",{type:"range",min:1,max:1e3,value:r.ticksPerSecond,onInput:p=>m("tick",p.target.value),id:"input-freq-tick"})}),jsxRuntimeExports.jsx("div",{className:"full"}),jsxRuntimeExports.jsx("div",{className:"half",children:"Rendering frequency:"}),jsxRuntimeExports.jsxs("div",{className:"half center",children:[Math.floor(1e3/r.framesPerSecond),"ms"]}),jsxRuntimeExports.jsx("div",{className:"half"}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx("input",{type:"range",min:1,max:60,value:r.framesPerSecond,onInput:p=>m("render",p.target.value),id:"input-freq-render"})}),jsxRuntimeExports.jsx("div",{className:"full",children:"Change how often the game is saved in the background. More frequent saving leads to faster backups, but increases CPU and I/O usage"}),jsxRuntimeExports.jsx("div",{className:"half",children:"Saving frequency:"}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx(ResourceRender,{value:r.saveFrequencySecs,display:"time",precision:0})}),jsxRuntimeExports.jsx("div",{className:"half"}),jsxRuntimeExports.jsx("div",{className:"half center",children:jsxRuntimeExports.jsx("input",{type:"range",min:1,max:60,value:600/r.saveFrequencySecs,onInput:p=>m("save",p.target.value),id:"input-freq-save"})})]}),jsxRuntimeExports.jsxs("div",{className:"panel options reset",id:"options-reset",children:[jsxRuntimeExports.jsx("div",{className:"title-bar warning",children:"Game Reset"}),jsxRuntimeExports.jsx("div",{className:"full",children:"WARNING: this will completely reset your game and delete all saved progress and setting. Only use this if you want to restart the game from beginning, or if something in the settings is so messed up that the game is now unplayable."}),jsxRuntimeExports.jsx("div",{className:"full",children:jsxRuntimeExports.jsxs("label",{children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:n,onChange:()=>a(!n),id:"acknowledge-box"}),"I understand what this means and still want to reset the game"]})}),jsxRuntimeExports.jsx("div",{className:"full right",children:jsxRuntimeExports.jsx("input",{type:"button",value:"Reset everything",disabled:!n,onClick:R,id:"button-wipeall"})})]}),c&&jsxRuntimeExports.jsxs("div",{className:"panel options debug",id:"options-debug",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Debug Context"}),jsxRuntimeExports.jsx("div",{className:"half",children:"Settings:"}),jsxRuntimeExports.jsx("div",{className:"full",id:"debug-settings",children:JSON.stringify(r,null,2)}),jsxRuntimeExports.jsx("hr",{className:"separator"}),jsxRuntimeExports.jsx("div",{className:"half",children:"Resources:"}),jsxRuntimeExports.jsx("div",{className:"full",id:"debug-resources",children:JSON.stringify(e.resourceManager,(p,w)=>disallowedResourceKeys.includes(p)?void 0:w,2)}),jsxRuntimeExports.jsx("hr",{className:"separator"}),jsxRuntimeExports.jsx("div",{className:"half",children:"Board:"}),jsxRuntimeExports.jsx("div",{className:"full",id:"debug-board",children:JSON.stringify(e.board,null,2)})]})]})}const disallowedResourceKeys=["context","manager"];function Stats(){const{resource:e}=useGameContext(),s=useLocation().search.toLowerCase().includes("debug");function n(a){const o=e(a);return jsxRuntimeExports.jsx(ResourceRender,{resource:o,length:o.display==="percentage"?"tiny":"compact",precision:o.display==="percentage"?1:void 0,showMaxValue:!0,showRate:!0,showExtras:s,showZeroRates:!0,showRateColors:!0,placeholder:""})}return jsxRuntimeExports.jsxs("div",{id:"stats",children:[jsxRuntimeExports.jsxs("div",{className:"panel stats",id:"stats-time",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Time Info"}),n("totalTime"),n("activeTime"),n("offlineTime")]}),jsxRuntimeExports.jsxs("div",{className:"panel stats",id:"stats-board",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Board Info"}),n("rows"),n("cols"),n("difficulty"),n("resetSpeed"),n("hintQuality")]}),jsxRuntimeExports.jsxs("div",{className:"panel stats",id:"stats-game",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Game Info"}),n("wins"),n("losses"),n("resets"),n("automation")]}),jsxRuntimeExports.jsxs("div",{className:"panel stats",id:"stats-cell",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Cell Info"}),n("cells"),n("flags"),n("hints"),n("explosions"),n("clicks"),n("revealNeighbors")]})]})}function Tutorial(){const{context:e,settings:t}=useGameContext(),s=resolveTutorialStep(t.tutorialStep,tutorialSteps,e);if(reactExports.useEffect(()=>{const l=s==null?void 0:s.onMount,c=s==null?void 0:s.onUnmount;let d;try{d=document.querySelectorAll((s==null?void 0:s.highlightSelector)??"")}catch{}return s!=null&&s.enabled&&(d==null||d.forEach(x=>x.classList.add("highlight")),l&&l()),()=>{d==null||d.forEach(x=>x.classList.remove("highlight")),c&&c()}},[s==null?void 0:s.step,s==null?void 0:s.enabled]),!s||!s.enabled||s.step!==t.tutorialStep||s.step<0)return null;function n(l){return l!=null&&l!=null&&l>=0&&l!==t.tutorialStep&&l!==(s==null?void 0:s.step)}function a(l,c){c.preventDefault(),n(l)&&(t.tutorialStep=l)}function o(l){return`max(5%, 1em, min(90%, calc(100% - 2em), calc(${l})))`}const i={left:o(s.bounds.left),bottom:o("100vh - "+s.bounds.top+" - "+s.bounds.height),width:o(s.bounds.width),minHeight:o(s.bounds.height),maxHeight:o("100%")},r=jsxRuntimeExports.jsx("div",{className:"tutorial",style:i,id:`tutorial-step-${s.step}`,children:jsxRuntimeExports.jsxs("div",{className:"panel shadow",style:{minHeight:s.bounds.height},children:[s.title!=null&&s.title!==""&&jsxRuntimeExports.jsx("div",{className:"title-bar",children:s.title}),s.body,n(s.prevStep)&&jsxRuntimeExports.jsx("div",{className:"prev",children:jsxRuntimeExports.jsx("a",{href:"",onClick:apply(a,s.prevStep),children:s.prevStepTitle})}),n(s.nextStep)&&jsxRuntimeExports.jsx("div",{className:"next",children:jsxRuntimeExports.jsx("a",{href:"",onClick:apply(a,s.nextStep),children:s.nextStepTitle})}),n(s.skipToStep)&&jsxRuntimeExports.jsx("div",{className:"skip",children:jsxRuntimeExports.jsx("a",{href:"",onClick:apply(a,s.skipToStep),children:s.skipToStepTitle})})]})});return s.greyOut?jsxRuntimeExports.jsx("div",{className:"greyout",children:r}):r}function Upgrades(){const{context:e,resources:{rows:t,cols:s,difficulty:n,hintQuality:a,hintsCount:o,resetSpeed:i,revealNeighbors:r}}=useGameContext();return jsxRuntimeExports.jsxs("div",{id:"upgrades",children:[jsxRuntimeExports.jsx(ResourceBar,{}),jsxRuntimeExports.jsx(ModeControls,{showTapMode:!1}),jsxRuntimeExports.jsxs("div",{className:"game-controls panel",id:"game-upgrades",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Game Upgrades"}),jsxRuntimeExports.jsx("div",{className:"quarter",children:"Game Width:"}),jsxRuntimeExports.jsx("div",{className:"quarter",children:jsxRuntimeExports.jsx(ResourceRender,{resource:s,showChrome:!0,infix:"",className:"value-first"})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:s,prefix:"Expand",overrideMaxCount:50})}),jsxRuntimeExports.jsx("div",{className:"half"}),jsxRuntimeExports.jsx("div",{className:"right half",children:s.count>3&&jsxRuntimeExports.jsx(BuyButton,{resource:s,prefix:"Shrink",mode:"sell"})}),jsxRuntimeExports.jsx("div",{className:"quarter",children:"Game Height:"}),jsxRuntimeExports.jsx("div",{className:"quarter",children:jsxRuntimeExports.jsx(ResourceRender,{resource:t,showChrome:!0,infix:"",className:"value-first"})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:t,prefix:"Expand",overrideMaxCount:50})}),jsxRuntimeExports.jsx("div",{className:"half"}),jsxRuntimeExports.jsx("div",{className:"right half",children:t.count>3&&jsxRuntimeExports.jsx(BuyButton,{resource:t,prefix:"Shrink",mode:"sell"})}),jsxRuntimeExports.jsx("div",{className:"quarter",children:"Game Difficulty:"}),jsxRuntimeExports.jsx("div",{className:"quarter",children:jsxRuntimeExports.jsx(ResourceRender,{resource:n,showChrome:!0,showName:!1,infix:"",className:"value-first"})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:n,prefix:"Increase"})}),jsxRuntimeExports.jsx("div",{className:"quarter",children:jsxRuntimeExports.jsx("span",{className:"computed",children:"Score Multiplier:"})}),jsxRuntimeExports.jsx("div",{className:"quarter",children:jsxRuntimeExports.jsx(ResourceRender,{value:difficultyScoreMultiplier(e)*100,display:"percentage",showChrome:!0,className:"computed"})}),jsxRuntimeExports.jsx("div",{className:"right half",children:n.count>1&&jsxRuntimeExports.jsx(BuyButton,{resource:n,prefix:"Decrease",mode:"sell"})})]}),jsxRuntimeExports.jsxs("div",{className:"game-controls panel",children:[jsxRuntimeExports.jsx("div",{className:"title-bar",children:"Quality Upgrades"}),jsxRuntimeExports.jsx("div",{className:"quarter",children:"Reset Speed:"}),jsxRuntimeExports.jsx("div",{className:"quarter",children:jsxRuntimeExports.jsx(ResourceRender,{resource:i,showChrome:!0,showName:!1,infix:"",className:"value-first"})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:i,prefix:i.count<(i.maxCount??1/0)?"Speed up":"Max Speed!"})}),jsxRuntimeExports.jsx("hr",{className:"separator"}),jsxRuntimeExports.jsx("div",{className:"quarter",children:"Hint Quality:"}),jsxRuntimeExports.jsx("div",{className:"quarter",children:jsxRuntimeExports.jsx(ResourceRender,{resource:a,showChrome:!0,showName:!1,infix:"",className:"value-first"})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:a,prefix:"Improve"})}),jsxRuntimeExports.jsx("div",{className:"quarter",children:"Number of hints on purchase:"}),jsxRuntimeExports.jsx("div",{className:"quarter",children:jsxRuntimeExports.jsx(ResourceRender,{resource:o,showChrome:!0,infix:"",className:"value-first"})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:o,prefix:o.count<(o.maxCount??1/0)?"Improve":"Max Quality!"})}),jsxRuntimeExports.jsx("hr",{className:"separator"}),jsxRuntimeExports.jsx("div",{className:"half",children:jsxRuntimeExports.jsx(ResourceRender,{resource:r,showChrome:!0,infix:"",placeholder:"Nothing happens",suffix:"on double-tap",className:"value-first"})}),jsxRuntimeExports.jsx("div",{className:"right half",children:jsxRuntimeExports.jsx(BuyButton,{resource:r,allowUnlocking:!0,prefix:r.unlocked?r.count<(r.maxCount??1/0)?"Additional":"Maxed out!":"Unlock"})}),jsxRuntimeExports.jsxs("div",{className:"full computed",children:["Reveals random (hidden) neighbors of the square being tapped on.",jsxRuntimeExports.jsx("br",{}),"CAUTION: it might trigger a mine if they have not been properly flagged!"]})]})]})}function Link(e){if(e.condition!=null&&!e.condition)return null;const t=useLocation();let s=e.to.replace(/\W/g,"");return s===""&&(s="main"),jsxRuntimeExports.jsx("div",{id:`tab-${s}`,children:jsxRuntimeExports.jsx(NavLink,{className:({isActive:n})=>n?"active":"",to:{pathname:e.to,search:t.search},children:e.children})})}function Game(){const{context:e,settings:t,resourceManager:s,save:n,resources:{automation:a,resets:o}}=useGameContext(),[i,r]=reactExports.useState(),[l,c]=reactExports.useState(0);reactExports.useEffect(function(){return i&&clearInterval(i),r(setInterval(d,1e3/t.ticksPerSecond)),setTheme(t.theme),()=>{i&&(clearInterval(i),r(void 0))}},[t,t.ticksPerSecond,t.theme]);function d(){const x=e.board.state;s.update(void 0,"tick").includes(!0)&&(e.board=genBoardState(e.board,e.settings.maxErrors),e.board={...e.board},e.board.state!==x&&stateChanged(e,"board",e.board.state,!e.board.hadUserAction)),t.lastUpdate-t.lastSaved>=t.saveFrequencySecs*1e3&&t.lastUpdate-t.lastLoaded>=t.saveFrequencySecs*1e3&&(n(),toast.info("Game saved!")),c(h=>t.lastUpdate-h>=1e3/t.framesPerSecond?t.lastUpdate:h)}return jsxRuntimeExports.jsxs(HashRouter,{children:[jsxRuntimeExports.jsxs("nav",{className:"navbar",children:[jsxRuntimeExports.jsxs("div",{className:"left",children:[jsxRuntimeExports.jsx(Link,{to:"/",children:"Minefield"}),jsxRuntimeExports.jsx(Link,{to:"/upgrades",condition:o.extra.total>1,children:"Upgrades"}),jsxRuntimeExports.jsx(Link,{to:"/auto",condition:a.extra.total>=5,children:"Automation"})]}),jsxRuntimeExports.jsx("div",{className:"spacer"}),jsxRuntimeExports.jsxs("div",{className:"right",children:[jsxRuntimeExports.jsx(Link,{to:"/achievements",children:"Achievements"}),jsxRuntimeExports.jsx(Link,{to:"/stats",children:"Statistics"}),jsxRuntimeExports.jsx(Link,{to:"/help",children:"Help"}),jsxRuntimeExports.jsx(Link,{to:"/options",children:"Settings"})]})]}),jsxRuntimeExports.jsx(Tutorial,{}),jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Main,{})}),jsxRuntimeExports.jsx(Route,{path:"/upgrades",element:jsxRuntimeExports.jsx(Upgrades,{})}),jsxRuntimeExports.jsx(Route,{path:"/auto",element:jsxRuntimeExports.jsx(Automation,{})}),jsxRuntimeExports.jsx(Route,{path:"/achievements",element:jsxRuntimeExports.jsx(Achievements,{})}),jsxRuntimeExports.jsx(Route,{path:"/stats",element:jsxRuntimeExports.jsx(Stats,{})}),jsxRuntimeExports.jsx(Route,{path:"/help",element:jsxRuntimeExports.jsx(Help,{})}),jsxRuntimeExports.jsx(Route,{path:"/options",element:jsxRuntimeExports.jsx(Options,{})})]})]})}function Spinner({frames:e=12,duration:t=1}){return jsxRuntimeExports.jsx("svg",{className:"spinner",width:"128px",height:"128px",viewBox:"0 0 100 100",children:Array.from(Array(e).keys()).map(s=>jsxRuntimeExports.jsx("g",{transform:`rotate(${s*360/e} 50 50)`,children:jsxRuntimeExports.jsx("rect",{x:"47",y:"24",rx:"9.4",ry:"4.8",width:"6",height:"12",fill:"#32a0da",children:jsxRuntimeExports.jsx("animate",{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:`${t}s`,begin:`${(s-e)*(t/e)}s`,repeatCount:"indefinite"})})},`g-${s}`))})}function Loader(){const{context:e,load:t}=useGameContext(),[s,n]=reactExports.useState(!1),[a,o]=reactExports.useState(!1);reactExports.useEffect(()=>{!s&&!a&&setTimeout(i,1)},[s,a]);function i(){try{e.init(),t(),n(!0)}catch(r){throw o(!0),r}}return s?jsxRuntimeExports.jsx(Game,{}):a?jsxRuntimeExports.jsx(Reset,{}):jsxRuntimeExports.jsx(Spinner,{})}window.addEventListener("load",()=>clientExports.createRoot(getHTMLElement("app")).render(jsxRuntimeExports.jsx(GameContextProvider,{children:jsxRuntimeExports.jsx(Loader,{})})),!1);
